<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>REST-Webservices</title>

        <link rel="shortcut icon" href="../../favicon.svg" />
        <link rel="stylesheet" href="../../style.css" />
        <script src="../../learning-slides.bundle.js"></script>
    </head>
    <body class="slides invisible" data-title="REST-Webservices" tabindex="0">
        <header>
            <h2>Inhaltsverzeichnis</h2>
            <p>
                Moderne Webservices werden immer mehr als REST-Webservices entworfen und es scheint
                fast so, als w√§re SOAP vielerorts gar kein Thema mehr. In dieser Stelle gehen wir
                daher n√§her auf REST ein und zeigen, wie es mit Java funktioniert.
            </p>
        </header>

        <!--
            ========================
            LERNZIELE DIESER EINHEIT
            ========================
        -->
        <section data-chapter data-background-color="rgb(210,190,210)">
            <h1>Lernziele dieser Einheit</h1>
            <article>
                <h3>Nach Abschluss dieser Einheit kannst du ‚Ä¶</h3>
                <ul>
                    <li>
                        Die Unterschiede zwischen SOAP und REST sowie die
                        <span class="dhbw-lightblue font-weight-bold">spezifischen Eigenheiten von REST</span> erkl√§ren.
                    </li>
                    <li>
                        <span class="dhbw-lightblue font-weight-bold">Typische Anwendungsf√§lle</span> von REST erkennen und von SOAP abgrenzen.
                    </li>
                    <li>
                        Erkl√§ren, was eine <span class="dhbw-lightblue font-weight-bold">WADL-Beschreibung</span> ist und welche Vorteile sie bietet.
                    </li>
                    <li>
                        WADL-Dateien in <span class="dhbw-lightblue font-weight-bold">SoapUI</span> importieren und fremde Webservices damit testen,
                    </li>
                    <li>
                        Eigene REST-Webservices mit den <span class="dhbw-lightblue font-weight-bold">JAX-RS-Annotationen</span> von Java implementieren.
                    </li>
                    <li>
                        Das <span class="dhbw-lightblue font-weight-bold">AJAX-Prinzip</span> anwenden, um REST-Webservices aus clientseitigem JavaScript heraus aufzurufen.
                    </li>
                    <li>
                        Entfernte REST-Webservices mit JAX-RS <span class="dhbw-lightblue font-weight-bold">aus Java heraus aufrufen</span>.
                    </li>
                    <li>
                        Netbeans zur Generierung der hierf√ºr ben√∂tigten Webservice-Stubs verwenden.
                    </li>
                </ul>
                <span style="font-size: 240px; color: white;" class="dhbw-text-shadow" >üèÅ</span>
            </article>
            <aside>
                <p>
                    W√§hrend im Unternehmenskontext SOAP-Webservices immer noch eine gewisse Vormachtstellung haben,
                    hat sich andernorts eine leichtgewichtigere Alternative namens REST etabliert, die viel mehr
                    auf den Gegebenheiten des HTTP-Protokolls aufbaut, sehr h√§ufig XML durch JSON ersetzt und somit
                    insgesamt einfach besser zum World Wide Web und seiner angrenzenden Technologien passt. SOAP ist
                    dadurch zwar nicht obsolet und f√ºr moderne Anwendungen uninteressant geworden, an verschiedenen
                    Stellen wurde es aber dennoch nahezu vollst√§ndig durch REST verdr√§ngt. Grund genug also, dass
                    wir uns diesen Shooting Star üå† der Webservices genauer anschauen und auch hier versuchen zu
                    verstehen, was REST ist, wie es funktioniert und wo die Unterschiede zu SOAP liegen.
                </p>
                <p>
                    In diesem Zusammenhang werden wir dann auch sehen, das REST-Webservices insgesamt viel leichtf√º√üiger
                    als SOAP aufgestellt sind, indem sie nicht nur das komplizierte XML-Format sondern mit ihm auch
                    formal verbindliche Webservice-Beschreibungen und einen gro√üen Teil darauf aufbauender Werkzeuge
                    und angrenzender, hoch-komplexer Standards √ºber Board werfen. üö¢ Denn meistens braucht man diese
                    gar nicht so sehr, wie man am Anfang vielleicht noch denkt, und merkt, dass es ohne sie eigentlich
                    genau so gut, wenn nicht sogar nur besser geht. Falls man dann aber doch eine Webservice-Beschreibung
                    braucht, werden wir sehen, dass es mit WADL eine pragmatische Alternative zu den SAOP-WSDLs gibt,
                    die uns √§hnliche M√∂glichkeiten eben nur f√ºr REST (beispielsweise die Testbarkeit mit SoapUI) bietet.
                </p>
                <p>
                    Im zweiten Teil der Folien werden wir dann in gewohnter Weise auf die Programmierung eingehen
                    und dabei zeigen, wie mit einfachen Mitteln ein eigener REST-Webservice in Java implementiert
                    werden kann. Dabei werden wir dann auch nochmal auf die Bedeutung von REST f√ºr die Entwicklung
                    clientseitiger Webanwendungen eingehen und das AJAX-Prinzip von letztem Semester nochmal aufgreifen,
                    um somit aus dem Browser heraus mit clientseitigem JavaScript, die REST-Funktionen unseres Servers
                    aufzurufen. Da aber REST nicht nur f√ºr die Entwicklung von Webanwendungen sondern sehr h√§ufig auch
                    auch zur Kommunikation mobiler Apps mit dem Backend genutzt wird, zeigen wir anschlie√üend auch,
                    wie ein Aufruf aus Java heraus gelingen kann.
                </p>
                <p>
                    Dies ist unser Fahrplan f√ºr die heutige Einheit, bevor wir den Themenkomplex Java&nbsp;EE dann
                    endg√ºltig abschlie√üen k√∂nnen.
                </p>
            </aside>
        </section>

        <!--
            =============
            SOAP VS. REST
            =============
        -->
        <section data-chapter data-background-image="../../trennfolie.jpg">
            <h1>SOAP vs. REST</h1>
            <article>
                <small>
                    <small>
                        Bildnachweis:
                        <a href="https://pixabay.com/en/adult-break-business-caucasian-2398561/" target="_blank">Pixabay: rawpixel</a>
                    </small>
                </small>
            </article>
        </section>

        <section>
            <h1>Warum REST so anders ist</h1>
            <article>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "soap_vs_rest-vergleich-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#soap_vs_rest-vergleich"
                                role          = "tab"
                                aria-controls = "soap_vs_rest-vergleich"
                                aria-expanded = "true"
                            >
                                Direkter Vergleich
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "soap_vs_rest-datenvolumen-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#soap_vs_rest-datenvolumen"
                                role          = "tab"
                                aria-controls = "soap_vs_rest-datenvolumen"
                            >
                                Umfang der Daten
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- Direkter Vergleich -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "soap_vs_rest-vergleich"
                            role            = "tabpanel"
                            aria-labelledby = "soap_vs_rest-vergleich-tab"
                        >
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-md">
                                        <h2>SOAP</h2>
                                        <img src="soap-rest-01.jpg" alt="" class="d-block img-thumbnail" style="width: 100%; margin-bottom: 1em;" />
                                        <table style="margin-bottom: 1em;">
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêò
                                                </td>
                                                <td>
                                                    Eine URL f√ºr den gesamten Webservice
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêò
                                                </td>
                                                <td>
                                                    Erm√∂glicht den Aufruf beliebiger Methoden
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêò
                                                </td>
                                                <td>
                                                    Nutzt von HTTP lediglich das Verb POST
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêò
                                                </td>
                                                <td>
                                                    SOAP-XML als fest vorgegebenes Datenformat
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêò
                                                </td>
                                                <td>
                                                    Verbindliche WSDL-Beschreibung je Service
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêò
                                                </td>
                                                <td>
                                                    H√§ufigste Verwendung im Unternehmenskontext
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="col-md">
                                        <h2>REST</h2>
                                        <img src="soap-rest-02.jpg" alt="" class="d-block img-thumbnail" style="width: 100%; margin-bottom: 1em;" />
                                        <table style="margin-bottom: 1em;">
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêá
                                                </td>
                                                <td>
                                                    Je eine URL f√ºr eine Ressource¬π
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêá
                                                </td>
                                                <td>
                                                    Bildet die √ºblichen CRUD-Operationen¬≤ ab
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêá
                                                </td>
                                                <td>
                                                    Nutzt alle Verben des HTTP-Protokolls
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêá
                                                </td>
                                                <td>
                                                    Beliebige Datenformate, in der Regel JSON
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêá
                                                </td>
                                                <td>
                                                    Optionale WADL-Beschreibung m√∂glich
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêá
                                                </td>
                                                <td>
                                                    H√§ufigste Verwendung f√ºr Cloud, Web und Mobile
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <p>
                                            <small>
                                                ¬π Im Sinne eines einzelnen Datensatzes, zum Beispiel ein Artikel oder eine Bestellung.
                                            </small>
                                        </p>
                                        <p>
                                            <small>
                                                ¬≤ Create, Read, Update und Delete
                                            </small>
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <small>
                                            <small>
                                                Bildnachweise:
                                                <a href="https://pixabay.com/de/safari-elefant-s%C3%A4ugetier-tierwelt-3035333/" target="_blank">Pixabay: ronbd</a>,
                                                <a href="https://pixabay.com/de/hase-wiese-kaninchen-gras-839297/" target="_blank">Pixabay: Bru-nO</a>,
                                            </small>
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Umfang der Daten -->
                        <div
                            class           = "tab-pane fade"
                            id              = "soap_vs_rest-datenvolumen"
                            role            = "tabpanel"
                            aria-labelledby = "soap_vs_rest-datenvolumen-tab"
                        >
                            <img src="soap-rest-03.png" alt="SOAP is so much more polite than REST" class="d-block" style="width: 30em; max-width: 100%; margin: 0 auto;" />
                            <p>
                                <small>
                                    <small>
                                        Bildnachweis:
                                        <a href="http://geek-and-poke.com/geekandpoke/2009/11/30/service-calling-made-easy-part-1.html" target="_blank">Geek &amp; Poke: 30.11.2009</a>
                                    </small>
                                </small>
                            </p>
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    Um zu verstehen, wie sich SOAP und REST unterscheiden und warum beide so definiert sind, wie sie definiert sind,
                    muss man sich die Hintergr√ºnde und die Entstehung beider Ans√§tze anschauen.
                </p>
                <p>
                    Da w√§re also zum einen SOAP, dessen
                    Vorl√§ufer <a href="https://de.wikipedia.org/wiki/XML-RPC" target="_blank">XML-RPC</a> ab 1998 bei Microsoft entstand
                    und der sich, wie der Name schon andeutet, direkt am Aufruf entfernter Methoden √ºber das Internet orientiert.¬π
                    Dabei lag der Fokus schon immer auf der Entwicklung betriebswirtschaftlicher Anwendungen, was sich auch an der
                    Beteiligung von IBM und anderen Firmen aus diesem Bereich zeigt. Der kurioseste Anwendungsfall ist dabei sicher
                    <a href="https://de.wikipedia.org/wiki/Universal_Plug_and_Play" target="_blank">Universal Plug and Play</a>, das
                    auch heute noch zur automatischen Entdeckung und Wiedergabe von Medieninhalten auf verteilten Ger√§ten innerhalb
                    des heimischen LAN genutzt wird. Davon abgesehen zielt SOAP jedoch voll und ganz auf Unternehmensanwendungen ab,
                    die ja nur sehr selten f√ºr die Nutzung hipper und aktueller Technologien bekannt sind, daf√ºr aber sehr h√§ufig
                    folgende Anforderungen haben:
                </p>
                <ul>
                    <li>
                        Interoperabilit√§t mit m√∂glichst vielen Programmiersprachen
                    </li>
                    <li>
                        Einfache Programmierung ohne viel ‚ÄûBoilerplate-Code‚Äù
                    </li>
                    <li>
                        Nutzung von zuverl√§ssigen und praxiserprobten Technologien
                    </li>
                    <li>
                        Sichere Daten√ºbertragung durch Signierung und Verschl√ºsselung
                    </li>
                    <li>
                        Gute Werkzeug-Unterst√ºtzung beim Programmieren und Testen
                    </li>
                </ul>
                <p>
                    Aus diesem Grund ist die Wahl von HTTP-POST zur Daten√ºbertragung und XML als Datenformat auch nur pragmatisch,
                    da jedes Unternehmen durch die weitere Verbreitung des World Wide Web ohnehin schon auf den Abruf von Daten via
                    HTTP vorbereitet ist es und es f√ºr XML seit jeher ein exzelentes Tooling gibt. Ebenso l√§sst sich dadurch erkl√§ren,
                    wie rund um SOAP eine ganze Menge <a href="https://de.wikipedia.org/wiki/WS-*" target="_blank">WS-*</a> genannter
                    Standards entstehen konnten, die so h√∂chst unterschiedliche Themen wie die XML-Signierung, die √úbertragung von
                    Bin√§rdaten oder die Modellierung von Gesch√§ftsprozessen abdecken.
                </p>
                <p>
                    <small>
                        ¬π RPC = Remote Procedure Call, also der Aufruf entfernter Prozeduren, wobei man in Java (da es sich ja um
                        eine objektorientierte Sprache handelt) von Methoden sprechen w√ºrde.
                    </small>
                </p>
                <p>
                    Diesem wahren Schwergewicht üèãÔ∏è steht nun <a href="https://de.wikipedia.org/wiki/Representational_State_Transfer" target="_blank">REST</a>
                    als leichtgewichtige Alternative und konzeptioneller Gegenentwurf entgegen. Im Jahr 2000 in der Dissertation
                    von Roy Fielding beschrieben, orientiert sich REST voll und ganz am HTTP-Protokoll und nutzt es als M√∂glichkeit,
                    beliebige Ressourcen¬≤ √ºber eindeutige URLs zu adressieren und mit den verschiedenen HTTP-Verben entsprechend
                    ihrer Bedeutung darauf zuzugreifen:
                </p>
                <ul>
                    <li>
                        <b>GET:</b> Daten einer Ressource abrufen
                    </li>
                    <li>
                        <b>POST:</b> Anlage einer neuen Ressource¬≥
                    </li>
                    <li>
                        <b>PUT:</b> Neue Version einer vorhandenen Ressource speichern¬≥
                    </li>
                    <li>
                        <b>PATCH:</b> Einzelne Felder einer Ressource √ºberschreiben
                    </li>
                    <li>
                        <b>DELETE:</b> L√∂schen einer Ressource
                    </li>
                </ul>
                <p>
                    <small>
                        ¬≤ In einer Datenbankanwendung w√ºrde man einzelne Datens√§tze, wie einen Kunden oder einen Zahlungsbeleg,
                        als Ressource abbilden. Davon abgesehen kann es sich aber um beliebige ‚ÄûDinge‚Äù handeln, die man √ºber
                        den Webservice verwalten will. Ein E-Mailprovider k√∂nnte daher zum Beispiel die Mail Accounts seiner
                        Kunden sowie einzelne E-Mails als Ressourcen mit eigenen URLs ansprechbar machen.
                    </small>
                </p>
                <p>
                    <small>
                        ¬≥ Tats√§chlich ist die Abgrenzung zwischen POST und PUT nicht immer strikt gew√§hlt. Es gibt auch viele
                        Webservices, die POST zur Neuanlage und PUT zur √Ñnderung von Daten oder nur ein Verb f√ºr beides nutzen.
                    </small>
                </p>
                <p>
                    Das Format der √ºbertragenen Daten ist dabei nicht verbindlich definert, aller meistens wird jedoch JSON
                    verwendet, da es platzsparender als XML ist und mit JavaScript besonders einfach verarbeitet werden kann.
                    Auch gibt es nicht zwingend eine formale XML-Beschreibung, die alle Operationen eines Webservices sowie
                    die syntaktische Struktur der √ºbertragenen Daten definiert. Hierf√ºr gibt es zwar WADL (Web Application
                    Description Language) als Quasi-Pendant zu WSDL, seine Verwendung ist aber nicht verbindlich vorgeschrieben.
                </p>
            </aside>
        </section>

        <section>
            <h1>Technische Hintergr√ºnde zu REST</h1>
            <article>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "technik-get_liste-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#technik-get_liste"
                                role          = "tab"
                                aria-controls = "technik-get_liste"
                                aria-expanded = "true"
                            >
                                Liste abrufen
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "technik-get_ressource-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#technik-get_ressource"
                                role          = "tab"
                                aria-controls = "technik-get_ressource"
                            >
                                Ressource abrufen
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "technik-post-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#technik-post"
                                role          = "tab"
                                aria-controls = "technik-post"
                                aria-expanded = "true"
                            >
                                Ressource anlegen
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "technik-wadl-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#technik-wadl"
                                role          = "tab"
                                aria-controls = "technik-wadl"
                            >
                                WADL-Beschreibung
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- Liste abrufen -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "technik-get_liste"
                            role            = "tabpanel"
                            aria-labelledby = "technik-get_liste-tab"
                        >
                            <p>
                                Bei den URLs f√ºr einen REST-Webservice wird h√§ufig zwischen <b>Collections</b> und <b>Ressourcen</b>
                                unterschieden. Eine Collection ist dabei immer eine Sammlung von Eintr√§gen, die als Ganzes
                                abgerufen werden kann. Oftmals k√∂nnen beim Abruf dann noch <b>Query Parameter</b> mitgegeben
                                werden, um die Liste einzugrenzen.
                            </p>
                            <img src="http-get-liste.svg" alt="" class="d-block" style="width: 100%;" />
                        </div>
                        <!-- Ressource abrufen -->
                        <div
                            class           = "tab-pane fade"
                            id              = "technik-get_ressource"
                            role            = "tabpanel"
                            aria-labelledby = "technik-get_ressource-tab"
                        >
                            <p>
                                Eine einzelne Ressource erkennt man daran, dass in der URL ihr Schl√ºsselwert enthalten ist.
                                Im Gegensatz zu den Collections schickt der Server dann genau ein Objekt mit den Daten der
                                angeforderten Ressource.
                            </p>
                            <img src="http-get-ressource.svg" alt="" class="d-block" style="width: 100%;" />
                        </div>
                        <!-- Ressource anlegen -->
                        <div
                            class           = "tab-pane fade show"
                            id              = "technik-post"
                            role            = "tabpanel"
                            aria-labelledby = "technik-post-tab"
                        >
                            <p>
                                Die Anlage von Ressourcen erfolgt, indem ihre JSON-Repr√§sentation als <b>POST-Anfrage an
                                die Collection</b> geschickt wird. Der Server speichert daraufhin den Eintrag und schickt
                                die gespeicherten Daten, nun um die Key-Werte angereichert, zur√ºck.
                            </p>
                            <img src="http-post.svg" alt="" class="d-block" style="width: 100%;" />
                        </div>
                        <!-- WADL-Beschreibung -->
                        <div
                            class           = "tab-pane fade"
                            id              = "technik-wadl"
                            role            = "tabpanel"
                            aria-labelledby = "technik-wadl-tab"
                        >
                            <p>
                                Im Gegensatz zu SOAP besitzen REST-Webservices oftmals keine formale Beschreibung.
                                Viele REST-API-Anbieter liefern daher vorgefertigte SDKs zum Aufruf ihrer Services
                                mit verschiedenen Sprachen. Im Java-Umfeld hat man sich stattdessen das
                                <a href="https://en.wikipedia.org/wiki/Web_Application_Description_Language" target="_blank">WADL-Format</a>
                                als eine Art ‚ÄûWSDL f√ºr beliebige Webanwendungen‚Äù √ºberlegt. Es beschreibt die URLs
                                eines Webservices und mit welchen HTTP-Methoden sie aufgerufen werden.
                            </p>
                            <table style="margin-bottom: 1em;">
                                <tr>
                                    <td style="padding-right: 0.5em;">
                                        ‚öõÔ∏è
                                    </td>
                                    <td>
                                        Welche URLs besitzt der Webservice?
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-right: 0.5em;">
                                        ‚öõÔ∏è
                                    </td>
                                    <td>
                                        Welche URL-Parameter k√∂nnen einer URL mitgegeben werden?
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-right: 0.5em;">
                                        ‚öõÔ∏è
                                    </td>
                                    <td>
                                        Welche HTML-Formularfelder k√∂nnen an die URL geschickt werden?
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-right: 0.5em;">
                                        ‚öõÔ∏è
                                    </td>
                                    <td>
                                        Welche Daten k√∂nnen mit POST, PUT oder PATCH an die URL geschickt werden?
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-right: 0.5em;">
                                        ‚öõÔ∏è
                                    </td>
                                    <td>
                                        Welche HTTP-Statuscodes kann die Antwort enthalten?
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-right: 0.5em;">
                                        ‚öõÔ∏è
                                    </td>
                                    <td>
                                        Welche Daten werden bei welchem Statuscode zur√ºckgeschickt?
                                    </td>
                                </tr>
                            </table>

                            <h2>Beispiel</h2>

                            <source-code language="xml">
                                &lt;application xmlns="http://wadl.dev.java.net/2009/02"
                                        xmlns:xs="http://www.w3.org/2001/XMLSchema"&gt;

                                    &lt;!--
                                    Hier k√∂nnten XML-Schema-Anweisungen stehen, mit welchen die Struktur
                                    der ausgetauschten Daten formal definiert wird, wenn der Webservice
                                    XML als Datenformat verwenden w√ºrde.
                                    --&gt;
                                    &lt;grammars/&gt;

                                    &lt;!--
                                    Die Basis-URL des Webservices lautet
                                    http://localhost:8080/TheXFiles/rest/
                                    --&gt;
                                    &lt;resources base="http://localhost:8080/TheXFiles/rest/"&gt;

                                        &lt;!--
                                        Nachfolgend wird die URL
                                        http://localhost:8080/TheXFiles/rest/xfiles2018/
                                        beschrieben.
                                        --&gt;
                                        &lt;resource path="xfiles2018"&gt;
                                            &lt;!--
                                            Schicken wir eine GET-Anfrage an die URL, wird dadurch die Methode
                                            findEpisodes() aufgerufen.
                                            --&gt;
                                            &lt;method id="findEpisodes" name="GET"&gt;
                                                &lt;!--
                                                Optional k√∂nnen wir der Methode einen Parameter namens "query"
                                                mitgeben. Der Parameter ist ein String und muss als URL-Parameter
                                                an die URL angeh√§ngt werden. Zum Beispiel so:

                                                http://localhost:8080/TheXFiles/rest/xfiles2018/?query=My%20Struggle
                                                --&gt;
                                                &lt;request&gt;
                                                    &lt;param name="query" style="query" type="xs:string"/&gt;
                                                &lt;/request&gt;

                                                &lt;!--
                                                Als Antwort erhalten wir dann einen JSON-String.
                                                --&gt;
                                                &lt;response&gt;
                                                    &lt;representation mediaType="application/json"/&gt;
                                                &lt;/response&gt;
                                            &lt;/method&gt;

                                            &lt;!--
                                            Eine POST-Anfrage w√ºrde hingegen die Methode saveNewEpisode() zur
                                            Anlage eines neuen Datensatzes aufrufen.
                                            --&gt;
                                            &lt;method id="saveNewEpisode" name="PUT"&gt;
                                                &lt;!--
                                                Als Anfrage m√ºssen wir einen JSON-String mitschicken.
                                                --&gt;
                                                &lt;request&gt;
                                                    &lt;representation mediaType="application/json"/&gt;
                                                &lt;/request&gt;

                                                &lt;!--
                                                Im Gegenzug schickt uns der Server ein JSON zur√ºck.
                                                --&gt;
                                                &lt;response&gt;
                                                    &lt;representation mediaType="application/json"/&gt;
                                                &lt;/response&gt;
                                            &lt;/method&gt;

                                            &lt;!--
                                            Mit der URL http://localhost:8080/TheXFiles/rest/xfiles2018/{id}/
                                            k√∂nnen wir auf einzelne Datens√§tze zugreifen. {id} ist dabei ein
                                            Platzhalter, der mit der ID des Datensatzes ersetzt werden muss.
                                            --&gt;
                                            &lt;resource path="{id}"&gt;
                                                &lt;!--
                                                Die ID keinn ein beliebiger String sein. H√§ufig kommt es aber
                                                auch vor, dass es sich um einen Long oder irgend einen anderen,
                                                primitiven Datentypen handeln muss.
                                                --&gt;
                                                &lt;param name="id" style="template" type="xs:string"/&gt;

                                                &lt;!--
                                                Schicken wir eine GET-Anfrage an die URL, wird dadurch die Methode
                                                getEpisode() aufgerufen. Sie schickt uns eine einzelne Episode im
                                                JSON-Format zur√ºck.
                                                --&gt;
                                                &lt;method id="getEpisode" name="GET"&gt;
                                                    &lt;response&gt;
                                                        &lt;representation mediaType="application/json"/&gt;
                                                    &lt;/response&gt;
                                                &lt;/method&gt;

                                                &lt;!--
                                                Schicken wir eine DELETE-Anfrage, wird stattdessen die Methode
                                                deleteEpisode() aufgerufen. Auch sie schickt uns die gel√∂schte
                                                Episode im JSON-Format zur√ºck.
                                                --&gt;
                                                &lt;method id="deleteEpisode" name="DELETE"&gt;
                                                    &lt;response&gt;
                                                        &lt;representation mediaType="application/json"/&gt;
                                                    &lt;/response&gt;
                                                &lt;/method&gt;

                                                &lt;!--
                                                Schicken wir eine PUT-Anfrage, k√∂nnen wir dadurch die Methode
                                                updateEpisode() zum Aktualisieren eines Datensatzes aufrufen.
                                                Hierf√ºr m√ºssen wir ein JSON mit den Songdaten hinschicken und
                                                bekommen ein JSON mit den gespeicherten Daten zur√ºck.
                                                --&gt;
                                                &lt;method id="updateEpisode" name="PUT"&gt;
                                                    &lt;request&gt;
                                                        &lt;representation mediaType="application/json"/&gt;
                                                    &lt;/request&gt;
                                                    &lt;response&gt;
                                                        &lt;representation mediaType="application/json"/&gt;
                                                    &lt;/response&gt;
                                                &lt;/method&gt;

                                            &lt;/resource&gt;
                                            &lt;!-- http://localhost:8080/TheXFiles/rest/xfiles2018/{id}/ --&gt;

                                        &lt;/resource&gt;
                                        &lt;!-- http://localhost:8080/TheXFiles/rest/xfiles2018/ --&gt;

                                    &lt;/resources&gt;
                                    &lt;!-- http://localhost:8080/TheXFiles/rest/ --&gt;
                                &lt;/application&gt;
                            </source-code>
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    Auf dieser Folie sieht du ein Beispiel daf√ºr, wie die verschiedenen HTTP-Verben bei REST genutzt werden, um Daten vom Server
                    zu lesen oder zu schreiben. Als Ressourcen dienen dabei die Episoden einer Fernsehserie¬π. Anhand des Beispiels sieht man auch
                    sch√∂n, dass unterschiedliche URLs unterschiedliche Bedeutungen haben. So handelt es sich bei der URL <code>/rest/xfiles2018</code>
                    um eine <b>Collection</b>, also um eine Liste von Ressourcen, die mit einer einzigen GET-Anfrage abgerufen werden kann. Diese
                    URL, die eine Liste von Episoden beschreibt, erlaubt daher nur GET und POST-Anfragen:
                </p>
                <p>
                    <small>
                        ¬π Hier Akte X, die im Jahr 2018 mit <a href="https://en.m.wikipedia.org/wiki/The_X-Files_(season_11)" target="_blank">Season 11</a>
                        schon zum zweiten mal nach dem eigentlichen Ende 2002 auf die heimischen Fernseher zur√ºckkehrt.
                    </small>
                    üëΩ
                </p>
                <ul>
                    <li>
                        <b>GET:</b> Abruf der Liste
                    </li>
                    <li>
                        <b>POST:</b> Speichern eines neuen Eintrags
                    </li>
                </ul>
                <p>
                    Bei der URL <code>/rest/xfiles2018/2AYW04/</code> handelt es sich hingegen um eine einzelne Episode, üõ∏ also um eine einzelne
                    Ressource des Webservices. Sie erlaubt die folgenden HTTP-Anfragen:
                </p>
                <ul>
                    <li>
                        <b>GET:</b> Abruf aller Detailinformationen
                    </li>
                    <li>
                        <b>PUT:</b> Speichern einer neuen Version
                    </li>
                    <li>
                        <b>PATCH:</b> Einzelne Felder √ºberschreiben
                    </li>
                    <li>
                        <b>DELETE:</b> Eintrag l√∂schen
                    </li>
                </ul>
                <p>
                    Bei GET und DELETE m√ºssen keine weiteren Daten an den Server gesendet werden. Die URL alleine reicht bereits aus, damit der Server
                    wei√ü, um welchen Datensatz es sich handelt und wie er damit umgehen muss. Bei POST muss hingegen der komplette Datensatz an den
                    Server geschickt werden, damit dieser die vorhandene Version damit ersetzen kann. Bei PATCH (sofern es der Webservice unterst√ºtzt)
                    m√ºssen hingegen nur einzelne Felder √ºbertragen werden, die man auch tats√§chlich √§ndern will.
                </p>
                <p>
                    Als Datenformat kommt bei allen Anfragen jeweils JSON zum Einsatz, was der Client durch das Header Field <code>Accept: application/json</code>
                    signalisiert. Er fordert den Server dadurch auf, seine Daten im JSON-Format zu √ºbertragen. Dass die zur√ºckgeschickten Daten dann auch wirklich
                    im JSON-Format kommen, wird hingegen durch das Header Field <code>Content-Type: application/json</code> definiert. Dadurch k√∂nnen sich Client
                    und Server auf ein Datenformat einigen, sofern der Server mehr wie eines unterst√ºtzt. H√§ufig kommt es daher vor, dass man die URL eines REST-Services
                    auch einfach im Browser eingeben kann, um eine HTML-Darstellung der Ressource zu erhalten, oder dass noch weitere Formate wie XML oder
                    <a href="https://de.wikipedia.org/wiki/YAML" target="_blank">YAML</a> unterst√ºtzt werden.
                </p>

                <h2>Formale Beschreibung mit WADL</h2>
                <p>
                    Urspr√ºnglich war f√ºr REST-Webservices keine formale Beschreibung √§hnlich der WSDL f√ºr SOAP vorgesehen, und sehr viele, wenn nicht sogar die
                    allermeisten REST-Webservices besitzen auch keine, sondern kommen nur mit einer menschenlesbaren Dokumentation oder (zumindest bei den gro√üen
                    Anbietern) mehreren <a href="https://de.wikipedia.org/wiki/Software_Development_Kit" target="_blank">SDKs</a> f√ºr verschiedene Programmiersprachen.
                    Im Javaumfeld hat sich jedoch das  <a href="https://en.wikipedia.org/wiki/Web_Application_Description_Language" target="_blank">WADL-Format</a>
                    als m√∂gliche Alternative entwickelt. Es handelt sich dabei um eine automatisch generierte XML-Datei, die man durch Anh√§ngen von <code>\application.wadl</code>
                    an die Basis-URL des Webservices abrufen kann. Sie beschreibt die erlaubten URLs, auch mit m√∂glichen Platzhaltern und URL-Parametern sowie die
                    jeweils zul√§ssigen HTTP-Verben und welche Datenformate der Server jeweils empfangen und senden kann. Optional kann sie auch Schemadefinitionen
                    f√ºr die ausgetauschten Daten enthalten. Wie wir auf der n√§chsten Folien sehen werden, lassen sich in Java entwickelte REST-Services dadurch in
                    SoapUI sehr gut testen.
                </p>
            </aside>
        </section>

        <section>
            <h1>REST-Webservices testen mit SoapUI</h1>
            <article>
                <ul class="dhbw-carousel-links">
                    <li>
                        <a href="#soapui-carousel" role="button" data-slide="next">N√§chstes Bild</a>
                    </li>
                    <li>
                        <a href="#soapui-carousel" role="button" data-slide="prev">Vorheriges Bild</a>
                    </li>
                    <li>
                        <a href="#soapui-carousel" role="button" data-slide-to="0">Nochmal von vorne</a>
                    </li>
                </ul>
                <div id="soapui-carousel" class="carousel slide" style="margin-bottom: 1em;" data-interval="false">
                    <div class="carousel-inner">
                        <div class="carousel-item img-thumbnail active">
                            <p>
                                Wieder einmal haben wir in Netbeans einen hervorragenden Webservice programmiert. ü§ó
                            </p>
                            <img class="active d-block w-100" src="soapui-01.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Durch Anh√§ngen von <tt>application.wadl</tt> an die URL k√∂nnen wir die WADL-Beschreibung abrufen.
                            </p>
                            <img class="active d-block w-100" src="soapui-02.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Um den Webservice zu testen, legen wir in SoapUI ein REST-Projekt an.
                            </p>
                            <img class="active d-block w-100" src="soapui-03.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Im folgenden Fenster m√ºssen wir auf <i>Import WADL‚Ä¶</i> klicken, um die WADL-Beschreibung zu importieren.
                            </p>
                            <img class="active d-block w-100" src="soapui-04.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Dadurch √§ndert sich das Fenster und wir k√∂nnen die URL der WADL-Beschreibung einf√ºgen.
                            </p>
                            <img class="active d-block w-100" src="soapui-05.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Anhand der WADL kann SoapUI die aufrufbaren Methoden und die URL-Struktur des Webservices erkennen.
                            </p>
                            <img class="active d-block w-100" src="soapui-06.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Die Methode <tt>createDemoData()</tt> erwartet keine Parameter, so dass wir sie direkt aufrufen k√∂nnen.
                            </p>
                            <img class="active d-block w-100" src="soapui-07.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Auf der rechten Seite zeigt SoapUI die empfangenen JSON-Daten an. In diesem Fall eine einfache Statusmeldung.
                            </p>
                            <img class="active d-block w-100" src="soapui-08.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Der Methode <tt>getListJson()</tt> kann ein URL-Parameter names ‚Äûquery‚Äù mitgegeben werden.
                                Sie liefert auch deutlich mehr Daten zur√ºck. üôÇ
                            </p>
                            <img class="active d-block w-100" src="soapui-09.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Dann wollen wir mal einen neuen Song anlegen. üéµ Die JSON-Struktur m√ºssen wir allerdings selbst herausfinden ‚Ä¶
                            </p>
                            <img class="active d-block w-100" src="soapui-10.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Unser Webservice scheint perfekt zu funktionieren. üëçüèª
                                Klasse, was SoapUI alles kann.
                            </p>
                            <img class="active d-block w-25 m-auto" src="../../finish.svg" />
                        </div>
                    </div>
                </div>

                <p>
                    <small>
                        <small>
                            Bildnachweis f√ºr das Endesymbol: <a href="https://pixabay.com/en/symbol-gui-internet-internet-page-2480163/" target="_blank">Pixabay: janf93</a>
                        </small>
                    </small>
                </p>
            </article>
            <aside>
                <p>
                    Entgegen dem Namen kannst du mit <a href="https://www.soapui.org/downloads/soapui.html" target="_blank">SoapUI</a>
                    auch wunderbar REST-Webservices testen. üòé M√∂glich macht das die WADL-Beschreibung, die Java automatisch f√ºr uns
                    generiert. Die nachfolgenden Abbildungen zeigen dir, was du hierf√ºr tun musst.
                </p>
                <img src="rest.jpg" alt="" class="d-block img-thumbnail" style="width: 100%;" />
                <p>
                    <small>
                        Bildnachweis:
                        <a href="https://pixabay.com/de/hund-tier-s%C3%A4ugetier-niedlich-3209824/" target="_blank">Pixabay: LauraHalsel</a>
                    </small>
                </p>
            </aside>
        </section>

        <section data-background-color="rgb(231, 221, 141)">
            <h1>Aufgabe 1: SoapUI kann auch REST</h1>
            <article>
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md">
                            <p>
                                Nun, welche Musik h√∂rst du gerne? üéº Hier hast du die einmalige Gelegenheit, sie √ºber einen REST-Webservice in eine Datenbank einzutragen. üòé
                                Hierf√ºr musst du dir lediglich das Beispielprojekt von Moodle herunterladen und in Netbeans zum Laufen bekommen. Anschlie√üend √∂ffnet sich
                                eine kleine Seite im Browser, mit der du erste Versuche unternehmen kannst. Gehe dabei wie folgt vor:
                            </p>
                            <ol>
                                <li>
                                    Klicke jeden Link einmal an und schaue, was passiert.
                                </li>
                                <li>
                                    Falls die Links mit der ID 151 keine Daten liefern, tausche die ID in der URL aus.
                                </li>
                                <li>
                                    Schaue dir die WADL-Datei an und versuche, sie zu verstehen.
                                </li>
                                <li>
                                    Importiere die WADL-Datei in SoapUI und teste die verschiedenen Webservice-Operationen.
                                </li>
                            </ol>
                            <p>
                                Um einen neuen Song anzulegen, kannst du folgende JSON-Daten an den Server schicken:
                            </p>
                            <source-code language="json">
                                {
                                    "name": "Circle of Life",
                                    "artist": "Elton John",
                                    "songwriters": "Tim Rice",
                                    "releaseYear:" 1994
                                }
                            </source-code>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md">
                            <img src="aufgabe1-browser.png" alt="Screenshot des Webservices im Browser" class="d-block img-thumbnail" style="width: 100%; background-color: rgb(72, 116, 140);" />
                        </div>
                        <div class="col-md">
                            <img src="aufgabe1-soapui.png" alt="Screenshot des Webservices in SoapUI" class="d-block img-thumbnail" style="width: 100%; background-color: rgb(72, 116, 140);" />
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    Hier kannst du nun deine ersten, praktischen Erfahrungen mit REST sammeln. Lade dir hierf√ºr einfach das Beispiel von Moodle
                    runter und erkunde es in SoapUI. Danach solltest mit der n√§chsten Aufgabe keine Probleme mehr haben. üéì
                </p>
                <div class="embed-responsive embed-responsive-16by9" style="margin-bottom: 1em">
                    <iframe class="embed-responsive-item" src="https://www.youtube-nocookie.com/embed/4bRuh9cNgl8?rel=0" allow="encrypted-media" allowfullscreen></iframe>
                </div>
            </aside>
        </section>

        <section data-background-color="rgb(231, 221, 141)">
            <h1>Aufgabe 2: Ein kleines REST-Quiz</h1>
            <article>
                <h2>Aufgabe 2.1: Allgemeine Fragen</h2>

                <p>
                    a) REST-Webservices besitzen eine einzige URL f√ºr alle Operationen.
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Wahr
                    </li>
                    <li>
                        Falsch
                    </li>
                </ol>

                <p>
                    b) REST-Webservices nutzen h√§ufig JSON als Datenformat, andere Formate k√∂nnen aber auch vorkommen.
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Wahr
                    </li>
                    <li>
                        Falsch
                    </li>
                </ol>

                <p>
                    c) REST-Webservices bieten einen √§hnlich gro√üen Funktionsumfang, wie SOAP mit seinen WS-*-Standards.
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Wahr
                    </li>
                    <li>
                        Falsch
                    </li>
                </ol>

                <h2>Aufgabe 2.2: Fragen zur Technik</h2>

                <p>
                    a) Welche Aufgabe hat das <code>Accept</code>-Header-Field bei einem REST-Aufruf?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Es beschreibt das Datenformat, dass der Server an den Client sendet.
                    </li>
                    <li>
                        Es beschreibt das Datenformat, dass der Client an den Server sendet.
                    </li>
                    <li>
                        Es beschreibt das Datenformat, dass der Client gerne vom Server empfangen m√∂chte.
                    </li>
                </ol>

                <p>
                    b) Welche Aufgabe hat das <code>Content-Type</code>-Header-Field bei einem REST-Aufruf?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Es beschreibt das Datenformat, dass der Server an den Client sendet.
                    </li>
                    <li>
                        Es beschreibt das Datenformat, dass der Client an den Server sendet.
                    </li>
                    <li>
                        Es beschreibt das Datenformat, dass der Client gerne vom Server empfangen m√∂chte.
                    </li>
                </ol>

                <p>
                    c) Welche der folgenden URLs dient dem Abruf einer Collection mit mehreren Songs?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        <code>https://example.com/api/songs/elton-john/your-song/</code>
                    </li>
                    <li>
                        <code>https://example.com/api/songs/</code>
                    </li>
                    <li>
                        <code>https://example.com/api/songs/511/</code>
                    </li>
                    <li>
                        <code>https://example.com/songs/your-song/?details=all</code>
                    </li>
                </ol>

                <p>
                    d) Welche Aufgabe haben die HTTP-Verben PUT und POST bei REST?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Neue Daten anlegen bzw. vorhandene Daten aktualisieren
                    </li>
                    <li>
                        Eine Liste mit mehreren Datens√§tzen auf einmal l√∂schen
                    </li>
                    <li>
                        Daten in einem anderen Format als JSON vom Server abrufen
                    </li>
                </ol>

                <p>
                    e) Wie kann man bei manchen REST-Webservices einzelne Felder anstatt allen Daten √§ndern?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Das geht nicht, da es kein passendes HTTP-Verb hierf√ºr gibt.
                    </li>
                    <li>
                        Mit dem HTTP-Verb PUT, indem nur die zu √§ndernden Felder an den Server geschickt werden.
                    </li>
                    <li>
                        Mit dem HTTP-Verb PATCH, indem nur die zu √§ndernden Felder an den Server geschickt werden.
                    </li>
                    <li>
                        Mit dem HTTP-Verb POST, indem nur die zu √§ndernden Felder an den Server geschickt werden.
                    </li>
                </ol>

                <hr />

                <p style="width: 100%; transform: scaleY(-1) scaleX(-1); display: inline-block;">
                    <small>
                        <b>L√∂sung:</b> Aufgabe 2.1: 2, 1, 2<br />
                        Aufgabe 2.2: 3, 1 + 2, 2, 1, 3
                    </small>
                </p>
            </article>
            <aside>
                <p>
                    Sehr sch√∂n, damit haben wir auch schon alle notwendigen Grundlagen zu REST durch.
                    Um sicherzugehen, dass du dir alles merken konntest, gibt es hier ein paar Fragen dazu. ‚òòÔ∏è
                </p>
            </aside>
        </section>

        <!--
            =========================
            REST-WEBSERVICES MIT JAVA
            =========================
        -->
        <section data-chapter data-background-image="../../trennfolie.jpg">
            <h1>REST-Webservices mit Java</h1>
            <article>
                <small>
                    <small>
                        Bildnachweis:
                        <a href="https://pixabay.com/en/adult-break-business-caucasian-2398561/" target="_blank">Pixabay: rawpixel</a>
                    </small>
                </small>
            </article>
        </section>

        <section>
            <h1>Eigene Webservices definieren</h1>
            <article>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "programmierung-annotationen-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#programmierung-annotationen"
                                role          = "tab"
                                aria-controls = "programmierung-annotationen"
                                aria-expanded = "true"
                            >
                                Ben√∂tigte Annotationen
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "programmierung-datenmodell-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#programmierung-datenmodell"
                                role          = "tab"
                                aria-controls = "programmierung-datenmodell"
                            >
                                Datenmodell
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "programmierung-application-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#programmierung-application"
                                role          = "tab"
                                aria-controls = "programmierung-application"
                            >
                                Application-Klasse
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "programmierung-webservice-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#programmierung-webservice"
                                role          = "tab"
                                aria-controls = "programmierung-webservice"
                            >
                                Webservice-Klassen
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- Ben√∂tigte Annotationen -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "programmierung-annotationen"
                            role            = "tabpanel"
                            aria-labelledby = "programmierung-annotationen-tab"
                        >
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-md">
                                        <h2>Application-Klasse</h2>
                                        <p>
                                            Ein REST-Webservice besitzt in Java immer mindestens zwei Klassen. Die Application-Klasse legt dabei den URL-Prefix
                                            des Webserivces fest und bindet eine oder mehrere Webservice-Klassen f√ºr die eigentlichen Ressourcen ein. Sie kennt
                                            nur eine Annotation, die immer verwendet werden muss.
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <h3>@ApplicationPath</h3>
                                        <p>
                                            Steht vor der Application-Klasse des Webservices und definiert dort die Basis-URL aller Ressourcen.
                                        </p>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md">
                                        <h2>Webservice-Klassen</h2>
                                        <p>
                                            Jede Ressource des Webservices wird in einer eigenen Webservice-Klasse ausprogrammiert. Sie beinhaltet die einzelnen
                                            Methoden des Webservices und legt fest, mit welchen URL-Mustern und HTTP-Verben die Methoden aufgerufen werden k√∂nnen.
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <h3>@GET</h3>
                                        <p>
                                            Kennzeichnet eine Methode, die bei einer GET-Anfrage aufgerufen wird und dem Abruf von Daten dient.
                                        </p>
                                    </div>
                                    <div class="col-md">
                                        <h3>@POST</h3>
                                        <p>
                                            Kennzeichnet eine Methode, die bei einer POST-Anfrage aufgerufen wird und der Anlage neuer Daten dient.
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <h3>@PUT</h3>
                                        <p>
                                            Kennzeichnet eine Methode, die bei einer PUT-Anfrage aufgerufen wird und der √Ñnderung bereits vorhandener Daten dient.
                                        </p>
                                    </div>
                                    <div class="col-md">
                                        <h3>@DELETE</h3>
                                        <p>
                                            Kennzeichnet eine Methode, die bei einer DELETE-Anfrage aufgerufen wird und der L√∂schung vorhandener  Daten dient.
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <hr />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <h3>@Produces</h3>
                                        <p>
                                            Definiert den <a href="https://en.wikipedia.org/wiki/Media_type" target="_blank">MIME-Type</a> der durch die Methode
                                            zur√ºckgelieferten Daten.
                                        </p>
                                    </div>
                                    <div class="col-md">
                                        <h3>@Consumes</h3>
                                        <p>
                                            Definiert den <a href="https://en.wikipedia.org/wiki/Media_type" target="_blank">MIME-Type</a> der durch die Methode
                                            verarbeitbaren Daten. Auf diese Weise k√∂nnen mehrere Methoden zur exakt selben URL definiert werden, da immer die
                                            Methode aufgerufen wird, welche die vom Client gesendeten Daten verarbeiten kann.
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <hr />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <h3>@Path</h3>
                                        <p>
                                            Kann vor einer Klasse oder Methode stehen und definiert den Teil der URL, der zum Aufruf der jeweiligen Klasse
                                            oder Methode f√ºhrt. In geschweiften Klammern k√∂nnen dabei <b>Platzhalter</b> stehen, die als Parameter an die
                                            aufgerufene Methode √ºbergeben werden. Zum Beispiel: <src-code language="java">@Path("song/{id}")</src-code>
                                        </p>
                                    </div>
                                    <div class="col-md">
                                        <h3>@PathParam</h3>
                                        <p>
                                            Kennzeichnet einen Methodenparameter, dessen Wert √ºber einen Platzhaler in der URL ermittelt wird.
                                            Zum Beispiel: <src-code language="java">@PathParam("id") String id</src-code>
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <h3>@QueryParam</h3>
                                        <p>
                                            Steht vor einem Methodenparameter und legt fest, dass dieser in Form eines URL-Parameters √ºbergeben wird.
                                            Zum Beispiel muss bei <src-code language="java">@QueryParam("search") String search</src-code> der String
                                            <code>?search=Queen</code> an die URL abgeh√§ngt werden, um den Wert <tt>Queen</tt> zu √ºbergeben.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Datenmodell -->
                        <div
                            class           = "tab-pane fade"
                            id              = "programmierung-datenmodell"
                            role            = "tabpanel"
                            aria-labelledby = "programmierung-datenmodell-tab"
                        >
                            <p>
                                Wie immer ben√∂tigen wir erst einmal ein paar Persistence Entities und Enterprise Java Beans. Zumindest, wenn wir Daten
                                aus einer Datenbank lesen und schreiben wollen. üõ¢Ô∏è F√ºr die EJB nutzen wir wie immer die
                                <a href="../../2-javaee/jpa/#19" target="_blank"><code>EntityBean</code> aus den JPA-Folien</a>.
                            </p>
                            <source-code language="java">
                                /**
                                 * Einfache Entity-Klasse f√ºr einen Song.
                                 */
                                @Entity
                                public class Song implements Serializable {

                                    @Id
                                    @GeneratedValue(generator = "song_ids")
                                    @TableGenerator(name = "song_ids", initialValue = 0, allocationSize = 50)
                                    private final long id = 0L;

                                    private String name = "";
                                    private String artist = "";
                                    private String songwriters = "";
                                    private int releaseYear = 0;

                                    // Konstruktoren

                                    // Setter und Getter
                                }

                                /**
                                 * Einfache EJB mit den √ºblichen Methoden zum Lesen und Schreiben von
                                 * Songs in der Datenbank. Diese Klasse nutzt unsere altbekannte EntityBean
                                 * aus den JPA-Folien, um einen Grundstock an Standardmethoden anzubieten.
                                 */
                                @Stateless
                                public class SongBean extends EntityBean<Song, Long> {

                                    public SongBean() {
                                        super(Song.class);
                                    }
                                }
                            </source-code>
                        </div>
                        <!-- Application-Klasse -->
                        <div
                            class           = "tab-pane fade"
                            id              = "programmierung-application"
                            role            = "tabpanel"
                            aria-labelledby = "programmierung-application-tab"
                        >
                            <p>
                                Im Gegensatz zu SOAP ben√∂tigt jeder REST-Webservice in Java eine Application-Klasse, welche
                                den URL-Prefix des Webservices definiert und in welche alle weiteren Klassen aufgenommen
                                werden m√ºssen. Wichtig sind hierbei die Annotation <code>@ApplicationPath</code> f√ºr die URL
                                sowie die Methode <code>getClasses()</code>, die eine Liste aller REST-Webservice-Klassen
                                zur√ºckliefert.
                            </p>
                            <source-code language="java">
                                /**
                                * Einstiegspunkt f√ºr unseren REST-Webservice. Hier wird der URL-Prefix aller
                                * Aufrufe definiert (√ºber @ApplicationPath), sowie alle Collections und
                                * Resourcen dem Webservice hinzugef√ºgt. Diese Klasse muss daher immer angepasst
                                * werden, wenn weitere Collections oder Resourcen hinzukommen.
                                 */
                                @ApplicationPath("api")
                                public class MusicalRestAPI extends Application {

                                    @Override
                                    public Set&lt;Class&lt;?&gt;&gt; getClasses() {
                                        Set&lt;Class&lt;?&gt;&gt; resources = new java.util.HashSet&lt;&gt;();

                                        // Hier f√ºr jede Webservice-Klasse eine Zeile hinzuf√ºgen
                                        resources.add(SongCollection.class);
                                        resources.add(SongResource.class);

                                        return resources;
                                    }
                                }
                            </source-code>
                        </div>
                        <!-- Webservice-Klassen -->
                        <div
                            class           = "tab-pane fade"
                            id              = "programmierung-webservice"
                            role            = "tabpanel"
                            aria-labelledby = "programmierung-webservice-tab"
                        >
                            <p>
                                Bei den eigentlichen Webservice-Klassen, die jeweils f√ºr eine Collection oder Ressource des Webservices stehen,
                                handelt es sich wieder um altbekannte Stateless Session Beans. üë¥üèΩ Ihre Methoden werden durch die √ºbrigen Annotationen
                                auf die verschiedenen URLs und HTTP-Verben gemappt. Fangen wir also mit der Klasse f√ºr eine <b>Collection</b> an,
                                um eine ganze Liste auszulesen (bzw. Eintr√§ge suchen) und neue Eintr√§ge anlegen zu k√∂nnen:
                            </p>
                            <source-code language="java">
                                /**
                                 * Collection "Songs" zum Suchen von Songs und Speichern neuer Songs.
                                 */
                                @Stateless
                                @Path("Songs")
                                public class SongCollection {

                                    @EJB
                                    SongBean songBean;

                                    /**
                                     * GET /api/Songs/List/
                                     * Auslesen einer Liste von Musikst√ºcken.
                                     */
                                    @GET
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public List&lt;Song&gt; findSongs() {
                                        return this.songBean.findAll();
                                    }

                                    /**
                                     * POST /api/Songs/
                                     * Speichern eines neuen Songs.
                                     */
                                    @POST
                                    @Consumes(MediaType.APPLICATION_JSON)
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public String saveNewSong(Song song) {
                                        return this.songBean.saveNew(song);
                                    }
                                }
                            </source-code>
                            <p>
                                Anschlie√üend legen wir eine weitere Klasse f√ºr <b>einzelne Ressourcen</b> an. Streng genommen k√∂nnten die Methoden
                                zwar auch alle in einer Klasse stehen (<code>@Path</code> kann auch vor einer Methode stehen), so ist es jedoch
                                √ºbersichtlicher und damit wartbarer.
                            </p>
                            <source-code language="java">
                                /**
                                 * Ressource f√ºr einen einzelnen Song. Hier kann ein einzelner Song abgerufen,
                                 * aktualisiert oder gel√∂scht werden.
                                 */
                                @Stateless
                                @Path("Songs/{id}")
                                public class SongResource {

                                    @EJB
                                    SongBean songBean;

                                    /**
                                     * GET /api/Songs/{id}/
                                     * Auslesen eines einzelnen Songs anhand seiner ID.
                                     */
                                    @GET
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public Song getSong(@PathParam("id") long id) {
                                        return this.songBean.findById(id);
                                    }


                                    /**
                                     * PUT /api/Songs/{id}/
                                     * Aktualisieren eines vorhandenen Songs.
                                     */
                                    @PUT
                                    @Consumes(MediaType.APPLICATION_JSON)
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public Song updateSong(Song song) {
                                        return this.songBean.update(song);
                                    }

                                    /**
                                     * DELETE /api/Songs/{id}/
                                     * L√∂schen eines vorhandenen Songs.
                                     */
                                    @DELETE
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public Song deleteSong(@PathParam("id") long id) {
                                        Song song = this.songBean.findById(id);

                                        if (response.song != null) {
                                            this.songBean.delete(response.song);
                                        }

                                        return song;
                                    }
                                }
                            </source-code>
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    Zugegeben, die Definition eigener Webservices ist mit REST kompliziert als mit SOAP. ü§¶ Aber daf√ºr ticken sie eben auch ganz
                    anders und erfordern deshalb auch mehr Annotationen. Hat man aber einmal den Dreh raus, ist es auch nicht wirklich kompliziert.
                    Man muss sich nur ein paar Gedanken dar√ºber machen, wie die URLs des Webservices aufgebaut sein sollen und welche Ressource
                    mit welcher URL angesprochen wird. Auch muss man sich nat√ºrlich √ºberlegen, welche HTTP-Verben und damit auch welche Operationen
                    man √ºberhaupt unterst√ºtzen will. Eine gutes Vorgehen ist dabei folgendes:
                </p>
                <p>
                    Zun√§chst legt man √ºber die <b>Application-Klasse</b> des Webservices seine Basis-URL fest. Also den Prefix, mit dem alle
                    URLs des Webservices beginnen. Dies geschieht durch die Annotation <code>@ApplicationPath</code>, die vor eine Klasse
                    die von <code>Application</code> erbt, steht:
                </p>
                <source-code language="java">
                    @ApplicationPath("api")
                    public class ApplicationConfig extends Application { ‚Ä¶ }
                </source-code>
                <p>
                    In diesem Beispiel beginnen also alle URLs mit <code>/api/</code>. Anschlie√üend definiert man je Ressource zwei Webservice-Klassen
                    und f√ºhrt sie innerhalb der Application-Klasse auf. Eine Klasse f√ºr Collection zum Auslesen einer Liste und zur Anlage neuer Daten
                    sowie eine f√ºr einzelne Ressourcen.
                </p>
                <source-code language="java">
                    @ApplicationPath("api")
                    public class MusicalRestAPI extends Application {
                        @Override
                        public Set&lt;Class&lt;?&gt;&gt; getClasses() {
                            Set&lt;Class&lt;?&gt;&gt; resources = new java.util.HashSet&lt;&gt;();

                            // Hier f√ºr jede Webservice-Klasse eine Zeile hinzuf√ºgen
                            resources.add(SongCollection.class);
                            resources.add(SongResource.class);

                            return resources;
                        }
                    }
                </source-code>
                <p>
                    Die Webservice-Klassen bekommen, da sie ja f√ºr eine Ressource mit einer eindeutigen URL stehen, √ºber die <code>@Path</code>-Annotation
                    einen eigenen URL-Prefix innerhalb der Basis-URL zugewiesen:
                </p>
                <source-code language="java">
                    @Stateless
                    @Path("Songs")
                    public class SongCollection { ‚Ä¶ }

                    @Stateless
                    @Path("Songs/{id}")
                    public class SongResource { ‚Ä¶ }
                </source-code>
                <p>
                    Hier haben wir es zum Beispiel mit der Ressource Songs zu tun, die √ºber die URL <code>/api/songs/</code> f√ºr die Collection sowie
                    <code>/api/songs/{id}</code> f√ºr einen einzelnen Song angesprochen wird. <code>{id}</code> ist dabei ein Platzhalter, der durch
                    die eigentliche ID ersetzt werden muss.
                </p>
                <p>
                    Weiter geht es mit der Collection-Klasse. Sie bekommt zwei Methoden f√ºr GET- und POST-Anfragen, zum Auslesen einer Liste sowie
                    zum Anlegen eines neuen Eintrags:
                </p>
                <source-code language="java">
                    @Stateless
                    @Path("Songs")
                    public class SongCollection {

                        @GET
                        @Produces(MediaType.APPLICATION_JSON)
                        public List&lt;Song&gt; findSongs() { ‚Ä¶ }

                        @POST
                        @Consumes(MediaType.APPLICATION_JSON)
                        @Produces(MediaType.APPLICATION_JSON)
                        public Song saveNewSong(Song song) { ‚Ä¶ }
                    }
                </source-code>
                <p>
                    Die Ressourcenklasse f√ºr einzelne Datens√§tze hingegen bekommt Methoden f√ºr GET-, PUT- und DELETE-Anfragen.
                </p>
                <source-code language="java">
                    @Stateless
                    @Path("Songs/{id}")
                    public class SongResource {

                        @GET
                        @Produces(MediaType.APPLICATION_JSON)
                        public Song getSong(@PathParam("id") long id) { ‚Ä¶ }

                        @PUT
                        @Consumes(MediaType.APPLICATION_JSON)
                        @Produces(MediaType.APPLICATION_JSON)
                        public Song updateSong(Song song) { ‚Ä¶ }

                        @DELETE
                        @Produces(MediaType.APPLICATION_JSON)
                        public Song deleteSong(@PathParam("id") long id) { ‚Ä¶ }
                    }
                </source-code>
                <p>
                    Dadurch hat mein eine saubere Quellcodestruktur und logische RESTful URLs, die nicht im Widerspruch zur Bedeutung der
                    Methoden stehen.
                </p>
            </aside>
        </section>

        <section>
            <h1>Die Antwortdaten flexibler gestalten</h1>
            <article>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "antwortdaten-projekttyp-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#antwortdaten-projekttyp"
                                role          = "tab"
                                aria-controls = "antwortdaten-projekttyp"
                                aria-expanded = "true"
                            >
                                Maven-Projekt anlegen
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "antwortdaten-pom-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#antwortdaten-pom"
                                role          = "tab"
                                aria-controls = "antwortdaten-pom"
                            >
                                Erweiterung der pom.xml
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "antwortdaten-code-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#antwortdaten-code"
                                role          = "tab"
                                aria-controls = "antwortdaten-code"
                            >
                                √Ñnderungen am Quellcode
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- Maven-Projekt anlegen -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "antwortdaten-projekttyp"
                            role            = "tabpanel"
                            aria-labelledby = "antwortdaten-projekttyp-tab"
                        >
                            <p>
                                Damit der hier beschriebene Trick funktioniert, ist es wichtig, das Projekt als <b>Maven-Projekt</b> anzulegen.
                                Dadurch wird das Build-Werkzeug Maven anstelle von Ant verwendet, wodurch wir ganz einfach, fremde Abh√§ngigkeiten
                                wie die GSON-Bibliothek hinzuf√ºgen k√∂nnen, ohne die hierf√ºr notwendigen Daten manuell herunterladen zu m√ºssen.
                                Au√üerdem l√§sst sich das Projekt somit auch in anderen IDEs √∂ffnen oder gar v√∂llig ohne IDE weiterentwickeln.
                            </p>
                            <img src="maven-webapp.png" alt="Maven / Web Application ist der richtige Projekttyp" class="d-block" style="widht: 100%;" />
                        </div>
                        <!-- Erweiterung der pom.xml -->
                        <div
                            class           = "tab-pane fade"
                            id              = "antwortdaten-pom"
                            role            = "tabpanel"
                            aria-labelledby = "antwortdaten-pom-tab"
                        >
                            <p>
                                Innerhalb des Ordners <b>Project Files</b> findet sich dann die Datei <tt>pom.xml</tt>. Sie geh√∂rt zu Maven und
                                beschreibt das gesamte Projekt, unter anderem auch, welche Abh√§ngigkeiten es besitzt. Die nachfolgenden Zeilen
                                m√ºssen im Bereich <src-code language="xml">&lt;dependencies&gt;‚Ä¶&lt;/dependencies&gt;</src-code> eingef√ºgt werden:
                            </p>
                            <source-code language="xml">
                                &lt;project&gt;
                                    ‚Ä¶
                                    &lt;dependencies&gt;
                                        ‚Ä¶
                                        &lt;!--
                                            Google GSON
                                            ===========

                                            Damit l√§sst sich ein Javaobjekt nach JSON umwandeln und umgekehrt.
                                            https://mvnrepository.com/artifact/com.google.code.gson/gson
                                        --&gt;
                                        &lt;dependency&gt;
                                            &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt;
                                            &lt;artifactId&gt;gson&lt;/artifactId&gt;
                                            &lt;version&gt;2.8.2&lt;/version&gt;
                                        &lt;/dependency&gt;
                                    &lt;/dependencies&gt;
                                    ‚Ä¶
                                &lt;/project&gt;
                            </source-code>
                        </div>
                        <!-- √Ñnderungen am Quellcode -->
                        <div
                            class           = "tab-pane fade"
                            id              = "antwortdaten-code"
                            role            = "tabpanel"
                            aria-labelledby = "antwortdaten-code-tab"
                        >
                            <p>
                                Und hier nun die angepasste Version der Klasse <code>SongCollection</code>. Im Konstruktor der Klasse wird ein
                                neues GSON-Objekt erzeugt, das zum (De)serialisieren der JSON-Daten verwendet werden kann. Diese werden den
                                Methoden daher nun als String √ºbergeben und auch der R√ºckgabewert aller Methoden ist ein String. Zus√§tzlich
                                beinhaltet die Klasse eine innere Klasse namens <code>Response</code>, die alle f√ºr eine Antwort ben√∂tigten Felder
                                enth√§lt:
                            </p>
                            <ul>
                                <li>
                                    <b>song:</b> R√úckgabedaten eines einzelnen Songs, falls die Methode immer nur einen Song liefern kann.
                                </li>
                                <li>
                                    <b>songs:</b> R√ºckgabedaten einer ganzen Liste von Songs, falls die Methode potentiell mehrere Eintr√§ge liefern kann.
                                </li>
                                <li>
                                    <b>status:</b> Ein einfacher Statuscode wie <tt>OK</tt> oder <tt>ERROR</tt>, anhand dessen der Client
                                    erkennen kann, ob der Aufruf erfolgreich war.
                                </li>
                                <li>
                                    <b>exception:</b> Der Name der aufgetretenen Exception, falls es zu einem Fehler kam.
                                </li>
                                <li>
                                    <b>message:</b> Eine f√ºr den Anwender verst√§ndliche Status- oder Fehlermeldung, die der Client bei Bedarf
                                    auch anzeigen kann.
                                </li>
                            </ul>
                            <p>
                                Die ver√§nderte <code>SongCollection</code>-Klasse sieht dadurch wie folgt aus. Nat√ºrlich muss die Klasse
                                <code>SongResource</code> analog dazu angepasst werden, auch wenn das hier nicht gezeigt wird.
                            </p>
                            <source-code language="java">
                                /**
                                 * Collection "Songs" zum Suchen von Songs und Speichern neuer Songs.
                                 */
                                @Stateless
                                @Path("Songs")
                                public class SongCollection {

                                    @EJB
                                    SongBean songBean;

                                    // GSON-Objekt zur (De)serialisierung von JSON
                                    Gson gson = this.gson = new GsonBuilder().create();

                                    /**
                                     * Datencontainer f√ºr die Antwortdaten, die von den Methoden unten jeweils
                                     * zur√ºckgeschickt werden k√∂nnen.
                                     */
                                    public class Response {

                                        public Song song;
                                        public List<Song> songs;
                                        public String status;
                                        public String exception;
                                        public String message;
                                    }

                                    /**
                                     * GET /api/Songs/List/
                                     * Auslesen einer Liste von Musikst√ºcken.
                                     */
                                    @GET
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public String findSongs() {
                                        Response response = new Response();

                                        try {
                                            response.songs = this.songBean.findAll();
                                            response.status = "OK";
                                        } catch (Exception ex) {
                                            response.status = "ERROR";
                                            response.exception = ex.getClass().getName();
                                            response.message = ex.getMessage();
                                        }

                                        return this.gson.toJson(response);
                                    }

                                    /**
                                     * POST /api/Songs/
                                     * Speichern eines neuen Songs.
                                     */
                                    @POST
                                    @Consumes(MediaType.APPLICATION_JSON)
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public String saveNewSong(String json) {
                                        Response response = new Response();

                                        try {
                                            Song song = this.gson.fromJson(json, Song.class);
                                            response.song = this.songBean.saveNew(song);
                                            response.status = "OK";
                                        } catch (Exception ex) {
                                            response.status = "ERROR";
                                            response.exception = ex.getClass().getName();
                                            response.message = ex.getMessage();
                                        }

                                        return this.gson.toJson(response);
                                    }
                                }
                            </source-code>
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    Auf der vorherigen Folie hast du gesehen, dass Java automatisch alle Objekte, die einer Methode √ºbergeben werden,
                    oder die sie zur√ºck gibt, von und nach JSON umwandeln kann. Allerdings gibt es hierbei zwei Probleme:
                </p>
                <ol>
                    <li>
                        Glassfish 4.1.1, der mit Netbeans 8.2 ausgeliefert wird, hat einen bl√∂den Bug, der genau dies verhindert
                        und stattdessen die Anwendung abst√ºrzen l√§sst.¬π üòü
                    </li>
                    <li>
                        Wir k√∂nnen, so wie es auf der Folie gezeigt wurde, keine Fehlermeldungen an den Client senden. Wirft
                        eine der Methoden eine Exception, st√ºrzt die Anwendung ab und der Client bekommt eine 500er-Fehlerseite
                        im HTML-Format. ü§Ø
                    </li>
                </ol>
                <p>
                    <small>
                        ¬π In Glassfish 5.0 ist der Bug behoben.
                    </small>
                </p>
                <p>
                    Auf dieser Folie siehst du daher einen L√∂sungsansatz, der beide Probleme elegang behebt. Zur Umgehung des
                    Glassfish-Bugs binden wir die <a href="https://github.com/google/gson" target="_blank">GSON</a>-Bibliothek
                    von Google ein und um die M√∂glichkeit zu schaffen, auch Fehlermeldungen zur√ºckzusenden, definieren wir eine
                    spezielle <b>Response-Klasse</b>, die einen Stautscode, einen Meldungstext sowie die eigentlichen Nutzdaten
                    der Antwort enthalten kann. Und das Gute ist, dass der Code dadurch gar nicht so viel kompliziert wird.
                    Ganz im Gegenteil, so sollte man es eigentlich immer machen. üôÇ
                </p>
            </aside>
        </section>

        <section>
            <h1>Exkurs: Und wie sichern wir das ganze ab?</h1>
            <article>
                <table style="margin-bottom: 1em;">
                    <tr>
                        <td style="padding-right: 0.5em">
                            üî•
                        </td>
                        <td>
                            REST-Webservices lassen sich mit Java viel einfacher absichern, als SOAP-Webservices.
                        </td>
                    </tr>
                    <tr>
                        <td style="padding-right: 0.5em">
                            üî•
                        </td>
                        <td>
                            Wir m√ºssen lediglich die Datei <tt>WEB-INF\web.xml</tt> und die Serverkonfiguration anpassen.
                        </td>
                    </tr>
                </table>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "auth-entity-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#auth-entity"
                                role          = "tab"
                                aria-controls = "auth-entity"
                            >
                                User-Entity
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "auth-webxml-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#auth-webxml"
                                role          = "tab"
                                aria-controls = "auth-webxml"
                            >
                                web.xml
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "auth-glassfishwebxml-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#auth-glassfishwebxml"
                                role          = "tab"
                                aria-controls = "auth-glassfishwebxml"
                            >
                                glassfish-web.xml
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "auth-realm-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#auth-realm"
                                role          = "tab"
                                aria-controls = "auth-realm"
                            >
                                Realm
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- User-Entity -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "auth-entity"
                            role            = "tabpanel"
                            aria-labelledby = "auth-entity-tab"
                        >
                            <p>
                                Zun√§chst ben√∂tigen wir eine Entity, um Benutzer in der Datenbank speichern zu k√∂nnen.
                                Sie entspricht im Wesentlichen dem Beispiel, dass wir auch schon in den EJB-Aufgaben
                                gesehen haben.
                            </p>
                            <source-code language="java">
                                /**
                                 * Datenbankklasse f√ºr einen Benutzer. Dies ist eine Variation der User-Klasse
                                 * von jTodo.
                                 */
                                @Entity
                                @Table(name = "REST_USER")
                                public class User implements Serializable {

                                    @Id
                                    @Column(name = "USERNAME", length = 64)
                                    private String username;

                                    @Column(name = "PASSWORD_HASH", length = 64)
                                    private String passwordHash;

                                    @ElementCollection
                                    @CollectionTable(
                                            name = "REST_USER_GROUP",
                                            joinColumns = @JoinColumn(name = "USERNAME")
                                    )
                                    @Column(name = "GROUPNAME")
                                    List&lt;String&gt; groups = new ArrayList&lt;&gt;();

                                    // Konstruktoren ‚Ä¶

                                    // Setter und Getter ‚Ä¶

                                    // Methoden zum Hashen des Passworts ‚Ä¶

                                    // Methoden f√ºr die Zuordnung zu Benutzergruppen ‚Ä¶
                                }

                                /**
                                 * Spezielle EJB zum Anlegen eines Benutzers und Aktualisierung des Passworts.
                                 * Dies ist im Prinzip dieselbe EJB, wie im jTodo-Beispiel.
                                 */
                                @Stateless
                                public class UserBean {

                                    @PersistenceContext
                                    EntityManager em;

                                    /**
                                     * Registrieren eines neuen Benutzers.
                                     */
                                    public void signup(String username, String password, String... groups)
                                            throws UserAlreadyExistsException {

                                        if (em.find(User.class, username) != null) {
                                            throw new UserAlreadyExistsException("Der Benutzername $B ist bereits vergeben.".replace("$B", username));
                                        }

                                        User user = new User(username, password);

                                        for (String group : groups) {
                                            user.addToGroup(group);
                                        }

                                        em.persist(user);
                                    }

                                    /**
                                     * Fehler: Der Benutzername ist bereits vergeben.
                                     */
                                    public class UserAlreadyExistsException extends Exception {

                                        public UserAlreadyExistsException(String message) {
                                            super(message);
                                        }
                                    }
                                }
                            </source-code>
                        </div>
                        <!-- web.xml -->
                        <div
                            class           = "tab-pane fade show"
                            id              = "auth-webxml"
                            role            = "tabpanel"
                            aria-labelledby = "auth-webxml-tab"
                        >
                            <p>
                                Die eigentliche Absicherung erfolgt dann √ºber die Datei <tt>WEB-INF\web.xml</tt>. Hier legen wir fest,
                                wie sich ein Anwender authentifizieren kann und welche Rolle er haben muss, um bestimmte HTTP-Verben
                                an bestimmte URLs senden zu d√ºrfen.
                            </p>
                            <p>
                                <b>
                                    Vorsicht! Java ist hier zickig mit der Reihenfolge! ü¶Ñ
                                </b>
                            </p>
                            <source-code language="xml">
                                &lt;web-app&gt;
                                    &lt;security-constraint&gt;
                                        &lt;!-- √Ñndernde Zugriffe auf Songs --&gt;
                                        &lt;web-resource-collection&gt;
                                            &lt;web-resource-name&gt;Songs&lt;/web-resource-name&gt;
                                            &lt;url-pattern&gt;/api/Songs/*&lt;/url-pattern&gt;

                                            &lt;http-method&gt;PUT&lt;/http-method&gt;
                                            &lt;http-method&gt;POST&lt;/http-method&gt;
                                            &lt;http-method&gt;PATCH&lt;/http-method&gt;
                                            &lt;http-method&gt;DELETE&lt;/http-method&gt;
                                        &lt;/web-resource-collection&gt;

                                        &lt;!-- Ben√∂tigte Rolle --&gt;
                                        &lt;auth-constraint&gt;
                                            &lt;role-name&gt;rest-beispiel-user&lt;/role-name&gt;
                                        &lt;/auth-constraint&gt;

                                        &lt;!-- Zugriff nur via HTTPS erlauben --&gt;
                                        &lt;user-data-constraint&gt;
                                            &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;
                                        &lt;/user-data-constraint&gt;
                                    &lt;/security-constraint&gt;

                                    &lt;!-- Definition, dass es die Rolle √ºberhaupt gibt --&gt;
                                    &lt;security-role&gt;
                                        &lt;role-name&gt;rest-beispiel-user&lt;/role-name&gt;
                                    &lt;/security-role&gt;

                                    &lt;!-- Art der Authentifzierung--&gt;
                                    &lt;login-config&gt;
                                        &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
                                        &lt;realm-name&gt;rest-beispiel&lt;/realm-name&gt;
                                    &lt;/login-config&gt;
                                &lt;/web-app&gt;
                            </source-code>
                        </div>
                        <!-- glassfish-web.xml -->
                        <div
                            class           = "tab-pane fade"
                            id              = "auth-glassfishwebxml"
                            role            = "tabpanel"
                            aria-labelledby = "auth-glassfishwebxml-tab"
                        >
                            <p>
                                Diese Datei, die ebenfalls im Verzeichnis <tt>WEB-INF</tt> liegen muss, geh√∂rt nicht zu Java,
                                sondern zum Glassfish. Hier wird jeder Benutzergruppe, so wie sie in der Datenbank gespeichert ist,
                                eine Rolle zugeordnet, die der Server pr√ºfen kann.
                            </p>
                            <source-code language="xml">
                                &lt;?xml version="1.0" encoding="UTF-8"?&gt;
                                &lt;!DOCTYPE glassfish-web-app PUBLIC
                                    "-//GlassFish.org//DTD GlassFish Application Server 3.1 Servlet 3.0//EN"
                                    "http://glassfish.org/dtds/glassfish-web-app_3_0-1.dtd"&gt;

                                &lt;glassfish-web-app error-url=""&gt;
                                    &lt;security-role-mapping&gt;
                                        &lt;role-name&gt;rest-beispiel-user&lt;/role-name&gt;
                                        &lt;group-name&gt;rest-beispiel-user&lt;/group-name&gt;
                                    &lt;/security-role-mapping&gt;

                                    &lt;parameter-encoding default-charset="UTF-8" /&gt;
                                &lt;/glassfish-web-app&gt;
                            </source-code>
                        </div>
                        <!-- Realm -->
                        <div
                            class           = "tab-pane fade show"
                            id              = "auth-realm"
                            role            = "tabpanel"
                            aria-labelledby = "auth-realm-tab"
                        >
                            <p>
                                Und damit der Server wei√ü, in welchen Tabellen die Benutzerdaten liegen, m√ºssen wir wieder eine neues
                                ‚ÄûRealm‚Äù in der Glassfish-Adminkonsole anlegen. Wie immer, musst du hier besonders auf Tippfehler achten.
                            </p>
                            <img src="auth-realm.png" alt="Realm-Konfiguration im Glassfish" class="d-block" style="width: 100%;" />
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    In der Praxis ist es nat√ºrlich wichtig, einen REST-Webservices mit Berechtigungen abzusichern, damit nicht jeder
                    Anwender, wom√∂glich noch, ohne sich √ºberhaupt anzumelden, einfach beliebige Daten ver√§ndern kann. Hierf√ºr kennt
                    Java zwei M√∂glichkeiten, eine furchtbar komplizierte¬π mit <code>@RolesAllowed</code> und eine besonders einfache
                    √ºber die Datei <tt>web.xml</tt>. Wir schauen uns hier nur die einfache Version an, da die andere viel zu aufw√§ndig
                    ist f√ºr das was sie bietet.
                </p>
                <p>
                    <small>
                        ¬π Da genau wie bei SOAP nicht vollst√§ndig zu Ende spezifiziert und somit serverabh√§ngig. Schlimmer noch,
                        man muss sogar serverabh√§ngigen Quellcode schreiben.
                    </small>
                    ü§¶üèª
                    <small>
                        Eine ausf√ºhrliche Anleitung dazu gibt es
                        <a href="https://simplapi.wordpress.com/2015/09/19/jersey-jax-rs-securitycontext-in-action/" target="_blank">hier</a>.
                    </small>
                </p>
                <p>
                    Davon ausgehend, dass wir die Benutzer einfach in einer Tabelle speichern wollen, ben√∂tigen wir eine Entity-Klasse,
                    die mindestens den Benutzernamen und das gehashte Passwort sowie die zugeordneten Benutzergruppen speichert. Zus√§tzlich
                    ben√∂tigen wir nat√ºrlich auch eine dazu passende EJB.
                </p>
                <source-code langauge="java">
                    @Entity
                    public class User {
                        @Id
                        @Column(name = "USERNAME", length = 64)
                        private String username;

                        @Column(name = "PASSWORD_HASH", length = 64)
                        private String passwordHash;

                        @ElementCollection
                        @CollectionTable(
                                name = "REST_USER_GROUP",
                                joinColumns = @JoinColumn(name = "USERNAME")
                        )
                        @Column(name = "GROUPNAME")
                        List<String> groups = new ArrayList&lt;&gt;();

                        ‚Ä¶
                    }

                    @Stateless
                    public class UserBean {
                        @PersistenceContext
                        EntityManager em;

                        public void signup(String username, String password, String... groups)
                                throws UserAlreadyExistsException {
                            ‚Ä¶
                        }
                    }
                </source-code>
                <p>
                    Damit sind schon alle Grundlagen gelegt. Jetzt m√ºssen wir nur noch festlegen, f√ºr welche Aufrufe der Benutzer sich
                    anmelden muss und welche Rollen (die wir sp√§ter auf Benutzergruppen abgebildet werden) er hierf√ºr ben√∂tigt. Dies
                    erfolgt in der Datei <tt>WEB-INF\web.xml</tt> anhand der Webservice-URLs und der HTTP-Verben:
                </p>
                <source-code language="xml">
                    &lt;web-app&gt;
                        &lt;security-constraint&gt;
                            &lt;web-resource-collection&gt;
                                &lt;web-resource-name&gt;Songs&lt;/web-resource-name&gt;
                                &lt;url-pattern&gt;/api/Songs/*&lt;/url-pattern&gt;

                                &lt;http-method&gt;PUT&lt;/http-method&gt;
                                &lt;http-method&gt;POST&lt;/http-method&gt;
                                &lt;http-method&gt;PATCH&lt;/http-method&gt;
                                &lt;http-method&gt;DELETE&lt;/http-method&gt;
                            &lt;/web-resource-collection&gt;

                            &lt;auth-constraint&gt;
                                &lt;role-name&gt;rest-beispiel-user&lt;/role-name&gt;
                            &lt;/auth-constraint&gt;
                        &lt;/security-constraint&gt;

                        &lt;security-role&gt;
                            &lt;role-name&gt;rest-beispiel-user&lt;/role-name&gt;
                        &lt;/security-role&gt;

                        &lt;login-config&gt;
                            &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
                            &lt;realm-name&gt;rest-beispiel&lt;/realm-name&gt;
                        &lt;/login-config&gt;
                    &lt;/web-app&gt;
                </source-code>
                <p>
                    Die Trennung zwischen Benutzergruppen und Rollen in Java ist etwas umst√§ndlich gel√∂st. Aus Sicht der Anwendung gibt
                    es eigentlich nur Benutzergruppen, die ein Benutzer haben kann. Der Server m√∂chte aber Rollen abpr√ºfen, die hierf√ºr
                    in einer serverspezifischen Konfiguration den Gruppen zugeordnet werden m√ºssen. F√ºr Glassfish erfolgt dies in der
                    Datei <tt>WEB-INF\glassfish-web.xml</tt>, die ungef√§hr so aussehen muss:
                </p>
                <source-code language="xml">
                    &lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;!DOCTYPE glassfish-web-app PUBLIC
                        "-//GlassFish.org//DTD GlassFish Application Server 3.1 Servlet 3.0//EN"
                        "http://glassfish.org/dtds/glassfish-web-app_3_0-1.dtd"&gt;

                    &lt;glassfish-web-app error-url=""&gt;
                        &lt;security-role-mapping&gt;
                            &lt;role-name&gt;rest-beispiel-user&lt;/role-name&gt;
                            &lt;group-name&gt;rest-beispiel-user&lt;/group-name&gt;
                        &lt;/security-role-mapping&gt;

                        &lt;parameter-encoding default-charset="UTF-8" /&gt;
                    &lt;/glassfish-web-app&gt;
                </source-code>
                <p>
                    Zum Schluss muss dann noch in der Glassfish-Adminkonsole das in der <tt>web.xml</tt> benannte ‚ÄûRealm‚Äù
                    angelegt werden, damit das Ganze funktioniert. Einen Screenshot hierzu findest du auf der Folie. üñºÔ∏è
                    Danach sollte es nicht mehr m√∂glich sein, √§ndernde Zugriffe auszuf√ºhren, ohne √ºber
                    <a href="https://de.wikipedia.org/wiki/HTTP-Authentifizierung#Basic_Authentication" target="_blank">HTTP Basic Authentication</a>
                    einen g√ºltigen Benutzer mitzugeben.
                </p>
            </aside>
        </section>

        <section>
            <h1>Exkurs: AJAX-Aufrufe mit JavaScript</h1>
            <article>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "rest-ablauf-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#rest-ablauf"
                                role          = "tab"
                                aria-controls = "rest-ablauf"
                                aria-expanded = "true"
                            >
                                Ablauf
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "rest-wsklasse-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#rest-wsklasse"
                                role          = "tab"
                                aria-controls = "rest-wsklasse"
                            >
                                Webservice-Klassen
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "rest-aufruf-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#rest-aufruf"
                                role          = "tab"
                                aria-controls = "rest-aufruf"
                                aria-expanded = "true"
                            >
                                Verwendung der Klassen
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "rest-ergebnis-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#rest-ergebnis"
                                role          = "tab"
                                aria-controls = "rest-ergebnis"
                            >
                                Ergebnis
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- Ablauf -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "rest-ablauf"
                            role            = "tabpanel"
                            aria-labelledby = "rest-ablauf-tab"
                        >
                            <img src="webanwendung-clientseitig.png" class="d-block" style="width: 100%; margin-bottom: 1em;" />
                            <ul>
                                <li>
                                    <b class="dhbw-lightblue">Das Beste beider Welten:</b> Browser und Server beinhalten je einen Teil der Anwendungslogik.
                                </li>
                                <li>
                                    Der initiale HTML-Code kann vom Server generiert werden oder in einer einfachen HTML-Datei liegen.
                                </li>
                                <li>
                                    Zu einem sp√§teren Zeitpunkt werden dann die REST-Webservices des Servers aufgerufen.
                                </li>
                                <li>
                                    Die empfangenen Daten werden dabei durch geschickte DOM-Manipulation sichtbar gemacht.
                                </li>
                            </ul>
                            <p style="color: darkred">
                                Jetzt schauen wir uns das endlich mal an.
                            </p>
                        </div>
                        <!-- Webservice-Klassen -->
                        <div
                            class           = "tab-pane fade"
                            id              = "rest-wsklasse"
                            role            = "tabpanel"
                            aria-labelledby = "rest-wsklasse-tab"
                        >
                            <p>
                                Um die Verwendung des Webservices so einfach wie m√∂glich zu machen, solltest du f√ºr jede Webservice-Klasse auf dem
                                Server eine √§hnliche Klasse mit den gleichen Methoden in JavaScript anlegen. Innerhalb der Methoden kannst du dann
                                <src-code language="javascript">fetch(‚Ä¶)</src-code> bzw. die
                                <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" target="_blank">Fetch API</a>
                                 zum Absetzen der HTTP-Aufrufe verwenden.
                            </p>
                            <source-code language="javascript">
                                "use strict";

                                /**
                                 * Von der Klasse SongCollection des Servers abgeleitete Klasse, die im Prinzip
                                 * dieselben Methoden besitzt. Hier rufen wir jedoch den REST-Webservice des
                                 * Servers auf, anstelle direkt auf eine Datenbank zuzugreifen.
                                 */
                                class SongCollection {

                                    /**
                                     * Konstruktor.
                                     */
                                    constructor(url) {
                                        this.url = url || "http://localhost:8080/REST_Server_Beispiel/api/Songs/";
                                        this.username = "";
                                        this.password = "";
                                    }

                                    /**
                                     * Benutzername und Passwort f√ºr die Authentifizierung merken.
                                     */
                                    setAuthData(username, password) {
                                        this.username = username;
                                        this.password = password;
                                    }

                                    /**
                                     * Songs suchen.
                                     */
                                    async findSongs(query) {
                                        let url = this.url;

                                        if (query !== undefined) {
                                            url += "?query=" + encodeURI(query);
                                        }

                                        let response = await fetch(url, {
                                            headers: {
                                                "accept": "application/json"
                                            }
                                        });

                                        if (response.ok) {
                                            return await response.json();
                                        } else {
                                            return {};
                                        }
                                    }

                                    /**
                                     * Neuen Song speichern.
                                     */
                                    async saveNewSong(song) {
                                        let response = await fetch(this.url, {
                                            method: "POST",
                                            headers: {
                                                "accept": "application/json",
                                                "content-type": "application/json",
                                                "authorization": "Basic " + btoa(this.username + ":" + this.password)
                                            },
                                            body: JSON.stringify(song)
                                        });

                                        if (response.ok) {
                                            return await response.json();
                                        } else {
                                            return {};
                                        }
                                    }

                                }

                                /**
                                 * Von der Klasse SongResource des Servers abgeleitete Klasse, die im Prinzip
                                 * dieselben Methoden besitzt. Hier rufen wir jedoch den REST-Webservice des
                                 * Servers auf, anstelle direkt auf eine Datenbank zuzugreifen.
                                 */
                                class SongResource {
                                    ‚Ä¶
                                }
                            </source-code>
                        </div>
                        <!-- Verwendung der Klassen -->
                        <div
                            class           = "tab-pane fade"
                            id              = "rest-aufruf"
                            role            = "tabpanel"
                            aria-labelledby = "rest-aufruf-tab"
                        >
                            <p>
                                Ab diesem Moment ist der Aufruf des Webservices ein wahres Kinderspiel. ‚öΩ Durch die neuen Webservice-Klassen
                                m√ºssen nur noch die richtigen Methoden im richtigen Moment aufgerufen werden.
                            </p>
                            <source-code language="javascript">
                                &lt;!DOCTYPE html&gt;
                                &lt;html&gt;
                                    &lt;head&gt;
                                        &lt;meta charset="utf-8"&gt;

                                        &lt;script src="SongCollection.js"&gt;&lt;/script&gt;
                                        &lt;script src="SongResource.js"&gt;&lt;/script&gt;
                                        ‚Ä¶
                                    &lt;/head&gt;
                                    &lt;body&gt;
                                        &lt;!-- Platzhalter f√ºr die vorhandenen Songs --&gt;
                                        &lt;div id="songs"&gt;&lt;/div&gt;

                                        &lt;!-- Ab hier f√§ngt es an, Spa√ü zu machen ü§© --&gt;
                                        &lt;script&gt;
                                            songCollection = new SongCollection();
                                            songResource = new SongResource();

                                            //songCollection.setAuthData("username", "password");
                                            //songResource.setAuthData("username", "password");

                                            // Abruf und Anzeige aller Songs, nach Laden der Seite
                                            async function reloadSongs() {
                                                let response = await songCollection.findSongs("");

                                                if (response.status === "OK") {
                                                    let songsElement = document.getElementById("songs");
                                                    songsElement.innerHTML = "";

                                                    response.songs.forEach(song =&gt; {
                                                        // Empfangene Daten anzeigen
                                                        let songElement = document.createElement("div");
                                                        songElement.classList.add("song");
                                                        songsElement.appendChild(songElement);

                                                        songElement.innerHTML = `&lt;b&gt;${song.name}&lt;/b&gt; &lt;br/&gt;`
                                                                + `&lt;span class="label"&gt;K√ºnstler:&lt;/span&gt; ${song.artist} &lt;br/&gt;`
                                                                + `&lt;span class="label"&gt;Songwriter:&lt;/span&gt; ${song.songwriters} &lt;br/&gt;`
                                                                + `&lt;span class="label"&gt;Jahr:&lt;/span&gt; ${song.releaseYear} &lt;br/&gt;`;
                                                    });
                                                } else {
                                                    alert(response.message);
                                                }
                                            }

                                            window.addEventListener("load", () =&gt; reloadSongs());
                                        &lt;/script&gt;
                                    &lt;/body&gt;
                                &lt;/html&gt;
                            </source-code>
                        </div>
                        <!-- Ergebnis -->
                        <div
                            class           = "tab-pane fade"
                            id              = "rest-ergebnis"
                            role            = "tabpanel"
                            aria-labelledby = "rest-ergebnis-tab"
                        >
                            <p>
                                Und so sieht die fertige Anwendung aus. In der Netzwerkanalyse sieht man sch√∂n, wie die angezeigten Daten
                                zeitversetzt nachgeladen werden.
                            </p>
                            <img src="ajax-ergebnis.jpg" alt="Screenshot der fertigen Webanwendung" class="d-block" style="width: 100%;" />
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    An dieser Stelle wird es dann mal Zeit f√ºr etwas Werbung. üì∫ Wir unterbrechen das laufende Programm und
                    kommen nochmal darauf zur√ºck, was bereits im <a href="../../2-javaee/ejb/#8" target="_blank">EJB-Kapitel</a>
                    vorgestellt wurde: <b>Clientseitige Webanwendungen mit Backendserver</b>. Denn REST-Webservices haben eine
                    tolle Eigenschaft, weshalb sie auch so beliebt sind: Man kann sie ganz einfach mit JavaScript aus dem
                    Browser heraus aufrufen, üëç was auch
                    <a href="https://de.wikipedia.org/wiki/Ajax_(Programmierung)" target="_blank">AJAX</a> genannt wird.
                </p>
                <p>
                    Im Grunde genommen gibt es hierf√ºr zwei M√∂glichkeiten:
                    <a href="https://www.w3schools.com/xml/xml_http.asp" target="_blank">XMLHttpRequest</a> und die
                    <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" target="_blank">Fetch API</a>.
                    Auf <a href="https://www.heise.de/-2642427" target="_blank">Heise Online</a> gibt es einen leicht
                    verst√§ndlichen Vergleich zwischen beiden. Wir nutzen an dieser Stelle aber die Fetch API, die sie
                    moderner ist und einen saubereren Programmierstil beg√ºnstigt. üõÄ
                </p>

                <h2>Wie es sp√§ter aussehen soll</h2>
                <p>
                    Bevor wir gleich loslegen wollen wir erst mal zeigen, wie das Endergebnis aussehen soll. Um den vorhin
                    gezeigten Musik-Webservice aufzurufen, wollen wir ungef√§hr folgenden Quellcode schreiben:
                </p>
                <source-code language="javascript">
                    let songCollection = new SongCollection();
                    songCollecion.setAuthData("username", "password");
                    let response = await songCollection.findSongs("Dire Straits");

                    if (response.status === "OK") {
                        response.songs.forEach(song => {
                            // Empfangene Daten anzeigen
                            ‚Ä¶
                        });
                    }
                </source-code>
                <p>
                    Bis auf das Schl√ºsselwort <code>await</code> sollte dir das nicht ungew√∂hnlich vorkommen, sondern einfach
                    nur den Methoden entsprechen, die der Webservice eben bietet. Dieselben Methoden wollen wir auch in JavaScript
                    haben, wof√ºr wir eine eigene Klasse schreiben m√ºssen.
                </p>

                <h2>Webservice-Klassen schreiben</h2>
                <p>
                    Auf dem Server besteht der Webservice ja aus mindestens zwei Klassen: <code>SongCollection</code> und
                    <code>SongResource</code>. Diese beiden Klassen m√ºssen wir mit √§nhlichen Methoden nachbauen, wobei wir
                    an den entscheidenen Stellen nat√ºrlich eine Anfrage an den Server senden, anstatt auf eine lokale Datenbank
                    zuzugreifen. Das Grundger√ºst der beiden Klassen ist daher folgendes, hier am Beispiel von <code>SongCollection</code>:
                </p>
                <source-code language="javascript">
                    class SongCollection {
                        // Konstruktor
                        constructor(url) {
                            this.url = url || "https://‚Ä¶";
                            this.username = "";
                            this.password = "";
                        }

                        // Benutzername und Passwort setzen
                        setAuthData(username, password) {
                            this.username = username;
                            this.password = password;
                        }

                        // Methoden des Webservices
                        async findSongs(query) { ‚Ä¶ }
                        async saveNewSong(song) { ‚Ä¶ }
                    }
                </source-code>
                <p>
                    Wobei die Implementierung der beiden Webservice-Methoden zum Beispiel so aussehen kann:
                </p>
                <source-code language="javascript">
                    /**
                     * Neuen Song speichern.
                     */
                    async saveNewSong(song) {
                        // Webservice aufrufen
                        let response = await fetch(this.url, {
                            method: "POST",
                            headers: {
                                "accept": "application/json",
                                "content-type": "application/json",
                                "authorization": "Basic " + btoa(this.username + ":" + this.password)
                            },
                            body: JSON.stringify(song)
                        });

                        // Ergebnis zur√ºckliefern
                        if (response.ok) {
                            return await response.json();
                        } else {
                            return {};
                        }
                    }
                </source-code>
                <p>
                    Mehr ist es schon gar nicht, auch wenn du dich erst wieder an JavaScript etwas gew√∂hnen musst. ü§ó
                    Das komplizierteste an der ganzen Geschichte ist nur, dass man sich den Code nicht irgendwie
                    automatisch generieren lassen kann, sondern jedes mal von Hand schreiben muss. Das ist ein wenig
                    l√§stig und zugegeben auch etwas m√ºhsam.
                </p>
                <p>
                    Das vollst√§ndige Beispiel findest du auf Moodle ‚û°Ô∏è.
                </p>
            </aside>
        </section>

        <section>
            <h1>REST-Webservices mit Java aufrufen</h1>
            <article>
                ‚Ä¶
            </article>
            <aside>
                <p>
                    Im Grunde genommen sieht der Aufruf eines REST-Webservices mit Java nicht viel anders aus wie mit JavaScript.
                    Nur, dass wir uns auch hier leider keinen vorgefertigten Quellcode generieren lassen k√∂nnen und alles von
                    Hand schreiben m√ºssen. Und da Java eben ein strengeres Typsystem als JavaScript hat f√§llt der Code etwas
                    umfangreicher aus, weil jedes Objekt wirklich ausdefiniert werden muss. üèóÔ∏è
                </p>
                <p>
                    Sucht man im Internet nach REST-Aufrufen mit Java, kommen dabei lauter Beispiele zur offiziellen JAX-RS-API
                    zu Tage. Diese haben aber leider ein paar Nachteile, weshalb wir sie hier <b>nicht</b> verwenden werden:
                </p>
                <ul>
                    <li>
                        Die API geh√∂rt nicht zu Java SE, so dass eine gro√üe Anzahl externer Pakete in das Projekt eingebunden
                        werden muss, wenn man eine ganz normale Clientanwendung schreiben will.
                    </li>
                    <li>
                        Die Authentifizierung am Server ist mal wieder nicht Bestandteil des Standards, so dass man auch hier
                        Code schreiben muss, der nur mit einer speziellen Implementierung von JAX-RS funktioniert. Es gibt aber
                        mehrere als nur eine Implementierung, die man dadurch nicht so einfach austauschen kann.
                    </li>
                    <li>
                        Und auch in allen anderen Punkten ist die API umst√§ndlicher, als sie es eigentlich sein m√ºsste.
                        Selbst f√ºr eine einfache GET-Anfrage ohne Parameter muss man relativ viel Code schreiben.
                    </li>
                </ul>
                <p>
                    Wir tun uns das daher gar nicht erst an und verwenden stattdessen viel lieber eine Kombination von
                    <a href="https://github.com/google/gson" target="_blank">Google Gson</a> und
                    <a href="http://unirest.io/java.html" target="_blank">Unirest for Java</a>, die dasselbe nur viel einfacher macht. ü¶ã
                </p>

                <h2>Datentransferklassen</h2>
                <p>
                    Diesen Schritt haben wir mit JavaScript nicht ben√∂tigt. In Java m√ºssen wir jedoch f√ºr jede Entity, die uns
                    der Webservice liefert oder die wir ihm schicken, eine √§hnlich gebaute Klasse anlegen. Allerdings k√∂nnen
                    wir es uns hier besonders einfach machen und alle Attribute als <code>public</code> definieren und dadurch
                    auf Konsturkuren, Setter und Getter und all den Kram verzichten:
                </p>
                <source-code language="java">
                    public class Song {
                        public final long id = 0L;
                        public String name = "";
                        public String artist = "";
                        public String songwriters = "";
                        public int releaseYear = 0;
                    }
                </source-code>

                <h2>Webservice-Klassen</h2>
                <p>
                    Der nun folgende Schritt ist eigentlich optional, erh√∂ht aber die √úbersicht ungemein. Anstatt einfach
                    an beliebigen Stellen unseres Programms HTTP-Anfragen an den Server zu schicken, kapseln wir sie alle
                    in einer eigenen Klasse. Von der Struktur k√∂nnen wir uns dabei 1:1 am Server orientieren, so dass wir
                    im Client auch eine <code>SongCollection</code> und eine <code>SongResource</code>-Klasse definieren:
                </p>
                <source-code language="java">
                    public class SongCollection { ‚Ä¶ }
                    public class SongResource { ‚Ä¶ }
                </source-code>
                <p>
                    Das Ziel ist es dabei, die clientseitigen Methoden genau gleich wie auf dem Server zu nennen. Zus√§tzlich brauchen
                    wir noch ein paar Helferlein, um die URL austauschbar zu machen oder die Anmeldedaten mit Benutzername und Passwort
                    zu √ºbergeben, damit ein fertiger Webservice-Aufruf sp√§ter so aussehen kann:
                </p>
                <source-code language="java">
                    SongCollection songCollection = new SongCollection();
                    songCollecion.setAuthData("username", "password");
                    SongCollection.Response response = songCollection.findSongs("Dire Straits");

                    if (response.code.equals("OK")) {
                        for (Song song : response.songs) {
                            // Empfangene Daten anzeigen
                            ‚Ä¶
                        }
                    }
                </source-code>
                <p>
                    Hierf√ºr ben√∂tigen wir folgendes Grundger√ºst f√ºr <code>SongCollection</code>. Die Klasse <code>SongResource</code>
                    ist nat√ºrlich √§hnlich aufgebaut.
                </p>
                <source-code language="java">
                    public class SongCollection {
                        public static final URL = "https://‚Ä¶";

                        public String url = URL;
                        public String username = "";
                        public String password = "";

                        // Konstruktoren
                        public SongCollection() {
                        }

                        public SongCollection(String url) {
                            this.url = url;
                        }

                        // Benutzername und Passwort setzen
                        public setAuthData(String username, String password) {
                            this.username = username;
                            this.password = password;
                        }

                        // Methoden des Webservices
                        public Response findSongs(String query) { ‚Ä¶ }
                        public Response saveNewSong(Song song) { ‚Ä¶ };

                        // Hilfsklasse f√ºr die Antwortdaten des Webservices
                        public class Response {
                            public Song song;
                            public List<Song> songs;
                            public String status;
                            public String exception;
                            public String message;
                        }
                    }
                </source-code>
                <p>
                    Das ist leider etwas viel Tipparbeit. Aber wie gesagt erhalten wir dadurch eine gute Struktur, die hinterher leicht zu benutzen ist.
                    Fehlt dann nur noch die Implementierung der vom Webservice vorgegebenen Methoden. In diesen nehmen wir dann die eigentlichen HTTP-Aufrufe vor,
                    so wie hier am Beispiel von <code>saveNewSong()</code> gezeigt:
                </p>
                <source-code language="java">
                    public Response saveNewSong(Song song) throws UnirestException {
                        HttpResponse<String> httpResponse = Unirest.post(this.url)
                                .header("accept", "application/json")
                                .header("content-type", "application/json")
                                .basicAuth(this.username, this.password)
                                .body(this.gson.toJson(song))
                                .asString();

                        return this.gson.fromJson(httpResponse.getBody(), Response.class);
                    }
                </source-code>
                <p>
                    Das ist auch der Code, der mit reinem JAX-RS so umst√§ndlich ist. üëπ Mit Unirest und Gson ist er aber ganz easy, sogar so sehr,
                    dass man ihn direkt irgendwo ein sein Programm einbauen k√∂nnte, wenn man sich den Stress mit dem Schreiben einer ganzen Klasse
                    nicht machen wollte. Das sollte man dann aber nur in kleinen Testprogr√§mmchen so machen. ü§´
                </p>
            </aside>
        </section>
        <section data-background-color="rgb(231, 221, 141)">
            <h1>Aufgabe 3: REST in Peace</h1>
            <article>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "aufgabe3-aufgabe-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#aufgabe3-aufgabe"
                                role          = "tab"
                                aria-controls = "aufgabe3-aufgabe"
                                aria-expanded = "true"
                            >
                                Aufgabe
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "aufgabe3-loesung-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#aufgabe3-loesung"
                                role          = "tab"
                                aria-controls = "aufgabe3-loesung"
                            >
                                L√∂sung
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- Aufgabe -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "aufgabe3-aufgabe"
                            role            = "tabpanel"
                            aria-labelledby = "aufgabe3-aufgabe-tab"
                        >
                            <p>
                                ‚Ä¶
                            </p>
                            <img src="aufgabe3.png" alt="Screenshot des Webservices in SoapUI" class="d-block" style="width: 100%;" />
                        </div>
                        <!-- L√∂sung -->
                        <div
                            class           = "tab-pane fade"
                            id              = "aufgabe3-loesung"
                            role            = "tabpanel"
                            aria-labelledby = "aufgabe3-loesung-tab"
                        >
                            <h2>‚Ä¶</h2>
                            <source-code language="java">
                                ‚Ä¶
                            </source-code>
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    Yeah, REST rockt! Um das Erfolgserlebnis noch zu steigern kannst du hier einen eigenen
                    kleinen REST-Webservice programmieren und mit Netbeans zum Laufen bringen. üï∫ Du wirst
                    sehen, es ist nicht wirklich schwerer als mit SOAP.
                </p>
                <img src="../../github_atom.png" class="img-fluid d-block"/>
                <p>
                    <small>
                        Bildnachweis:
                        <a href="https://atom.io/" target="_blank">Atom Webseite</a>
                    </small>
                </p>
            </aside>
        </section>

        <section data-background-color="rgb(231, 221, 141)">
            <h1>Aufgabe 4: Ein kleines JAX-RS-Quiz</h1>
            <article>
                <h2>Aufgabe 4.1: ‚Ä¶</h2>

                <p>
                    a) ‚Ä¶
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        ‚Ä¶
                    </li>
                </ol>

                <h2>Aufgabe 4.2: ‚Ä¶</h2>

                <p>
                    a) ‚Ä¶
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        ‚Ä¶
                    </li>
                </ol>

                <hr />

                <p style="width: 100%; transform: scaleY(-1) scaleX(-1); display: inline-block;">
                    <small>
                        <b>L√∂sung:</b> Aufgabe 4.1: ‚Ä¶<br />
                        Aufgabe 4.2: ‚Ä¶
                    </small>
                </p>
            </article>
            <aside>
                <p>
                    Und damit sind wir auch schon am Ende unseres kleinen Kapitels angelangt.
                    Wir hoffen, es hat dir gefallen und du kannst alle Fragen auf dieser Seite
                    richtig beantworten. üçæ
                </p>
            </aside>
        </section>

        <!--
            ====================
            HINWEISE ZUM SCHLUSS
            ====================
        -->
        <section data-chapter data-background-image="../../trennfolie.jpg">
            <h1>Hinweise zum Schluss</h1>
            <article>
                <small>
                    <small>
                        Bildnachweis:
                        <a href="https://pixabay.com/en/adult-break-business-caucasian-2398561/" target="_blank">Pixabay: rawpixel</a>
                    </small>
                </small>
            </article>
        </section>

        <section data-background-color="rgb(153, 190, 137)">
            <h1>Do &amp; Don't</h1>
            <article>
                <h4>Darauf solltest du achten</h4>
                <ul>
                    <li>
                        ‚Ä¶
                    </li>
                </ul>
            </article>
            <aside>
                <p>
                    Dies sind sie: Die goldenen Regeln der Kunst. ü•á Auf dieser Folie haben wir ein paar allgemeine
                    Tipps zusammengestellt, worauf du bei der Entwicklung von REST-Webservices achten solltest.
                </p>
                <img src="../../do-dont.svg" class="d-block" style="width: 20em; max-width: 100%; margin-bottom: 0.5em;" />
                <p>
                    <small>
                        Bildnachweis:
                        <a href="https://pixabay.com/en/dialog-tip-advice-hint-speaking-148815/" target="_blank" style="color: rgb(25, 68, 49);">Pixabay: OpenClipart-Vectors</a>
                    </small>
                </p>
            </aside>
        </section>

        <section data-background-color="rgb(158, 203, 231)">
            <h1>Rechtshinweise</h1>
            <article>
                <h4>Creative Commons Namensnennung 4.0 International</h4>
                <ul>
                    <li>Beliebiges Teilen ist erlaubt</li>
                    <li>Die Unterlagen d√ºrfen bearbeitet und ver√§ndert werden</li>
                    <li>Wenn die Namens- und Urheberangaben erhalten bleiben</li>
                    <li>Und keine weiteren Einschr√§nkungen auferlegt werden</li>
                </ul>
                <span style="font-size: 400px; color: white;" class="dhbw-text-shadow" >¬ß</span>
            </article>
            <aside style="font-size: 80%">
                <h4>Kontaktdaten</h4>
                <p>
                    Dennis Schulmeister-Zimolong<br/>
                    E-Mail: <a data-email-address>dhbw windows3.de</a><br/>
                </p>

                <h4>Urheberrecht und Lizenzvereinbarung</h4>
                <p>
                    ¬© 2018 Dennis Schulmeister-Zimolong <br/>
                    <a href="https://github.com/DennisSchulmeister/dhbwka-wwi-vertsys-folien" target="_blank">https://github.com/DennisSchulmeister/dhbwka-wwi-vertsys-folien</a>
                </p>
                <img src="https://i.creativecommons.org/l/by/4.0/88x31.png" alt="Creative Commons Lizenzvertrag" />
                <p>
                    Das Werk <i>Vorlesung "Verteilte Systeme" im Studiengang Wirtschaftsinformatik
                    an der DHBW Karlsruhe</i> von <a href="http://www.windows3.de" target="_blank">Dennis Schulmeister-Zimolong</a>
                    ist lizenziert unter <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank"><i>Creative Commons
                    Namensnennung 4.0 International</i></a>.
                </p>
                <p>
                    Du darfst:
                </p>
                <ul>
                    <li>
                        <b>Teilen</b> ‚Äî das Material in jedwedem Format oder Medium vervielf√§ltigen
                        und weiterverbreiten
                    </li>
                    <li>
                        <b>Bearbeiten</b> ‚Äî das Material remixen, ver√§ndern und darauf aufbauen
                        und zwar f√ºr beliebige Zwecke, sogar kommerziell.
                    </li>
                </ul>
                <p>
                    Unter folgenden Bedingungen:
                </p>
                <ul>
                    <li>
                        <b>Namensnennung</b> ‚Äî Du musst angemessene Urheber- und Rechteangaben
                        machen, einen Link zur Lizenz beif√ºgen und angeben, ob √Ñnderungen
                        vorgenommen wurden. Diese Angaben d√ºrfen in jeder angemessenen Art
                        und Weise gemacht werden, allerdings nicht so, dass der Eindruck
                        entsteht, der Lizenzgeber unterst√ºtze gerade dich oder deine Nutzung
                        besonders.
                    </li>
                    <li>
                        <b>Keine weiteren Einschr√§nkungen</b> ‚Äî Du darfst keine zus√§tzlichen Klauseln
                        oder technische Verfahren einsetzen, die anderen rechtlich irgendetwas
                        untersagen, was die Lizenz erlaubt.
                    </li>
                </ul>
                <p>
                    Es werden keine Garantien gegeben und auch keine Gew√§hr geleistet.
                    Die Lizenz verschafft dir m√∂glicherweise nicht alle Erlaubnisse,
                    die du f√ºr die jeweilige Nutzung brauchst. Es k√∂nnen beispielsweise
                    andere Rechte wie Pers√∂nlichkeits- und Datenschutzrechte zu beachten
                    sein, die deine Nutzung des Materials entsprechend beschr√§nken.
                </p>
            </aside>
        </section>
    </body>
</html>
