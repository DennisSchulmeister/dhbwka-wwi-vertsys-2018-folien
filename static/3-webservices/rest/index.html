<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>REST-Webservices</title>

        <link rel="shortcut icon" href="../../favicon.svg" />
        <link rel="stylesheet" href="../../style.css" />
        <script src="../../learning-slides.bundle.js"></script>
    </head>
    <body class="slides invisible" data-title="REST-Webservices" tabindex="0">
        <header>
            <h2>Inhaltsverzeichnis</h2>
            <p>
                Moderne Webservices werden immer mehr als REST-Webservices entworfen und es scheint
                fast so, als w√§re SOAP vielerorts gar kein Thema mehr. An dieser Stelle nehmen wir
                den Herausforderer daher gr√ºndlich unter die Lupe. üîç
            </p>
        </header>

        <!--
            ========================
            LERNZIELE DIESER EINHEIT
            ========================
        -->
        <section data-chapter data-background-color="rgb(210,190,210)">
            <h1>Lernziele dieser Einheit</h1>
            <article>
                <h3>Nach Abschluss dieser Einheit kannst du ‚Ä¶</h3>
                <ul>
                    <li>
                        Die Unterschiede zwischen SOAP und REST sowie die
                        <span class="dhbw-lightblue font-weight-bold">spezifischen Eigenheiten von REST</span> erkl√§ren.
                    </li>
                    <li>
                        <span class="dhbw-lightblue font-weight-bold">Typische Anwendungsf√§lle</span> von REST erkennen und von SOAP abgrenzen.
                    </li>
                    <li>
                        Erkl√§ren, was eine <span class="dhbw-lightblue font-weight-bold">WADL-Beschreibung</span> ist und welche Vorteile sie bietet.
                    </li>
                    <li>
                        WADL-Dateien in <span class="dhbw-lightblue font-weight-bold">SoapUI</span> importieren und fremde Webservices damit testen.
                    </li>
                    <li>
                        Eigene REST-Webservices mit den <span class="dhbw-lightblue font-weight-bold">JAX-RS-Annotationen</span> von Java implementieren.
                    </li>
                    <li>
                        Das <span class="dhbw-lightblue font-weight-bold">AJAX-Prinzip</span> anwenden, um REST-Webservices aus clientseitigem JavaScript heraus aufzurufen.
                    </li>
                    <li>
                        Entfernte REST-Webservices mit JAX-RS <span class="dhbw-lightblue font-weight-bold">aus Java heraus aufrufen</span>.
                    </li>
                    <li>
                        Netbeans zur Generierung der hierf√ºr ben√∂tigten Webservice-Stubs verwenden.
                    </li>
                </ul>
                <span style="font-size: 240px; color: white;" class="dhbw-text-shadow" >üèÅ</span>
            </article>
            <aside>
                <p>
                    <a href="https://www.youtube.com/watch?v=suUUaRQQC08" target="_blank">REST In Peace!</a> üèúÔ∏è
                </p>
                <p>
                    So k√∂nnte das etwas zynische Motto des heutigen Kapitels lauten. Denn w√§hrend im Unternehmenskontext
                    SOAP immer noch eine gewisse Vormachtstellung hat, hat sich andernorts eine leichtgewichtigere Alternative
                    namens REST etabliert, die viel mehr auf den Gegebenheiten des HTTP-Protokolls aufbaut, sehr h√§ufig XML durch
                    JSON ersetzt und somit insgesamt einfach besser zum World Wide Web und seinen angrenzenden Technologien passt.
                    SOAP ist dadurch zwar nicht obsolet, an verschiedenen Stellen wurde es aber dennoch nahezu vollst√§ndig durch
                    REST verdr√§ngt. Grund genug also, dass wir uns diesen Shooting Star üå† etwas genauer anschauen und auch hier
                    versuchen zu verstehen, <b>was REST ist</b>, wie es funktioniert und wo die <b>Unterschiede zu SOAP</b> liegen.
                </p>
                <p>
                    In diesem Zusammenhang werden wir dann auch sehen, dass REST-Webservices insgesamt viel leichtf√º√üiger
                    als SOAP aufgestellt sind, indem sie nicht nur das komplizierte XML-Format sondern mit ihm auch
                    die WSDL-Beschreibungen und damit einen gro√üen Teil der darauf aufbauenden Werkzeuge und hoch-komplexer
                    WS-*-Standards √ºber Board werfen. üö¢ Daf√ºr muss man allerdings etwas mehr Aufwand treiben, um einen
                    <b>REST-Webservice als Client</b> aufzurufen, da man dann alles selbst programmieren muss. Als Alternative
                    gibt es zumindest f√ºr Java zwar die so genannten <b>WADL-Beschreibungen</b>, diese bieten letztlich
                    aber nicht denselben Komfort.
                </p>
                <p>
                    Im zweiten Teil werden wir dann in gewohnter Weise auf die <b>Programmierung</b> eingehen
                    und dabei zeigen, wie mit einfachen Mitteln ein eigener REST-Webservice in Java implementiert werden
                    kann. Dabei werden wir auch nochmal auf die Bedeutung von REST f√ºr die <b>Entwicklung clientseitiger
                    Webanwendungen</b> eingehen und das <b>AJAX-Prinzip</b> von letztem Semester nochmal aufgreifen, um
                    die REST-Funktionen unseres Servers aufzurufen. Da aber REST nicht nur f√ºr Webanwendungen sondern
                    h√§ufig auch f√ºr mobile Apps genutzt wird, zeigen wir anschlie√üend auch, wie ein <b>Aufruf aus Java</b>
                    heraus gelingen kann.
                </p>
                <p>
                    Dies ist unser Arbeitsvorrat f√ºr heute, bevor wir den Themenkomplex Jakarta&nbsp;EE dann
                    endg√ºltig abschlie√üen k√∂nnen.
                </p>
            </aside>
        </section>

        <!--
            =============
            SOAP VS. REST
            =============
        -->
        <section data-chapter data-background-image="../../trennfolie.jpg">
            <h1>SOAP vs. REST</h1>
            <article>
                <small>
                    <small>
                        Bildnachweis:
                        <a href="https://pixabay.com/en/adult-break-business-caucasian-2398561/" target="_blank">Pixabay: rawpixel</a>
                    </small>
                </small>
            </article>
        </section>

        <section>
            <h1>Warum REST so anders ist</h1>
            <article>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "soap_vs_rest-vergleich-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#soap_vs_rest-vergleich"
                                role          = "tab"
                                aria-controls = "soap_vs_rest-vergleich"
                                aria-expanded = "true"
                            >
                                Direkter Vergleich
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "soap_vs_rest-datenvolumen-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#soap_vs_rest-datenvolumen"
                                role          = "tab"
                                aria-controls = "soap_vs_rest-datenvolumen"
                            >
                                Umfang der Daten
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- Direkter Vergleich -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "soap_vs_rest-vergleich"
                            role            = "tabpanel"
                            aria-labelledby = "soap_vs_rest-vergleich-tab"
                        >
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-md">
                                        <h2>SOAP</h2>
                                        <img src="soap-rest-01.jpg" alt="" class="d-block img-thumbnail" style="width: 100%; margin-bottom: 1em;" />
                                        <table style="margin-bottom: 1em;">
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêò
                                                </td>
                                                <td>
                                                    Eine URL f√ºr den gesamten Webservice
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêò
                                                </td>
                                                <td>
                                                    Erm√∂glicht den Aufruf beliebiger Methoden
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêò
                                                </td>
                                                <td>
                                                    Nutzt von HTTP lediglich das Verb POST
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêò
                                                </td>
                                                <td>
                                                    SOAP-XML als fest vorgegebenes Datenformat
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêò
                                                </td>
                                                <td>
                                                    Verbindliche WSDL-Beschreibung je Service
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêò
                                                </td>
                                                <td>
                                                    H√§ufigste Verwendung im Unternehmenskontext
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="col-md">
                                        <h2>REST</h2>
                                        <img src="soap-rest-02.jpg" alt="" class="d-block img-thumbnail" style="width: 100%; margin-bottom: 1em;" />
                                        <table style="margin-bottom: 1em;">
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêá
                                                </td>
                                                <td>
                                                    Je eine URL f√ºr eine Ressource¬π
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêá
                                                </td>
                                                <td>
                                                    Bildet die √ºblichen CRUD-Operationen¬≤ ab
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêá
                                                </td>
                                                <td>
                                                    Nutzt alle Verben des HTTP-Protokolls
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêá
                                                </td>
                                                <td>
                                                    Beliebige Datenformate, in der Regel JSON
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêá
                                                </td>
                                                <td>
                                                    Optionale WADL-Beschreibung m√∂glich
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right: 0.5em;">
                                                    üêá
                                                </td>
                                                <td>
                                                    H√§ufigste Verwendung f√ºr Cloud, Web und Mobile
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <p>
                                            <small>
                                                ¬π Im Sinne eines einzelnen Datensatzes, zum Beispiel ein Artikel oder eine Bestellung.
                                            </small>
                                        </p>
                                        <p>
                                            <small>
                                                ¬≤ Create, Read, Update und Delete
                                            </small>
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <small>
                                            <small>
                                                Bildnachweise:
                                                <a href="https://pixabay.com/de/safari-elefant-s%C3%A4ugetier-tierwelt-3035333/" target="_blank">Pixabay: ronbd</a>,
                                                <a href="https://pixabay.com/de/hase-wiese-kaninchen-gras-839297/" target="_blank">Pixabay: Bru-nO</a>,
                                            </small>
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Umfang der Daten -->
                        <div
                            class           = "tab-pane fade"
                            id              = "soap_vs_rest-datenvolumen"
                            role            = "tabpanel"
                            aria-labelledby = "soap_vs_rest-datenvolumen-tab"
                        >
                            <img src="soap-rest-03.png" alt="SOAP is so much more polite than REST" class="d-block" style="width: 30em; max-width: 100%; margin: 0 auto;" />
                            <p>
                                <small>
                                    <small>
                                        Bildnachweis:
                                        <a href="http://geek-and-poke.com/geekandpoke/2009/11/30/service-calling-made-easy-part-1.html" target="_blank">Geek &amp; Poke: 30.11.2009</a>
                                    </small>
                                </small>
                            </p>
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <div class="embed-responsive embed-responsive-16by9" style="margin-bottom: 1em">
                    <iframe src="https://www.youtube-nocookie.com/embed/Nzf-TbvswDU" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
                <p>
                    Um zu verstehen, wie sich SOAP und REST unterscheiden und warum beide so definiert sind, wie sie sind,
                    muss man sich die Hintergr√ºnde und die Entstehung beider Ans√§tze anschauen.
                </p>
                <p>
                    Da w√§re also zum einen SOAP, dessen
                    Vorl√§ufer <a href="https://de.wikipedia.org/wiki/XML-RPC" target="_blank">XML-RPC</a> ab 1998 bei Microsoft entstand
                    und der sich, wie der Name schon andeutet, direkt am Aufruf entfernter Methoden √ºber das Internet orientiert.¬π
                    Dabei lag der Fokus schon immer auf der Entwicklung betriebswirtschaftlicher Anwendungen, was sich auch an der
                    Beteiligung von IBM und anderen Firmen aus diesem Bereich zeigt. Der kurioseste Anwendungsfall ist dabei sicher
                    <a href="https://de.wikipedia.org/wiki/Universal_Plug_and_Play" target="_blank">Universal Plug and Play</a>, das
                    auch heute noch zur automatischen Entdeckung und Wiedergabe von Medieninhalten auf verteilten Ger√§ten innerhalb
                    des heimischen LAN genutzt wird. Davon abgesehen zielt SOAP jedoch voll und ganz auf Unternehmensanwendungen ab,
                    die ja nur sehr selten f√ºr die Nutzung hipper und aktueller Technologien bekannt sind, daf√ºr aber sehr h√§ufig
                    folgende Anforderungen haben:
                </p>
                <ul>
                    <li>
                        Interoperabilit√§t mit m√∂glichst vielen Programmiersprachen
                    </li>
                    <li>
                        Einfache Programmierung ohne viel ‚ÄûBoilerplate-Code‚Äù
                    </li>
                    <li>
                        Nutzung von zuverl√§ssigen und praxiserprobten Technologien
                    </li>
                    <li>
                        Sichere Daten√ºbertragung durch Signierung und Verschl√ºsselung
                    </li>
                    <li>
                        Gute Werkzeug-Unterst√ºtzung beim Programmieren und Testen
                    </li>
                </ul>
                <p>
                    Aus diesem Grund ist die Wahl von HTTP-POST zur Daten√ºbertragung und XML als Datenformat auch nur pragmatisch,
                    da jedes Unternehmen durch die weite Verbreitung des World Wide Web ohnehin schon auf den Abruf von Daten via
                    HTTP vorbereitet ist und es f√ºr XML seit jeher ein exzellentes Tooling gibt. Ebenso l√§sst sich dadurch erkl√§ren,
                    wie rund um SOAP eine ganze Menge <a href="https://de.wikipedia.org/wiki/WS-*" target="_blank">WS-*</a> genannter
                    Standards entstehen konnten, die so h√∂chst unterschiedliche Themen wie die XML-Signierung, die √úbertragung von
                    Bin√§rdaten oder die Modellierung von Gesch√§ftsprozessen abdecken.
                </p>
                <p>
                    <small>
                        ¬π RPC = Remote Procedure Call, also der Aufruf entfernter Prozeduren, wobei man in Java (da es sich ja um
                        eine objektorientierte Sprache handelt) von Methoden sprechen w√ºrde.
                    </small>
                </p>
                <p>
                    Diesem wahren Schwergewicht üèãÔ∏è steht nun <a href="https://de.wikipedia.org/wiki/Representational_State_Transfer" target="_blank">REST</a>
                    als leichtgewichtige Alternative und konzeptioneller Gegenentwurf entgegen. Im Jahr 2000 in der Dissertation
                    von Roy Fielding beschrieben, orientiert sich REST voll und ganz am HTTP-Protokoll und nutzt es als M√∂glichkeit,
                    beliebige Ressourcen¬≤ √ºber eindeutige URLs zu adressieren und mit den verschiedenen HTTP-Verben entsprechend
                    ihrer Bedeutung darauf zuzugreifen:
                </p>
                <ul>
                    <li>
                        <b>GET:</b> Daten einer Ressource abrufen
                    </li>
                    <li>
                        <b>POST:</b> Anlage einer neuen Ressource¬≥
                    </li>
                    <li>
                        <b>PUT:</b> Neue Version einer vorhandenen Ressource speichern¬≥
                    </li>
                    <li>
                        <b>PATCH:</b> Einzelne Felder einer Ressource √ºberschreiben
                    </li>
                    <li>
                        <b>DELETE:</b> L√∂schen einer Ressource
                    </li>
                </ul>
                <p>
                    <small>
                        ¬≤ In einer Datenbankanwendung w√ºrde man einzelne Datens√§tze, wie einen Kunden oder einen Zahlungsbeleg,
                        als Ressource abbilden. Davon abgesehen kann es sich aber um beliebige ‚ÄûDinge‚Äù handeln, die man √ºber
                        den Webservice verwalten will. Ein E-Mailprovider k√∂nnte daher zum Beispiel die Mail Accounts seiner
                        Kunden sowie einzelne E-Mails als Ressourcen mit eigenen URLs ansprechbar machen.
                    </small>
                </p>
                <p>
                    <small>
                        ¬≥ Tats√§chlich ist die Abgrenzung zwischen POST und PUT nicht immer strikt gew√§hlt. Es gibt auch viele
                        Webservices, die POST zur Neuanlage und PUT zur √Ñnderung von Daten oder nur ein Verb f√ºr beides nutzen.
                    </small>
                </p>
                <p>
                    <small>
                        Auch ist die hier getroffene Unterscheidung formal nicht ganz korrekt. Die absolut korrekte Version ist,
                        dass POST immer dann verwenet wird, wenn der Client die sp√§tere URL der Ressource nicht genau kennt und PUT,
                        eben wenn er sie kennt. Haben wir zum Beispiel die URL <code>/Songs/</code> f√ºr eine Liste mit Songs und
                        <code>/Songs/42/</code> f√ºr den einzelnen Song mit der ID 42, kann man eine POST-Anfrage an <code>/Songs/</code>
                        senden, um einen neuen Eintrag unter eine beliebigen ID abzulegen oder eine PUT-Anfrage an <code>/Songs/42/</code>,
                        um den Song mit der ID 42 anzulegen oder zu √ºberschreiben.
                    </small>
                </p>
                <p>
                    Das Format der √ºbertragenen Daten ist dabei nicht verbindlich definiert, allermeistens wird jedoch JSON
                    verwendet, da es platzsparender als XML ist und mit JavaScript besonders einfach verarbeitet werden kann.
                    Auch gibt es nicht zwingend eine formale XML-Beschreibung, die alle Operationen eines Webservices sowie
                    die syntaktische Struktur der √ºbertragenen Daten definiert. Hierf√ºr gibt es zwar WADL (Web Application
                    Description Language) und andere Formate als Quasi-Ersatz, sie haben aber alle keine weite Verbreitung.
                </p>
            </aside>
        </section>

        <section>
            <h1>Technische Hintergr√ºnde zu REST</h1>
            <article>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "technik-get_liste-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#technik-get_liste"
                                role          = "tab"
                                aria-controls = "technik-get_liste"
                                aria-expanded = "true"
                            >
                                Liste abrufen
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "technik-get_ressource-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#technik-get_ressource"
                                role          = "tab"
                                aria-controls = "technik-get_ressource"
                            >
                                Ressource abrufen
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "technik-post-tab"
                                class         = "nav-link"xZ9BZ7a30qU
                                data-toggle   = "tab"
                                href          = "#technik-post"
                                role          = "tab"
                                aria-controls = "technik-post"
                                aria-expanded = "true"
                            >
                                Ressource anlegen
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "technik-wadl-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#technik-wadl"
                                role          = "tab"
                                aria-controls = "technik-wadl"
                            >
                                WADL-Beschreibung
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- Liste abrufen -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "technik-get_liste"
                            role            = "tabpanel"
                            aria-labelledby = "technik-get_liste-tab"
                        >
                            <p>
                                Bei den URLs f√ºr einen REST-Webservice wird h√§ufig zwischen <b>Collections</b> und <b>Ressourcen</b>
                                unterschieden. Eine Collection ist dabei immer eine Sammlung von Eintr√§gen, die als Ganzes
                                abgerufen werden kann. Oftmals k√∂nnen beim Abruf dann noch <b>Query Parameter</b> mitgegeben
                                werden, um die Liste einzugrenzen.
                            </p>
                            <img src="http-get-liste.svg" alt="" class="d-block" style="width: 100%;" />
                        </div>
                        <!-- Ressource abrufen -->
                        <div
                            class           = "tab-pane fade"
                            id              = "technik-get_ressource"
                            role            = "tabpanel"
                            aria-labelledby = "technik-get_ressource-tab"
                        >
                            <p>
                                Eine einzelne Ressource erkennt man daran, dass in der URL ihr Schl√ºsselwert enthalten ist.
                                Im Gegensatz zu den Collections schickt der Server dann genau ein Objekt mit den Daten der
                                angeforderten Ressource.
                            </p>
                            <img src="http-get-ressource.svg" alt="" class="d-block" style="width: 100%;" />
                        </div>
                        <!-- Ressource anlegen -->
                        <div
                            class           = "tab-pane fade show"
                            id              = "technik-post"
                            role            = "tabpanel"
                            aria-labelledby = "technik-post-tab"
                        >
                            <p>
                                Die Anlage von Ressourcen erfolgt h√§ufig, indem ihre JSON-Repr√§sentation als <b>POST-Anfrage
                                an die Collection</b> geschickt wird. Der Server speichert daraufhin den Eintrag und schickt
                                die gespeicherten Daten, nun um die Key-Werte angereichert, zur√ºck.
                            </p>
                            <img src="http-post.svg" alt="" class="d-block" style="width: 100%;" />
                        </div>
                        <!-- WADL-Beschreibung -->
                        <div
                            class           = "tab-pane fade"
                            id              = "technik-wadl"
                            role            = "tabpanel"
                            aria-labelledby = "technik-wadl-tab"
                        >
                            <p>
                                Im Gegensatz zu SOAP besitzen REST-Webservices meistens keine formale Beschreibung.
                                Viele REST-API-Anbieter liefern daher vorgefertigte SDKs zum Aufruf ihrer Services
                                mit verschiedenen Sprachen. Im Javaumfeld hat man sich stattdessen das
                                <a href="https://en.wikipedia.org/wiki/Web_Application_Description_Language" target="_blank">WADL-Format</a>
                                als eine Art ‚ÄûWSDL f√ºr beliebige Webanwendungen‚Äù √ºberlegt. Es beschreibt die URLs
                                eines Webservices und mit welchen HTTP-Methoden sie aufgerufen werden.
                            </p>
                            <table style="margin-bottom: 1em;">
                                <tr>
                                    <td style="padding-right: 0.5em;">
                                        ‚öõÔ∏è
                                    </td>
                                    <td>
                                        Welche URLs besitzt der Webservice?
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-right: 0.5em;">
                                        ‚öõÔ∏è
                                    </td>
                                    <td>
                                        Welche URL-Parameter k√∂nnen einer URL mitgegeben werden?
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-right: 0.5em;">
                                        ‚öõÔ∏è
                                    </td>
                                    <td>
                                        Welche HTML-Formularfelder k√∂nnen an die URL geschickt werden?
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-right: 0.5em;">
                                        ‚öõÔ∏è
                                    </td>
                                    <td>
                                        Welche Daten k√∂nnen mit POST, PUT oder PATCH an die URL geschickt werden?
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-right: 0.5em;">
                                        ‚öõÔ∏è
                                    </td>
                                    <td>
                                        Welche HTTP-Statuscodes kann die Antwort enthalten?
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-right: 0.5em;">
                                        ‚öõÔ∏è
                                    </td>
                                    <td>
                                        Welche Daten werden bei welchem Statuscode zur√ºckgeschickt?
                                    </td>
                                </tr>
                            </table>

                            <h2>Beispiel</h2>

                            <source-code language="xml">
                                &lt;application xmlns="http://wadl.dev.java.net/2009/02"
                                        xmlns:xs="http://www.w3.org/2001/XMLSchema"&gt;

                                    &lt;!--
                                    Hier k√∂nnten XML-Schema-Anweisungen stehen, mit welchen die Struktur
                                    der ausgetauschten Daten formal definiert wird, wenn der Webservice
                                    XML als Datenformat verwendet. Dieser hier nutzt allerdings JSON. üôÑ
                                    --&gt;
                                    &lt;grammars/&gt;

                                    &lt;!--
                                    Die Basis-URL des Webservice lautet
                                    http://localhost:8080/TheXFiles/rest/
                                    --&gt;
                                    &lt;resources base="http://localhost:8080/TheXFiles/rest/"&gt;

                                        &lt;!--
                                        Nachfolgend wird die URL
                                        http://localhost:8080/TheXFiles/rest/xfiles2018/
                                        beschrieben.
                                        --&gt;
                                        &lt;resource path="xfiles2018"&gt;
                                            &lt;!--
                                            Schicken wir eine GET-Anfrage an die URL, wird dadurch die Methode
                                            findEpisodes() aufgerufen.
                                            --&gt;
                                            &lt;method id="findEpisodes" name="GET"&gt;
                                                &lt;!--
                                                Optional k√∂nnen wir der Methode einen Parameter namens "query"
                                                mitgeben. Der Parameter ist ein String und muss als URL-Parameter
                                                an die URL angeh√§ngt werden. Zum Beispiel so:

                                                http://localhost:8080/TheXFiles/rest/xfiles2018/?query=My%20Struggle
                                                --&gt;
                                                &lt;request&gt;
                                                    &lt;param name="query" style="query" type="xs:string"/&gt;
                                                &lt;/request&gt;

                                                &lt;!--
                                                Als Antwort erhalten wir dann einen JSON-String.
                                                --&gt;
                                                &lt;response&gt;
                                                    &lt;representation mediaType="application/json"/&gt;
                                                &lt;/response&gt;
                                            &lt;/method&gt;

                                            &lt;!--
                                            Eine POST-Anfrage w√ºrde hingegen die Methode saveNewEpisode() zur
                                            Anlage eines neuen Datensatzes aufrufen.
                                            --&gt;
                                            &lt;method id="saveNewEpisode" name="POST"&gt;
                                                &lt;!--
                                                Als Anfrage m√ºssen wir einen JSON-String mitschicken.
                                                --&gt;
                                                &lt;request&gt;
                                                    &lt;representation mediaType="application/json"/&gt;
                                                &lt;/request&gt;

                                                &lt;!--
                                                Im Gegenzug schickt uns der Server ein JSON zur√ºck.
                                                --&gt;
                                                &lt;response&gt;
                                                    &lt;representation mediaType="application/json"/&gt;
                                                &lt;/response&gt;
                                            &lt;/method&gt;

                                            &lt;!--
                                            Mit der URL http://localhost:8080/TheXFiles/rest/xfiles2018/{id}/
                                            k√∂nnen wir auf einzelne Datens√§tze zugreifen. {id} ist dabei ein
                                            Platzhalter, der mit der ID des Datensatzes ersetzt werden muss.
                                            --&gt;
                                            &lt;resource path="{id}"&gt;
                                                &lt;!--
                                                Die ID kann ein beliebiger String sein. H√§ufig kommt es aber
                                                auch vor, dass es sich um einen Long oder irgendeinen anderen
                                                primitiven Datentypen handeln muss.
                                                --&gt;
                                                &lt;param name="id" style="template" type="xs:string"/&gt;

                                                &lt;!--
                                                Schicken wir eine GET-Anfrage an die URL, wird dadurch die Methode
                                                getEpisode() aufgerufen. Sie schickt uns eine einzelne Episode im
                                                JSON-Format zur√ºck.
                                                --&gt;
                                                &lt;method id="getEpisode" name="GET"&gt;
                                                    &lt;response&gt;
                                                        &lt;representation mediaType="application/json"/&gt;
                                                    &lt;/response&gt;
                                                &lt;/method&gt;

                                                &lt;!--
                                                Schicken wir eine DELETE-Anfrage, wird stattdessen die Methode
                                                deleteEpisode() aufgerufen. Auch sie schickt uns die gel√∂schte
                                                Episode im JSON-Format zur√ºck.
                                                --&gt;
                                                &lt;method id="deleteEpisode" name="DELETE"&gt;
                                                    &lt;response&gt;
                                                        &lt;representation mediaType="application/json"/&gt;
                                                    &lt;/response&gt;
                                                &lt;/method&gt;

                                                &lt;!--
                                                Schicken wir eine PUT-Anfrage, k√∂nnen wir dadurch die Methode
                                                updateEpisode() zum Aktualisieren eines Datensatzes aufrufen.
                                                Hierf√ºr m√ºssen wir ein JSON mit den Episodendaten hinschicken
                                                und bekommen ein JSON mit den gespeicherten Daten zur√ºck.
                                                --&gt;
                                                &lt;method id="updateEpisode" name="PUT"&gt;
                                                    &lt;request&gt;
                                                        &lt;representation mediaType="application/json"/&gt;
                                                    &lt;/request&gt;
                                                    &lt;response&gt;
                                                        &lt;representation mediaType="application/json"/&gt;
                                                    &lt;/response&gt;
                                                &lt;/method&gt;

                                            &lt;/resource&gt;
                                            &lt;!-- http://localhost:8080/TheXFiles/rest/xfiles2018/{id}/ --&gt;

                                        &lt;/resource&gt;
                                        &lt;!-- http://localhost:8080/TheXFiles/rest/xfiles2018/ --&gt;

                                    &lt;/resources&gt;
                                    &lt;!-- http://localhost:8080/TheXFiles/rest/ --&gt;
                                &lt;/application&gt;
                            </source-code>
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    Auf dieser Folie siehst du ein Beispiel daf√ºr, wie die verschiedenen HTTP-Verben bei REST genutzt werden, um Daten vom Server
                    zu lesen oder zu schreiben. Als Ressourcen dienen dabei die Episoden einer Fernsehserie¬π. Anhand dieses Beispiels sieht man auch
                    sch√∂n, wie unterschiedliche URLs bei REST unterschiedliche Bedeutungen haben. So handelt es sich bei der URL <code>/rest/xfiles2018/</code>
                    um eine <b>Collection</b>, also um eine Liste von Ressourcen, die mit einer einzigen GET-Anfrage abgerufen werden kann. Diese URL,
                    die eine Liste von Episoden beschreibt, erlaubt daher nur GET und POST-Anfragen:
                </p>
                <ul>
                    <li>
                        <b>GET:</b> Abruf der Liste
                    </li>
                    <li>
                        <b>POST:</b> Speichern eines neuen Eintrags
                    </li>
                </ul>
                <p>
                    <small>
                        ¬π Hier Akte X, die im Jahr 2018 mit <a href="https://en.m.wikipedia.org/wiki/The_X-Files_(season_11)" target="_blank">Season 11</a>
                        schon zum zweiten mal nach dem eigentlichen Ende 2002 auf die heimischen Fernseher zur√ºckkehrte.
                    </small>
                    üëΩ
                </p>
                <p>
                    Bei der URL <code>/rest/xfiles2018/2AYW04/</code> handelt es sich hingegen um eine einzelne Episode, üõ∏ also um eine einzelne
                    Ressource des Webservices. Sie erlaubt die folgenden HTTP-Anfragen:
                </p>
                <ul>
                    <li>
                        <b>GET:</b> Abruf aller Detailinformationen
                    </li>
                    <li>
                        <b>PUT:</b> Speichern einer neuen Version
                    </li>
                    <li>
                        <b>PATCH:</b> Einzelne Felder √ºberschreiben
                    </li>
                    <li>
                        <b>DELETE:</b> Eintrag l√∂schen
                    </li>
                </ul>
                <p>
                    Bei GET und DELETE m√ºssen keine weiteren Daten an den Server gesendet werden. Die URL alleine reicht bereits aus, damit der Server
                    wei√ü, um welchen Datensatz es sich handelt und wie er damit umgehen muss. Bei POST muss hingegen der komplette Datensatz an den
                    Server geschickt werden, damit dieser die vorhandene Version √ºberschreiben kann. Bei PATCH, sofern es der Webservice unterst√ºtzt,
                    m√ºssen hingegen nur die Felder √ºbertragen werden, die man tats√§chlich √§ndern will.
                </p>
                <p>
                    Als Datenformat kommt bei allen Anfragen jeweils JSON zum Einsatz, was der Client durch das Header Field <code>Accept: application/json</code>
                    signalisiert. Er fordert den Server damit auf, seine Daten im JSON-Format zu √ºbertragen. Dass die zur√ºckgeschickten Daten dann auch wirklich
                    im JSON-Format kommen, wird hingegen durch das Header Field <code>Content-Type: application/json</code> definiert. Dadurch k√∂nnen sich Client
                    und Server auf ein Datenformat einigen, wenn der Server mehre unterst√ºtzt. H√§ufig kommt es daher vor, dass man die URL eines REST-Services
                    auch einfach im Browser eingeben kann, um eine HTML-Darstellung der Ressource zu erhalten, oder dass noch weitere Formate wie XML oder
                    <a href="https://de.wikipedia.org/wiki/YAML" target="_blank">YAML</a> unterst√ºtzt werden.
                </p>

                <h2>WADL-Beschreibung</h2>
                <p>
                    Urspr√ºnglich war f√ºr REST-Webservices keine formale Beschreibung √§hnlich der WSDL f√ºr SOAP vorgesehen, und sehr viele, wenn nicht sogar die
                    allermeisten REST-Webservices besitzen auch keine, sondern kommen nur mit einer menschenlesbaren Dokumentation oder (zumindest bei den gro√üen
                    Anbietern) mehreren <a href="https://de.wikipedia.org/wiki/Software_Development_Kit" target="_blank">SDKs</a> f√ºr verschiedene Programmiersprachen
                    im Gep√§ck. üõçÔ∏è
                    Im Javaumfeld hat sich jedoch das  <a href="https://en.wikipedia.org/wiki/Web_Application_Description_Language" target="_blank">WADL-Format</a>
                    als m√∂gliche Alternative entwickelt. Es handelt sich dabei um eine automatisch generierte XML-Datei, die man durch Anh√§ngen von <code>?_wadl</code>
                    an die Basis-URL des Webservices abrufen kann. Sie beschreibt die erlaubten URLs, auch mit m√∂glichen Platzhaltern und URL-Parametern sowie die
                    jeweils zul√§ssigen HTTP-Verben und welche Datenformate der Server jeweils empfangen und senden kann. Optional kann sie auch Schemadefinitionen
                    f√ºr die ausgetauschten Daten enthalten. Wie wir auf der n√§chsten Folien sehen werden, lassen sich in Java entwickelte REST-Services dadurch in
                    SoapUI sehr gut testen.
                </p>
            </aside>
        </section>

        <section>
            <h1>REST-Webservices testen mit SoapUI</h1>
            <article>
                <ul class="dhbw-carousel-links">
                    <li>
                        <a href="#soapui-carousel" role="button" data-slide="next">N√§chstes Bild</a>
                    </li>
                    <li>
                        <a href="#soapui-carousel" role="button" data-slide="prev">Vorheriges Bild</a>
                    </li>
                    <li>
                        <a href="#soapui-carousel" role="button" data-slide-to="0">Nochmal von vorne</a>
                    </li>
                </ul>
                <div id="soapui-carousel" class="carousel slide" style="margin-bottom: 1em;" data-interval="false">
                    <div class="carousel-inner">
                        <div class="carousel-item img-thumbnail active">
                            <p>
                                Wieder einmal haben wir in Netbeans einen hervorragenden Webservice programmiert. ü§ó
                            </p>
                            <img class="active d-block w-100" src="soapui-01.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Durch Anh√§ngen von <tt>?_wadl</tt> an die URL k√∂nnen wir die WADL-Beschreibung abrufen.
                            </p>
                            <img class="active d-block w-100" src="soapui-02.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Um den Webservice zu testen, legen wir in SoapUI ein REST-Projekt an.
                            </p>
                            <img class="active d-block w-100" src="soapui-03.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Im folgenden Fenster musst du auf <i>Import WADL‚Ä¶</i> klicken.
                            </p>
                            <img class="active d-block w-100" src="soapui-04.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Dadurch √§ndert sich das Fenster und du kannst die URL der WADL-Beschreibung einf√ºgen.
                            </p>
                            <img class="active d-block w-100" src="soapui-05.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Anhand der WADL kann SoapUI die aufrufbaren Methoden und die URL-Struktur des Webservices erkennen.
                            </p>
                            <img class="active d-block w-100" src="soapui-06.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Die Methode <tt>createDemoData()</tt> erwartet keine Parameter, so dass du sie direkt aufrufen kannst.
                            </p>
                            <img class="active d-block w-100" src="soapui-07.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Auf der rechten Seite zeigt SoapUI die empfangenen JSON-Daten an. In diesem Fall eine einfache Statusmeldung.
                            </p>
                            <img class="active d-block w-100" src="soapui-08.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Der Methode <tt>getListJson()</tt> kann ein URL-Parameter names ‚Äûquery‚Äù mitgegeben werden.
                                Sie liefert auch deutlich mehr Daten zur√ºck. üôÇ
                            </p>
                            <img class="active d-block w-100" src="soapui-09.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Dann wollen wir mal einen neuen Song anlegen. üéµ Die JSON-Struktur m√ºssen wir allerdings selbst herausfinden ‚Ä¶
                            </p>
                            <img class="active d-block w-100" src="soapui-10.png" />
                        </div>
                        <div class="carousel-item img-thumbnail">
                            <p>
                                Unser Webservice scheint perfekt zu funktionieren. üëçüèª
                                Klasse, was SoapUI alles kann.
                            </p>
                            <img class="active d-block w-25 m-auto" src="../../finish.svg" />
                        </div>
                    </div>
                </div>

                <p>
                    <small>
                        <small>
                            Bildnachweis f√ºr das Endesymbol: <a href="https://pixabay.com/en/symbol-gui-internet-internet-page-2480163/" target="_blank">Pixabay: janf93</a>
                        </small>
                    </small>
                </p>
            </article>
            <aside>
                <p>
                    Entgegen dem Namen kannst du mit <a href="https://www.soapui.org/downloads/soapui.html" target="_blank">SoapUI</a>
                    auch wunderbar REST-Webservices testen. üòé M√∂glich macht das die WADL-Beschreibung, die Java automatisch f√ºr uns
                    generiert. Die nachfolgenden Abbildungen zeigen dir, was du hierf√ºr tun musst.
                </p>
                <img src="rest.jpg" alt="" class="d-block img-thumbnail" style="width: 100%;" />
                <p>
                    <small>
                        Bildnachweis:
                        <a href="https://pixabay.com/de/hund-tier-s%C3%A4ugetier-niedlich-3209824/" target="_blank">Pixabay: LauraHalsel</a>
                    </small>
                </p>
            </aside>
        </section>

        <section data-background-color="rgb(231, 221, 141)">
            <h1>Aufgabe 1: SoapUI kann auch REST</h1>
            <article>
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md">
                            <p>
                                Nun, welche Musik h√∂rst du gerne? üéº Hier hast du die einmalige Gelegenheit, sie √ºber einen REST-Webservice in eine Datenbank einzutragen. üòé
                                Hierf√ºr musst du dir lediglich das Beispielprojekt von Moodle herunterladen und in Netbeans zum Laufen bekommen. Anschlie√üend √∂ffnet sich
                                eine kleine Seite im Browser, mit der du erste Versuche unternehmen kannst. Gehe dabei wie folgt vor:
                            </p>
                            <ol>
                                <li>
                                    Klicke jeden Link einmal an und schaue, was passiert.
                                </li>
                                <li>
                                    Falls die Links mit der ID 10 keine Daten liefern, tausche die ID in der URL aus.
                                </li>
                                <li>
                                    Schaue dir die WADL-Datei an und versuche, sie zu verstehen.
                                </li>
                                <li>
                                    Importiere die WADL-Datei in SoapUI und teste die verschiedenen Webservice-Operationen.
                                </li>
                            </ol>
                            <p>
                                Um einen neuen Song anzulegen, kannst du folgende JSON-Daten an den Server schicken:
                            </p>
                            <source-code language="json">
                                {
                                    "name": "Circle of Life",
                                    "artist": "Elton John",
                                    "songwriters": "Tim Rice",
                                    "releaseYear": 1994
                                }
                            </source-code>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md">
                            <img src="aufgabe1-browser.jpg" alt="Screenshot des Webservices im Browser" class="d-block img-thumbnail" style="width: 100%; background-color: rgb(72, 116, 140);" />
                        </div>
                        <div class="col-md">
                            <img src="aufgabe1-soapui.png" alt="Screenshot des Webservices in SoapUI" class="d-block img-thumbnail" style="width: 100%; background-color: rgb(72, 116, 140);" />
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    Hier kannst du nun deine ersten, praktischen Erfahrungen mit REST sammeln. Lade dir hierf√ºr einfach das Beispiel von Moodle
                    runter und erkunde es in SoapUI. Danach solltest mit der n√§chsten Aufgabe keine Probleme mehr haben. üéì
                </p>
                <div class="embed-responsive embed-responsive-16by9" style="margin-bottom: 1em">
                    <iframe class="embed-responsive-item" src="https://www.youtube-nocookie.com/embed/4bRuh9cNgl8?rel=0" allow="encrypted-media" allowfullscreen></iframe>
                </div>
            </aside>
        </section>

        <section data-background-color="rgb(231, 221, 141)">
            <h1>Aufgabe 2: Ein kleines REST-Quiz</h1>
            <article>
                <h2>Aufgabe 2.1: Allgemeine Fragen</h2>

                <p>
                    a) REST-Webservices besitzen eine einzige URL f√ºr alle Operationen.
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Wahr
                    </li>
                    <li>
                        Falsch
                    </li>
                </ol>

                <p>
                    b) REST-Webservices nutzen h√§ufig JSON als Datenformat, andere Formate k√∂nnen aber auch vorkommen.
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Wahr
                    </li>
                    <li>
                        Falsch
                    </li>
                </ol>

                <p>
                    c) REST-Webservices bieten einen √§hnlich gro√üen Funktionsumfang wie SOAP mit seinen WS-*-Standards.
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Wahr
                    </li>
                    <li>
                        Falsch
                    </li>
                </ol>

                <h2>Aufgabe 2.2: Fragen zur Technik</h2>

                <p>
                    a) Welche Aufgabe hat das <code>Accept</code> Header Field bei einem REST-Aufruf?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Es beschreibt das Datenformat, das der Server an den Client sendet.
                    </li>
                    <li>
                        Es beschreibt das Datenformat, das der Client an den Server sendet.
                    </li>
                    <li>
                        Es beschreibt das Datenformat, das der Client gerne vom Server empfangen m√∂chte.
                    </li>
                </ol>

                <p>
                    b) Welche Aufgabe hat das <code>Content-Type</code> Header Field bei einem REST-Aufruf?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Es beschreibt das Datenformat, das der Server an den Client sendet.
                    </li>
                    <li>
                        Es beschreibt das Datenformat, das der Client an den Server sendet.
                    </li>
                    <li>
                        Es beschreibt das Datenformat, das der Client gerne vom Server empfangen m√∂chte.
                    </li>
                </ol>

                <p>
                    c) Welche der folgenden URLs dient dem Abruf einer Collection mit mehreren Songs?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        <code>https://example.com/api/songs/elton-john/your-song/</code>
                    </li>
                    <li>
                        <code>https://example.com/api/songs/</code>
                    </li>
                    <li>
                        <code>https://example.com/api/songs/511/</code>
                    </li>
                    <li>
                        <code>https://example.com/songs/your-song/?details=all</code>
                    </li>
                </ol>

                <p>
                    d) Welche Aufgabe haben die HTTP-Verben PUT und POST bei REST?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Neue Daten anlegen bzw. vorhandene Daten aktualisieren
                    </li>
                    <li>
                        Eine Liste mit mehreren Datens√§tzen auf einmal l√∂schen
                    </li>
                    <li>
                        Daten in einem anderen Format als JSON vom Server abrufen
                    </li>
                </ol>

                <p>
                    e) Wie kann man bei manchen REST-Webservices einzelne Felder anstatt allen Daten √§ndern?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Das geht nicht, da es kein passendes HTTP-Verb hierf√ºr gibt.
                    </li>
                    <li>
                        Mit dem HTTP-Verb PUT, indem nur die zu √§ndernden Felder an den Server geschickt werden.
                    </li>
                    <li>
                        Mit dem HTTP-Verb PATCH, indem nur die zu √§ndernden Felder an den Server geschickt werden.
                    </li>
                    <li>
                        Mit dem HTTP-Verb POST, indem nur die zu √§ndernden Felder an den Server geschickt werden.
                    </li>
                </ol>

                <hr />

                <p style="width: 100%; transform: scaleY(-1) scaleX(-1); display: inline-block;">
                    <small>
                        <b>L√∂sung:</b> Aufgabe 2.1: 2, 1, 2<br />
                        Aufgabe 2.2: 3, 1 + 2, 2, 1, 3
                    </small>
                </p>
            </article>
            <aside>
                <p>
                    Sehr sch√∂n! Damit haben wir auch schon alle notwendigen Grundlagen zu REST durch.
                    Um sicherzugehen, dass du dir alles merken konntest, gibt es hier ein paar Fragen dazu. ‚òòÔ∏è
                </p>
            </aside>
        </section>

        <!--
            =========================
            REST-WEBSERVICES MIT JAVA
            =========================
        -->
        <section data-chapter data-background-image="../../trennfolie.jpg">
            <h1>REST-Webservices mit Java</h1>
            <article>
                <small>
                    <small>
                        Bildnachweis:
                        <a href="https://pixabay.com/en/adult-break-business-caucasian-2398561/" target="_blank">Pixabay: rawpixel</a>
                    </small>
                </small>
            </article>
        </section>

        <section>
            <h1>Eigene Webservices definieren</h1>
            <article>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "programmierung-annotationen-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#programmierung-annotationen"
                                role          = "tab"
                                aria-controls = "programmierung-annotationen"
                                aria-expanded = "true"
                            >
                                Ben√∂tigte Annotationen
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "programmierung-datenmodell-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#programmierung-datenmodell"
                                role          = "tab"
                                aria-controls = "programmierung-datenmodell"
                            >
                                Datenmodell
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "programmierung-application-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#programmierung-application"
                                role          = "tab"
                                aria-controls = "programmierung-application"
                            >
                                Application-Klasse
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "programmierung-webservice-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#programmierung-webservice"
                                role          = "tab"
                                aria-controls = "programmierung-webservice"
                            >
                                Webservice-Klassen
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- Ben√∂tigte Annotationen -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "programmierung-annotationen"
                            role            = "tabpanel"
                            aria-labelledby = "programmierung-annotationen-tab"
                        >
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-md">
                                        <h2>Application-Klasse</h2>
                                        <p>
                                            Ein REST-Webservice besitzt in Java immer mindestens zwei Klassen. Eine zentrale Application-Klasse als Einstieg,
                                            in der der URL-Prefix definiert wird, sowie mindestens eine Klasse f√ºr die eigentlichen Collections und Ressourcen.
                                            Die Applikation-Klasse bindet dabei alle anderen Klassen in ihrem Quellcode ein.
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <h3>@ApplicationPath</h3>
                                        <p>
                                            Steht vor der Application-Klasse und definiert dort die Basis-URL aller Ressourcen.
                                        </p>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md">
                                        <h2>Webservice-Klassen</h2>
                                        <p>
                                            Jede Collection sowie jede Ressource wird in einer eigenen Klasse ausprogrammiert. Sie beinhaltet die einzelnen
                                            Methoden des Webservices und legt fest, mit welchen URL-Mustern und HTTP-Verben die Methoden aufgerufen werden.
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <h3>@GET</h3>
                                        <p>
                                            Kennzeichnet eine Methode, die bei einer GET-Anfrage aufgerufen wird und dem Abruf von Daten dient.
                                        </p>
                                    </div>
                                    <div class="col-md">
                                        <h3>@POST</h3>
                                        <p>
                                            Kennzeichnet eine Methode, die bei einer POST-Anfrage aufgerufen wird und dem Speichern von dient.
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <h3>@PUT</h3>
                                        <p>
                                            Kennzeichnet eine Methode, die bei einer PUT-Anfrage aufgerufen wird und dem Speichern von Daten dient.
                                        </p>
                                    </div>
                                    <div class="col-md">
                                        <h3>@DELETE</h3>
                                        <p>
                                            Kennzeichnet eine Methode, die bei einer DELETE-Anfrage aufgerufen wird und der L√∂schung von Daten dient.
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <hr />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <h3>@Produces</h3>
                                        <p>
                                            Steht vor einer Methode und definiert den <a href="https://en.wikipedia.org/wiki/Media_type" target="_blank">MIME-Type</a>
                                            der zur√ºckgelieferten Daten.
                                        </p>
                                    </div>
                                    <div class="col-md">
                                        <h3>@Consumes</h3>
                                        <p>
                                            Steht vor einer Methode und definiert den <a href="https://en.wikipedia.org/wiki/Media_type" target="_blank">MIME-Type</a>
                                            der durch die Methode verarbeiteten Daten.
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <hr />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <h3>@Path</h3>
                                        <p>
                                            Kann vor einer Klasse oder Methode stehen und definiert den Teil der URL, der zum Aufruf der jeweiligen Klasse
                                            oder Methode f√ºhrt. In geschweiften Klammern k√∂nnen dabei <b>Platzhalter</b> stehen, die als Parameter an die
                                            aufgerufene Methode √ºbergeben werden. Zum Beispiel: <src-code language="java">@Path("Songs/{id}")</src-code>
                                        </p>
                                    </div>
                                    <div class="col-md">
                                        <h3>@PathParam</h3>
                                        <p>
                                            Kennzeichnet einen Methodenparameter, dessen Wert √ºber einen Platzhaler in der URL ermittelt wird.
                                            Zum Beispiel: <src-code language="java">@PathParam("id") String id</src-code>
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md">
                                        <h3>@QueryParam</h3>
                                        <p>
                                            Steht vor einem Methodenparameter und legt fest, dass dieser in Form eines URL-Parameters √ºbergeben wird.
                                            Zum Beispiel muss bei <src-code language="java">@QueryParam("search") String search</src-code> der String
                                            <code>?search=Queen</code> an die URL abgeh√§ngt werden, um den Wert <tt><i>Queen</i></tt> zu √ºbergeben.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Datenmodell -->
                        <div
                            class           = "tab-pane fade"
                            id              = "programmierung-datenmodell"
                            role            = "tabpanel"
                            aria-labelledby = "programmierung-datenmodell-tab"
                        >
                            <p>
                                Wie immer ben√∂tigen wir erst einmal ein paar Persistence Entities und Enterprise Java Beans. Zumindest, wenn wir Daten
                                aus einer Datenbank lesen und schreiben wollen. üõ¢Ô∏è F√ºr die EJB nutzen wir wie immer die
                                <a href="../../2-javaee/jpa/#19" target="_blank"><code>EntityBean</code> aus den JPA-Folien</a>.
                            </p>
                            <source-code language="java">
                                /**
                                 * Einfache Entity-Klasse f√ºr einen Song.
                                 */
                                @Entity
                                public class Song implements Serializable {

                                    @Id
                                    @GeneratedValue(strategy = GenerationType.TABLE, generator = "song_ids")
                                    @TableGenerator(name = "song_ids", initialValue = 0, allocationSize = 50)
                                    private final long id = 0L;

                                    private String name = "";
                                    private String artist = "";
                                    private String songwriters = "";
                                    private int releaseYear = 0;

                                    // Konstruktoren

                                    // Setter und Getter
                                }

                                /**
                                 * Einfache EJB mit den √ºblichen Methoden zum Lesen und Schreiben von Songs.
                                 * Diese Klasse nutzt unsere altbekannte EntityBean aus den JPA-Folien, um
                                 * einen Grundstock an Standardmethoden anzubieten.
                                 */
                                @Stateless
                                public class SongBean extends EntityBean&lt;Song, Long&gt; {

                                    public SongBean() {
                                        super(Song.class);
                                    }
                                }
                            </source-code>
                        </div>
                        <!-- Application-Klasse -->
                        <div
                            class           = "tab-pane fade"
                            id              = "programmierung-application"
                            role            = "tabpanel"
                            aria-labelledby = "programmierung-application-tab"
                        >
                            <p>
                                Im Gegensatz zu SOAP ben√∂tigt jeder REST-Webservice in Java eine Application-Klasse, welche
                                den URL-Prefix des Webservices definiert und in welche alle weiteren Klassen aufgenommen
                                werden m√ºssen. Wichtig sind hierbei die Annotation <code>@ApplicationPath</code> f√ºr die URL
                                sowie die Methode <code>getClasses()</code>, die eine Liste aller abh√§ngigen Klassen
                                zur√ºckliefert.
                            </p>
                            <source-code language="java">
                                /**
                                * Einstiegspunkt f√ºr unseren REST-Webservice. Hier werden der URL-Prefix aller
                                * Aufrufe definiert (√ºber @ApplicationPath) sowie alle Collections und Ressourcen
                                * dem Webservice hinzugef√ºgt. Diese Klasse muss daher immer angepasst werden,
                                * wenn weitere Collections oder Ressourcen hinzukommen.
                                 */
                                @ApplicationPath("api")
                                public class MusicalRestAPI extends Application {

                                    @Override
                                    public Set&lt;Class&lt;?&gt;&gt; getClasses() {
                                        Set&lt;Class&lt;?&gt;&gt; resources = new HashSet&lt;&gt;();

                                        // Hier f√ºr jede Webservice-Klasse eine Zeile hinzuf√ºgen
                                        resources.add(SongCollection.class);
                                        resources.add(SongResource.class);

                                        return resources;
                                    }
                                }
                            </source-code>
                        </div>
                        <!-- Webservice-Klassen -->
                        <div
                            class           = "tab-pane fade"
                            id              = "programmierung-webservice"
                            role            = "tabpanel"
                            aria-labelledby = "programmierung-webservice-tab"
                        >
                            <p>
                                Bei den eigentlichen Webservice-Klassen, die jeweils f√ºr eine Collection oder Ressource des Webservices stehen,
                                handelt es sich wieder um altbekannte Stateless Session Beans. üë¥üèΩ Ihre Methoden werden durch die √ºbrigen Annotationen
                                auf die verschiedenen URLs und HTTP-Verben gemappt. Fangen wir also mit der Klasse f√ºr eine <b>Collection</b> an,
                                um eine Liste auslesen, Eintr√§ge suchen und neue Eintr√§ge anlegen zu k√∂nnen:
                            </p>
                            <source-code language="java">
                                /**
                                 * Collection "Songs" zum Suchen von Songs und Speichern neuer Songs.
                                 */
                                @Stateless
                                @Path("Songs")
                                public class SongCollection {

                                    @EJB
                                    SongBean songBean;

                                    /**
                                     * GET /api/Songs/List/
                                     * Auslesen einer Liste von Musikst√ºcken.
                                     */
                                    @GET
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public List&lt;Song&gt; findSongs() {
                                        return this.songBean.findAll();
                                    }

                                    /**
                                     * POST /api/Songs/
                                     * Speichern eines neuen Songs.
                                     */
                                    @POST
                                    @Consumes(MediaType.APPLICATION_JSON)
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public String saveNewSong(Song song) {
                                        return this.songBean.saveNew(song);
                                    }
                                }
                            </source-code>
                            <p>
                                Anschlie√üend legen wir eine weitere Klasse f√ºr <b>einzelne Ressourcen</b> an. Streng genommen k√∂nnten die Methoden
                                zwar auch alle in einer Klasse stehen (<code>@Path</code> kann auch vor einer Methode stehen), so ist es jedoch
                                √ºbersichtlicher und damit wartbarer.
                            </p>
                            <source-code language="java">
                                /**
                                 * Ressource f√ºr einen einzelnen Song. Hier kann ein einzelner Song abgerufen,
                                 * aktualisiert oder gel√∂scht werden.
                                 */
                                @Stateless
                                @Path("Songs/{id}")
                                public class SongResource {

                                    @EJB
                                    SongBean songBean;

                                    /**
                                     * GET /api/Songs/{id}/
                                     * Auslesen eines einzelnen Songs anhand seiner ID.
                                     */
                                    @GET
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public Song getSong(@PathParam("id") long id) {
                                        return this.songBean.findById(id);
                                    }


                                    /**
                                     * PUT /api/Songs/{id}/
                                     * Aktualisieren eines vorhandenen Songs.
                                     */
                                    @PUT
                                    @Consumes(MediaType.APPLICATION_JSON)
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public Song updateSong(Song song) {
                                        return this.songBean.update(song);
                                    }

                                    /**
                                     * DELETE /api/Songs/{id}/
                                     * L√∂schen eines vorhandenen Songs.
                                     */
                                    @DELETE
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public Song deleteSong(@PathParam("id") long id) {
                                        Song song = this.songBean.findById(id);

                                        if (response.song != null) {
                                            this.songBean.delete(response.song);
                                        }

                                        return song;
                                    }
                                }
                            </source-code>
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    Zugegeben, die Definition eigener Webservices ist mit REST etwas aufw√§ndiger als mit SOAP. ü§¶ Aber daf√ºr tickt REST eben auch ganz
                    anders und erfordert deshalb auch mehr Annotationen. Hat man aber einmal den Dreh raus, üéóÔ∏è ist es auch nicht wirklich kompliziert.
                    Man muss sich nur ein paar Gedanken dar√ºber machen, wie die URLs des Webservices aufgebaut sein sollen und welche Ressource
                    mit welcher URL angesprochen wird. Auch muss man sich nat√ºrlich √ºberlegen, welche HTTP-Verben und damit auch welche Operationen
                    man √ºberhaupt unterst√ºtzen will. Ein gutes Vorgehen ist dabei folgendes:
                </p>
                <p>
                    Zun√§chst legt man √ºber die <b>Application-Klasse</b> des Webservices seine Basis-URL fest. Also den Prefix, mit dem alle
                    URLs des Webservices beginnen. Dies geschieht durch die Annotation <code>@ApplicationPath</code>, die vor einer Klasse,
                    die von <code>Application</code> erbt, steht:
                </p>
                <source-code language="java">
                    @ApplicationPath("api")
                    public class MusicalRestAPI extends Application { ‚Ä¶ }
                </source-code>
                <p>
                    In diesem Beispiel beginnen also alle URLs mit <code>/api/</code>. Anschlie√üend definiert man je Ressource zwei Webservice-Klassen
                    und f√ºhrt sie innerhalb der Application-Klasse auf. Eine Klasse f√ºr die Collection sowie eine f√ºr einzelne Ressourcen.
                </p>
                <source-code language="java">
                    @ApplicationPath("api")
                    public class MusicalRestAPI extends Application {
                        @Override
                        public Set&lt;Class&lt;?&gt;&gt; getClasses() {
                            Set&lt;Class&lt;?&gt;&gt; resources = new HashSet&lt;&gt;();

                            // Hier f√ºr jede Webservice-Klasse eine Zeile hinzuf√ºgen
                            resources.add(SongCollection.class);
                            resources.add(SongResource.class);

                            return resources;
                        }
                    }
                </source-code>
                <p>
                    Die Webservice-Klassen bekommen, da sie ja f√ºr eine Ressourcenart mit eindeutigen URLs stehen, √ºber die <code>@Path</code>-Annotation
                    einen eigenen URL-Prefix unterhalb der Basis-URL zugewiesen:
                </p>
                <source-code language="java">
                    @Stateless
                    @Path("Songs")
                    public class SongCollection { ‚Ä¶ }

                    @Stateless
                    @Path("Songs/{id}")
                    public class SongResource { ‚Ä¶ }
                </source-code>
                <p>
                    Hier haben wir es zum Beispiel mit der Ressourcenart <tt>Songs</tt> zu tun, die √ºber die URL <code>/api/Songs/</code> f√ºr die Collection
                    sowie <code>/api/Songs/{id}</code> f√ºr einen einzelnen Song angesprochen wird. <code>{id}</code> ist dabei ein Platzhalter, der durch
                    die eigentliche ID ersetzt werden muss.
                </p>
                <p>
                    Weiter geht es mit der Collection-Klasse. Sie bekommt zwei Methoden f√ºr GET- und POST-Anfragen, zum Auslesen einer Liste sowie
                    zum Anlegen eines neuen Eintrags:
                </p>
                <source-code language="java">
                    @Stateless
                    @Path("Songs")
                    public class SongCollection {

                        @GET
                        @Produces(MediaType.APPLICATION_JSON)
                        public List&lt;Song&gt; findSongs() { ‚Ä¶ }

                        @POST
                        @Consumes(MediaType.APPLICATION_JSON)
                        @Produces(MediaType.APPLICATION_JSON)
                        public Song saveNewSong(Song song) { ‚Ä¶ }
                    }
                </source-code>
                <p>
                    Die Ressourcenklasse f√ºr einzelne Datens√§tze hingegen bekommt Methoden f√ºr GET-, PUT- und DELETE-Anfragen.
                </p>
                <source-code language="java">
                    @Stateless
                    @Path("Songs/{id}")
                    public class SongResource {

                        @GET
                        @Produces(MediaType.APPLICATION_JSON)
                        public Song getSong(@PathParam("id") long id) { ‚Ä¶ }

                        @PUT
                        @Consumes(MediaType.APPLICATION_JSON)
                        @Produces(MediaType.APPLICATION_JSON)
                        public Song updateSong(Song song) { ‚Ä¶ }

                        @DELETE
                        @Produces(MediaType.APPLICATION_JSON)
                        public Song deleteSong(@PathParam("id") long id) { ‚Ä¶ }
                    }
                </source-code>
                <p>
                    Dadurch hat mein eine saubere Quellcodestruktur und logische RESTful URLs, die nicht im Widerspruch zur Bedeutung der
                    Methoden stehen.
                </p>
            </aside>
        </section>

        <section>
            <h1>Die Antwortdaten flexibler gestalten</h1>
            <article>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "antwortdaten-projekttyp-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#antwortdaten-projekttyp"
                                role          = "tab"
                                aria-controls = "antwortdaten-projekttyp"
                                aria-expanded = "true"
                            >
                                Maven-Projekt anlegen
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "antwortdaten-pom-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#antwortdaten-pom"
                                role          = "tab"
                                aria-controls = "antwortdaten-pom"
                            >
                                Erweiterung der pom.xml
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "antwortdaten-code-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#antwortdaten-code"
                                role          = "tab"
                                aria-controls = "antwortdaten-code"
                            >
                                √Ñnderungen am Quellcode
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- Maven-Projekt anlegen -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "antwortdaten-projekttyp"
                            role            = "tabpanel"
                            aria-labelledby = "antwortdaten-projekttyp-tab"
                        >
                            <p>
                                Damit der hier beschriebene Trick funktioniert, ist es wichtig, das Projekt als <b>Maven-Projekt</b> anzulegen.
                                Dadurch wird das Build-Werkzeug <a href="https://maven.apache.org/" target="_blank">Maven</a> anstelle von
                                <a href="https://ant.apache.org/" target="_blank">Ant</a> verwendet. Dies erm√∂glicht es uns, ganz einfach
                                fremde Abh√§ngigkeiten wie die <a href="https://github.com/google/gson" target="_blank">GSON-Bibliothek</a>
                                hinzuzuf√ºgen. Au√üerdem l√§sst sich das Projekt somit auch in anderen IDEs √∂ffnen oder gar v√∂llig ohne IDE
                                weiterentwickeln.
                            </p>
                            <img src="maven-webapp.png" alt="Maven / Web Application ist der richtige Projekttyp" class="d-block" style="width: 100%;" />
                        </div>
                        <!-- Erweiterung der pom.xml -->
                        <div
                            class           = "tab-pane fade"
                            id              = "antwortdaten-pom"
                            role            = "tabpanel"
                            aria-labelledby = "antwortdaten-pom-tab"
                        >
                            <p>
                                Innerhalb des Ordners <b>Project Files</b> findet sich dann die Datei <tt>pom.xml</tt>. Sie geh√∂rt zu Maven und
                                beschreibt das gesamte Projekt, unter anderem auch, welche Abh√§ngigkeiten es besitzt. Die nachfolgenden Zeilen
                                m√ºssen im Bereich <src-code language="xml">&lt;dependencies&gt;‚Ä¶&lt;/dependencies&gt;</src-code> eingef√ºgt werden:
                            </p>
                            <source-code language="xml">
                                &lt;project&gt;
                                    ‚Ä¶
                                    &lt;dependencies&gt;
                                        ‚Ä¶
                                        &lt;!--
                                            Google GSON
                                            ===========

                                            Damit l√§sst sich ein Javaobjekt nach JSON umwandeln und umgekehrt.
                                            https://mvnrepository.com/artifact/com.google.code.gson/gson
                                        --&gt;
                                        &lt;dependency&gt;
                                            &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt;
                                            &lt;artifactId&gt;gson&lt;/artifactId&gt;
                                            &lt;version&gt;2.8.2&lt;/version&gt;
                                        &lt;/dependency&gt;
                                    &lt;/dependencies&gt;
                                    ‚Ä¶
                                &lt;/project&gt;
                            </source-code>
                        </div>
                        <!-- √Ñnderungen am Quellcode -->
                        <div
                            class           = "tab-pane fade"
                            id              = "antwortdaten-code"
                            role            = "tabpanel"
                            aria-labelledby = "antwortdaten-code-tab"
                        >
                            <p>
                                Und hier nun die angepasste Version der Klasse <code>SongCollection</code>. Innerhalb der Klasse befindet sich
                                ein GSON-Objekt, das zum (De)serialisieren der JSON-Daten verwendet werden kann. Diese werden den Methoden daher
                                nun als String √ºbergeben und auch der R√ºckgabewert aller Methoden ist ein String. Zus√§tzlich beinhaltet die Klasse
                                eine innere Klasse namens <code>Response</code>, die alle f√ºr eine Antwort ben√∂tigten Felder enth√§lt.
                            </p>
                            <ul>
                                <li>
                                    <b>song:</b> R√ºckgabedaten eines einzelnen Songs, falls die Methode immer nur einen Song liefern kann.
                                </li>
                                <li>
                                    <b>songs:</b> R√ºckgabedaten einer Liste von Songs, falls die Methode potentiell mehrere Eintr√§ge liefern kann.
                                </li>
                                <li>
                                    <b>status:</b> Ein einfacher Statuscode wie <tt>OK</tt> oder <tt>ERROR</tt>, anhand dessen der Client
                                    erkennen kann, ob der Aufruf erfolgreich war.
                                </li>
                                <li>
                                    <b>exception:</b> Der Name der aufgetretenen Exception, falls es zu einem Fehler kam.
                                </li>
                                <li>
                                    <b>message:</b> Eine f√ºr den Anwender verst√§ndliche Status- oder Fehlermeldung, die der Client bei Bedarf
                                    anzeigen kann.
                                </li>
                            </ul>
                            <p>
                                Die ver√§nderte <code>SongCollection</code>-Klasse sieht dadurch wie folgt aus. Nat√ºrlich muss die Klasse
                                <code>SongResource</code> analog dazu angepasst werden, auch wenn das hier nicht gezeigt wird.
                            </p>
                            <source-code language="java">
                                /**
                                 * Collection "Songs" zum Suchen von Songs und Speichern neuer Songs.
                                 */
                                @Stateless
                                @Path("Songs")
                                public class SongCollection {

                                    @EJB
                                    SongBean songBean;

                                    // GSON-Objekt zur (De)serialisierung von JSON
                                    Gson gson = this.gson = new GsonBuilder().create();

                                    /**
                                     * Datencontainer f√ºr die Antwortdaten, die von den Methoden unten jeweils
                                     * zur√ºckgeschickt werden k√∂nnen.
                                     */
                                    public class Response {

                                        public Song song;
                                        public List&lt;Song&gt; songs;
                                        public String status;
                                        public String exception;
                                        public String message;
                                    }

                                    /**
                                     * GET /api/Songs/List/
                                     * Auslesen einer Liste von Musikst√ºcken.
                                     */
                                    @GET
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public String findSongs() {
                                        Response response = new Response();

                                        try {
                                            response.songs = this.songBean.findAll();
                                            response.status = "OK";
                                        } catch (Exception ex) {
                                            response.status = "ERROR";
                                            response.exception = ex.getClass().getName();
                                            response.message = ex.getMessage();
                                        }

                                        return this.gson.toJson(response);
                                    }

                                    /**
                                     * POST /api/Songs/
                                     * Speichern eines neuen Songs.
                                     */
                                    @POST
                                    @Consumes(MediaType.APPLICATION_JSON)
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public String saveNewSong(String json) {
                                        Response response = new Response();

                                        try {
                                            Song song = this.gson.fromJson(json, Song.class);
                                            response.song = this.songBean.saveNew(song);
                                            response.status = "OK";
                                        } catch (Exception ex) {
                                            response.status = "ERROR";
                                            response.exception = ex.getClass().getName();
                                            response.message = ex.getMessage();
                                        }

                                        return this.gson.toJson(response);
                                    }
                                }
                            </source-code>
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    Auf der vorherigen Folie hast du gesehen, dass Java automatisch alle Objekte, die einer Methode √ºbergeben werden,
                    von und nach JSON umwandeln kann. Allerdings gibt es hierbei zwei Probleme:
                </p>
                <ol>
                    <li>
                        In manchen alten Applikationsservern gab es zumindest fr√ºher einen Bug, der genau dies verhinderte
                        und stattdessen die Anwendung abst√ºrzen lies. üòü
                    </li>
                    <li>
                        Wir k√∂nnen, so wie es auf der Folie gezeigt wurde, keine Fehlermeldungen an den Client senden. Wirft
                        eine der Methoden eine Exception, st√ºrzt die Anwendung ab und der Client bekommt eine 500er-Fehlerseite
                        im HTML-Format. ü§Ø
                    </li>
                </ol>
                <p>
                </p>
                <p>
                    Auf dieser Folie siehst du daher einen L√∂sungsansatz, der beide Probleme elegant umgeht. üíÉ Dem Server-Bug
                    werden wir mit der <a href="https://github.com/google/gson" target="_blank">GSON-Bibliothek von Google</a> Herr.
                    Auch wenn das heutzutage eigentlich nicht mehr n√∂tig sein sollte. Aber sicher ist sicher ‚Ä¶
                </p>
                <p>
                    Und um die M√∂glichkeit zu schaffen, auch Fehlermeldungen zur√ºckzusenden, definieren wir eine spezielle
                    <b>Response-Klasse</b>, die einen Stautscode, einen Meldungstext sowie die eigentlichen Nutzdaten enthalten kann.
                    Das Gute daran ist, dass der Code dadurch gar nicht so viel komplizierter wird. Ganz im Gegenteil, so sollte man es
                    eigentlich immer machen. üôÇ
                </p>
            </aside>
        </section>

        <section>
            <h1>REST-Webservices mit Java aufrufen</h1>
            <article>
                <table style="margin-bottom: 1em;">
                    <tr>
                        <td style="padding-right: 0.5em;">
                            üèóÔ∏è
                        </td>
                        <td>
                            Eigentlich ist es ganz leicht, wir m√ºssen aber alles selbst programmieren.
                        </td>
                    </tr>
                    <tr>
                        <td style="padding-right: 0.5em;">
                            üèóÔ∏è
                        </td>
                        <td>
                            Selbst mit der WADL k√∂nnen wir keinen sinnvollen Code automatisch generieren.
                        </td>
                    </tr>
                    <tr>
                        <td style="padding-right: 0.5em;">
                            üèóÔ∏è
                        </td>
                        <td>
                            Mit <a href="https://github.com/google/gson" target="_blank">Google Gson</a> und
                            <a href="http://unirest.io/java.html" target="_blank">Unirest for Java</a> ist
                            es aber gar nicht so schwer.
                        </td>
                    </tr>
                    <tr>
                        <td style="padding-right: 0.5em;">
                            üèóÔ∏è
                        </td>
                        <td>
                            Zumindest schon mal nicht schwerer als direkt mit den clientseitigen JAX-RS-Klassen.
                        </td>
                    </tr>
                </table>

                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "javaclient-maven-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#javaclient-maven"
                                role          = "tab"
                                aria-controls = "javaclient-maven"
                                aria-expanded = "true"
                            >
                                Maven-Projekt
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "javaclient-pomxml-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#javaclient-pomxml"
                                role          = "tab"
                                aria-controls = "javaclient-pomxml"
                            >
                                pom.xml
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "javaclient-aufruf-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#javaclient-aufruf"
                                role          = "tab"
                                aria-controls = "javaclient-aufruf"
                            >
                                Aufruf
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "javaclient-wsklassen-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#javaclient-wsklassen"
                                role          = "tab"
                                aria-controls = "javaclient-wsklassen"
                            >
                                Webservice-Klassen
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- Maven-Projekt -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "javaclient-maven"
                            role            = "tabpanel"
                            aria-labelledby = "javaclient-maven-tab"
                        >
                            <p>
                                Damit wir die abh√§ngigen Bibliotheken einbinden k√∂nnen, m√ºssen wir wieder ein <b>Maven-Projekt</b> anlegen.
                                Dieses mal eine <b>Java Application</b>.
                            </p>
                            <img src="maven-javaapp.png" alt="Neue Java-Anwendung mit Maven in Netbeans" class="d-block" style="width: 100%;" />
                        </div>
                        <!-- pom.xml -->
                        <div
                            class           = "tab-pane fade"
                            id              = "javaclient-pomxml"
                            role            = "tabpanel"
                            aria-labelledby = "javaclient-pomxml-tab"
                        >
                            <p>
                                Die Abh√§ngigkeiten werden dann wie folgt in der Maven-Datei <tt>pom.xml</tt> eingetragen:
                            </p>
                            <source-code language="xml">
                                &lt;project&gt;
                                    ‚Ä¶
                                    &lt;dependencies&gt;
                                        ‚Ä¶
                                        &lt;!--
                                            Google GSON
                                            ===========

                                            Damit l√§sst sich ein Javaobjekt nach JSON umwandeln und umgekehrt.
                                            https://mvnrepository.com/artifact/com.google.code.gson/gson
                                        --&gt;
                                        &lt;dependency&gt;
                                            &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt;
                                            &lt;artifactId&gt;gson&lt;/artifactId&gt;
                                            &lt;version&gt;2.8.2&lt;/version&gt;
                                        &lt;/dependency&gt;

                                        &lt;!--
                                            Unirest for Java
                                            ================

                                            Damit lassen sich ganz leicht HTTP-Anfragen absetzen.
                                            http://unirest.io/java.html
                                        --&gt;
                                        &lt;dependency&gt;
                                            &lt;groupId&gt;com.mashape.unirest&lt;/groupId&gt;
                                            &lt;artifactId&gt;unirest-java&lt;/artifactId&gt;
                                            &lt;version&gt;1.4.9&lt;/version&gt;
                                        &lt;/dependency&gt;
                                    &lt;/dependencies&gt;
                                    ‚Ä¶
                                &lt;/project&gt;
                            </source-code>
                        </div>
                        <!-- Aufruf -->
                        <div
                            class           = "tab-pane fade"
                            id              = "javaclient-aufruf"
                            role            = "tabpanel"
                            aria-labelledby = "javaclient-aufruf-tab"
                        >
                            <p>
                                So soll es sp√§ter aussehen. Ein lokales Stub-Objekt dient als ‚ÄûStellvertreter‚Äù f√ºr die entfernten
                                Methoden des Servers. Wir rufen einfach die Methoden des Stubs auf, um in Wirklichkeit eine Anfrage
                                an den Server zu schicken. ‚û°Ô∏è
                            </p>
                            <source-code language="java">
                                // Zugriff auf den Webservice erm√∂glichen
                                SongCollection songCollection = new SongCollection();
                                songCollecion.setAuthData("username", "password");

                                // Alle Songs der Dire Straits abrufen
                                SongCollection.Response response = songCollection.findSongs("Dire Straits");

                                if (response.code.equals("OK")) {
                                    for (Song song : response.songs) {
                                        // Empfangene Daten anzeigen
                                        ‚Ä¶
                                    }
                                }

                                // Neuen Song anlegen
                                Song song = new Song();
                                song.name = "Money For Nothing";
                                song.artist = "Dire Straits";
                                song.songwriters = "Mark Knopfler";
                                song.releaseYear = 1985;

                                songCollection.saveNewSong(song);
                            </source-code>

                            <hr />
                            <p>
                                Ach ja, <a href="https://www.youtube.com/watch?v=wTP2RUD_cL0" target="_blank">Money For Nothing</a> ‚Ä¶ üí∞
                            </p>
                        </div>
                        <!-- Webservice-Klassen -->
                        <div
                            class           = "tab-pane fade"
                            id              = "javaclient-wsklassen"
                            role            = "tabpanel"
                            aria-labelledby = "javaclient-wsklassen-tab"
                        >
                            <p>
                                Bei den Webservice-Klassen orientieren wir uns dabei komplett am Server und programmieren seine Klassen
                                im Grunde genommen nach. Nur, dass wir sie ein wenig vereinfachen und dass wir nat√ºrlich an den entscheidenden
                                Stellen HTTP-Anfragen an den Server schicken. üîå
                            </p>
                            <source-code language="java">
                                /**
                                 * Datentransferklasse f√ºr einen Song
                                 */
                                public class Song {
                                    public final long id = 0L;
                                    public String name = "";
                                    public String artist = "";
                                    public String songwriters = "";
                                    public int releaseYear = 0;
                                }

                                /**
                                 * Webservice-Stub f√ºr die Song Collection
                                 */
                                public class SongCollection {
                                    public static final URL = "https://localhost:8080/REST_Server_Beispiel/api/Songs/";

                                    public String url = URL;
                                    public String username = "";
                                    public String password = "";

                                    // Konstruktoren
                                    public SongCollection() {
                                    }

                                    public SongCollection(String url) {
                                        this.url = url;
                                    }

                                    // Benutzername und Passwort setzen
                                    public setAuthData(String username, String password) {
                                        this.username = username;
                                        this.password = password;
                                    }

                                    // Hilfsklasse f√ºr die Antwortdaten des Webservices
                                    public class Response {
                                        public Song song;
                                        public List&lt;Song&gt; songs;
                                        public String status;
                                        public String exception;
                                        public String message;
                                    }

                                    // Methoden des Webservices
                                    public Response findSongs(String query) {
                                        // Anfrage an den Server senden
                                        HttpResponse&lt;String&gt; httpResponse = Unirest.get(this.url)
                                                .queryString("query", query)
                                                .header("accept", "application/json")
                                                .asString();

                                        // Antwort als Response-Objekt zur√ºckgeben
                                        return this.gson.fromJson(httpResponse.getBody(), Response.class);
                                    }

                                    public Response saveNewSong(Song song) {
                                        // Anfrage an den Server senden
                                        HttpResponse&lt;String&gt; httpResponse = Unirest.post(this.url)
                                                .header("accept", "application/json")
                                                .header("content-type", "application/json")
                                                .basicAuth(this.username, this.password)
                                                .body(this.gson.toJson(song))
                                                .asString();

                                        // Antwort als Response-Objekt zur√ºckgeben
                                        return this.gson.fromJson(httpResponse.getBody(), Response.class);
                                    }
                                }

                                /**
                                 * Webservice-Stub f√ºr die Song Ressource
                                 */
                                public class SongResource {
                                    public static final URL = "https://localhost:8080/REST_Server_Beispiel/api/Songs/";

                                    public String url = URL;
                                    public String username = "";
                                    public String password = "";

                                    // Konstruktoren
                                    public SongResource() {
                                    }

                                    public SongResource(String url) {
                                        this.url = url;
                                    }

                                    // Benutzername und Passwort setzen
                                    public setAuthData(String username, String password) {
                                        this.username = username;
                                        this.password = password;
                                    }

                                    // Hilfsklasse f√ºr die Antwortdaten des Webservices
                                    public class Response {
                                        public Song song;
                                        public String status;
                                        public String exception;
                                        public String message;
                                    }

                                    // Methoden des Webservices
                                    public Response getSong(long id) throws UnirestException {
                                        // Anfrage an den Server senden
                                        HttpResponse&lt;String&gt; httpResponse = Unirest.get(this.url + id + "/")
                                                .header("accept", "application/json")
                                                .asString();

                                        // Antwort als Response-Objekt zur√ºckgeben
                                        return this.gson.fromJson(httpResponse.getBody(), Response.class);
                                    }

                                    public Response updateSong(Song song) throws UnirestException {
                                        // Anfrage an den Server senden
                                        HttpResponse&lt;String&gt; httpResponse = Unirest.post(this.url + song.id + "/")
                                                .header("accept", "application/json")
                                                .header("content-type", "application/json")
                                                .basicAuth(this.username, this.password)
                                                .body(this.gson.toJson(song))
                                                .asString();

                                        // Antwort als Response-Objekt zur√ºckgeben
                                        return this.gson.fromJson(httpResponse.getBody(), Response.class);
                                    }

                                    public Response deleteSong(long id) throws UnirestException {
                                        // Anfrage an den Server senden
                                        HttpResponse&lt;String&gt; httpResponse = Unirest.delete(this.url + id + "/")
                                                .header("accept", "application/json")
                                                .basicAuth(this.username, this.password)
                                                .asString();

                                        // Antwort als Response-Objekt zur√ºckgeben
                                        return this.gson.fromJson(httpResponse.getBody(), Response.class);
                                    }
                                 }
                            </source-code>
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    Im Grunde genommen ist der Aufruf eines REST-Webservices mit Java nicht wirklich schwer. Nur leider k√∂nnen
                    wir uns hierf√ºr keinen fertigen Code generieren lassen, so dass wir das meiste selbst programmieren m√ºssen.
                    Und da Java auch noch ein ziemlich strenges Typsystem hat (kein Objekt ohne Klasse), f√§llt der Code im ersten
                    Augenblick etwas umfangreicher als zum Beispiel in Python oder JavaScript aus. Es ist aber trotzdem machbar
                    und wir zeigen dir hier, wie du mit einer einfachen Vorgehensweise zu einem guten Ergebnis kommst. üíÆ
                </p>
                <p>
                    Sucht man im Internet nach REST-Aufrufen mit Java, kommen dabei lauter Beispiele zur offiziellen JAX-RS-API
                    zu Tage. Diese haben aber ein paar schwerwiegende Nachteile, weshalb wir sie hier <b>nicht</b> verwenden werden:
                </p>
                <ul>
                    <li>
                        Die API geh√∂rt nicht zu Java SE, so dass eine gro√üe Anzahl externer Pakete in das Projekt eingebunden
                        werden muss, wenn man eine normale Desktopanwendung oder Android App schreiben will.
                    </li>
                    <li>
                        Die Authentifizierung am Server ist auch hier kein Bestandteil des Standards, so dass man selbst auf
                        clientseite Code schreiben muss, der nur mit einer speziellen JAX-RS-Implementierung funktioniert. üò±
                    </li>
                    <li>
                        Die API ist in vielen Punkten umst√§ndlicher, als sie es eigentlich sein m√ºsste.
                    </li>
                </ul>
                <p>
                    Wir tun uns das daher gar nicht erst an und verwenden stattdessen viel lieber eine Kombination aus
                    <a href="https://github.com/google/gson" target="_blank">Google Gson</a> und
                    <a href="http://unirest.io/java.html" target="_blank">Unirest for Java</a>, die dasselbe nur viel einfacher machen. ü¶ã
                    Um sie einzubinden, m√ºssen wir das Projekt wieder als Maven-Projekt anlegen und in die <code>pom.xml</code>
                    folgende Zeilen einf√ºgen:
                </p>
                <source-code language="xml">
                    &lt;dependencies&gt;
                        ‚Ä¶ Eventuell bereits vorhandene Abh√§ngigkeiten ‚Ä¶

                        &lt;!-- Google GSON --&gt;
                        &lt;dependency&gt;
                            &lt;groupId>com.google.code.gson&lt;/groupId&gt;
                            &lt;artifactId>gson&lt;/artifactId&gt;
                            &lt;version>2.8.2&lt;/version&gt;
                        &lt;/dependency&gt;

                        &lt;!-- Unirest for Java --&gt;
                        &lt;dependency&gt;
                            &lt;groupId&gt;com.mashape.unirest&lt;/groupId&gt;
                            &lt;artifactId&gt;unirest-java&lt;/artifactId&gt;
                            &lt;version&gt;1.4.9&lt;/version&gt;
                        &lt;/dependency&gt;
                    &lt;/dependencies&gt;
                </source-code>

                <h2>Datentransferklassen</h2>
                <p>
                    Arbeitet man auf dem Server viel mit Persistence Entities, liegt es nat√ºrlich nahe, einzelne Entity-Objekte
                    als Methodenparameter oder R√ºckgabewert zu benutzen. Die auf diese Weise ausgetauschte JSON-Repr√§sentation
                    der Entities kann der Client dann entweder als einfachen String betrachten oder mit einer speziellen
                    JSON-Klassenbibliothek bearbeiten. Beides ist aber ziemlich umst√§ndlich und f√ºhrt nicht gerade zu gutem Code.
                    Besser ist es deshalb, die Entityklassen auf dem Client so nachzubauen, dass sie in eine identische JSON-Darstellung
                    (de)serialisiert werden k√∂nnen. Hierf√ºr m√ºssen sie nur dieselben Felder wie die Entities auf dem Server besitzen,
                    jedoch ohne Getter und Setter, da die Attribute hier einfach <code>public</code> sein k√∂nnen:
                </p>
                <source-code language="java">
                    public class Song {
                        public final long id = 0L;
                        public String name = "";
                        public String artist = "";
                        public String songwriters = "";
                        public int releaseYear = 0;
                    }
                </source-code>

                <h2>Webservice-Klassen</h2>
                <p>
                    Der nun folgende Schritt ist eigentlich optional, erh√∂ht aber ungemein die √úbersicht. Anstatt einfach
                    an beliebigen Stellen unseres Programms HTTP-Anfragen an den Server zu schicken, kapseln wir sie alle
                    in einer eigenen Klasse. Von der Struktur k√∂nnen wir uns dabei 1:1 am Server orientieren:
                </p>
                <source-code language="java">
                    public class SongCollection { ‚Ä¶ }
                    public class SongResource { ‚Ä¶ }
                </source-code>
                <p>
                    Das Ziel ist es dabei, die clientseitigen Methoden genau gleich wie auf dem Server zu nennen. Zus√§tzlich brauchen
                    wir dann nur noch ein paar Helferlein, um die URL √ºberschreiben zu k√∂nnen oder die Anmeldedaten zu √ºbergeben.
                    Ziel ist es, dass ein fertiger Webservice-Aufruf hinterher einfach nur so aussieht:
                </p>
                <source-code language="java">
                    SongCollection songCollection = new SongCollection();
                    songCollecion.setAuthData("username", "password");
                    SongCollection.Response response = songCollection.findSongs("Dire Straits");

                    if (response.code.equals("OK")) {
                        for (Song song : response.songs) {
                            // Empfangene Daten anzeigen
                            ‚Ä¶
                        }
                    }
                </source-code>
                <p>
                    Hierf√ºr ben√∂tigen wir folgendes Grundger√ºst f√ºr die <code>SongCollection</code>. Die Klasse <code>SongResource</code>
                    ist nat√ºrlich √§hnlich aufgebaut.
                </p>
                <source-code language="java">
                    public class SongCollection {
                        public static final URL = "https://‚Ä¶";

                        public String url = URL;
                        public String username = "";
                        public String password = "";

                        // Konstruktoren
                        public SongCollection() {
                        }

                        public SongCollection(String url) {
                            this.url = url;
                        }

                        // Benutzername und Passwort setzen
                        public setAuthData(String username, String password) {
                            this.username = username;
                            this.password = password;
                        }

                        // Hilfsklasse f√ºr die Antwortdaten des Webservices
                        public class Response {
                            public Song song;
                            public List&lt;Song&gt; songs;
                            public String status;
                            public String exception;
                            public String message;
                        }

                        // Methoden des Webservices
                        public Response findSongs(String query) { ‚Ä¶ }
                        public Response saveNewSong(Song song) { ‚Ä¶ }
                    }
                </source-code>
                <p>
                    Das ist leider etwas viel Tipparbeit. Aber wie gesagt erhalten wir dadurch eine gute Struktur, die hinterher leicht zu benutzen ist.
                    Fehlt dann nur noch die Implementierung der vorgegebenen Methoden, um HTTP-Anfragen an den Server zu schicken. Diese sieht eigentlich
                    immer √§hnlich aus, so wie hier am Beispiel von <code>saveNewSong()</code>:
                </p>
                <source-code language="java">
                    public Response saveNewSong(Song song) throws UnirestException {
                        HttpResponse&lt;String&gt; httpResponse = Unirest.post(this.url)
                                .header("accept", "application/json")
                                .header("content-type", "application/json")
                                .basicAuth(this.username, this.password)
                                .body(this.gson.toJson(song))
                                .asString();

                        return this.gson.fromJson(httpResponse.getBody(), Response.class);
                    }
                </source-code>
                <p>
                    Das ist auch der Code, der mit reinem JAX-RS viel umst√§ndlicher w√§re. üëπ Mit Unirest und Gson ist er aber ganz easy, sogar so sehr,
                    dass man ihn direkt irgendwo ein sein Programm einbauen k√∂nnte, wenn man sich den Stress mit dem Schreiben einer ganzen Klasse
                    nicht machen wollte. Das sollte man dann aber nur in kleinen Testprogr√§mmchen so machen. ü§´
                </p>
            </aside>
        </section>
        <section data-background-color="rgb(231, 221, 141)">
            <h1>Aufgabe 3: ùÑû 4/4 Half-Bar REST ‚ô´</h1>
            <article>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "aufgabe3-aufgabe-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#aufgabe3-aufgabe"
                                role          = "tab"
                                aria-controls = "aufgabe3-aufgabe"
                                aria-expanded = "true"
                            >
                                Aufgabe
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "aufgabe3-loesung-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#aufgabe3-loesung"
                                role          = "tab"
                                aria-controls = "aufgabe3-loesung"
                            >
                                L√∂sung
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- Aufgabe -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "aufgabe3-aufgabe"
                            role            = "tabpanel"
                            aria-labelledby = "aufgabe3-aufgabe-tab"
                        >
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-md">
                                        <p>
                                            Dann wollen wir doch gleich mal Hand anlegen ü§öüèΩ und den in Moodle hinterlegten Beispiel-Webservice erweitern.
                                            Und zwar (um bei der Musik zu bleiben) um eine neue Ressourcenart f√ºr Songtexte. Diese muss zun√§chst
                                            als Entity und EJB hinzugef√ºgt und anschlie√üend √ºber einen REST-Webservice aufrufbar gemacht werden. üéôÔ∏è
                                        </p>
                                        <p>
                                            a) √ñffne das Projekt in Netbeans und erweitere es um eine neue Entity zur Verwaltung von Songtexten:
                                        </p>
                                        <ul>
                                            <li>
                                                Id (Schl√ºsselfeld, automatisch hochgez√§hlt)
                                            </li>
                                            <li>
                                                Song (Fremdschl√ºssel)
                                            </li>
                                            <li>
                                                Songtext
                                            </li>
                                        </ul>
                                        <p>
                                            b) Programmiere eine dazu passende EJB auf Grundalge der
                                            <a href="../../2-javaee/jpa/#19" target="_blank"><code>EntityBean</code> aus den JPA-Folien</a>.
                                        </p>
                                        <p>
                                            c) Erweitere den Webservice um eine Collection und eine Ressource f√ºr den Zugriff auf Songtexte.
                                        </p>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md">
                                        <img src="soapui-01.png" alt="" class="d-block img-thumbnail" style="width: 100%; background-color: rgb(72, 116, 140);" />
                                    </div>
                                    <div class="col-md">
                                        <img src="aufgabe1-soapui.png" alt="" class="d-block img-thumbnail" style="width: 100%; background-color: rgb(72, 116, 140);" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- L√∂sung -->
                        <div
                            class           = "tab-pane fade"
                            id              = "aufgabe3-loesung"
                            role            = "tabpanel"
                            aria-labelledby = "aufgabe3-loesung-tab"
                        >
                            <h2>Persistence Entity</h2>
                            <source-code language="java">
                                @Entity
                                public class Songtext {
                                    @Id
                                    @generatedValue
                                    private long id;

                                    @ManyToOne
                                    private Song song;

                                    @Lob
                                    private String songtext = "";

                                    // Konstruktoren ‚Ä¶

                                    // Setter und Getter ‚Ä¶
                                }
                            </source-code>

                            <h2>Enterprise Java Bean</h2>
                            <source-code language="java">
                                @Stateless
                                public class SongtextBean extends EntityBean&lt;Songtext, Long&gt; {
                                    SongtextBean() {
                                        super(Songtext.class);
                                    }
                                }
                            </source-code>

                            <h2>Webservice-Konfiguration</h2>
                            <source-code language="java">
                                @ApplicationPath("api")
                                public class MusicalRestAPI extends Application {

                                    @Override
                                    public Set&lt;Class&lt;?&gt;&gt; getClasses() {
                                        Set&lt;Class&lt;?&gt;&gt; resources = new HashSet&lt;&gt;();

                                        // Bereits zuvor enthaltene Klassen
                                        resources.add(SignUpUser.class);
                                        resources.add(CreateDemoData.class);
                                        resources.add(SongCollection.class);
                                        resources.add(SongResource.class);

                                        // F√ºr diese Aufgabe hinzugef√ºgte Klassen
                                        resources.add(SongtextCollection.class);
                                        resources.add(SongtextResource.class);

                                        return resources;
                                    }

                                }
                            </source-code>

                            <h2>Songtext Collection</h2>
                            <source-code language="java">
                                @Stateless
                                @Path("Songtexts")
                                public class SongtextCollection {

                                    @EJB
                                    SongtextBean songtextBean;

                                    Gson gson = new GsonBuilder().create();

                                    public class Response {

                                        public Songtext songtext;
                                        public List&lt;Songtext&gt; songtexts;
                                        public String status;
                                        public String exception;
                                        public String message;
                                    }

                                    @GET
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public String findSongtexts() {
                                        Response response = new Response();

                                        try {
                                            response.songtexts = this.songtextBean.findAll();
                                            response.status = "OK";
                                        } catch (Exception ex) {
                                            response.status = "ERROR";
                                            response.exception = ex.getClass().getName();
                                            response.message = ex.getMessage();
                                        }

                                        return this.gson.toJson(response);
                                    }

                                    @POST
                                    @Consumes(MediaType.APPLICATION_JSON)
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public String saveNewSongtext(String json) {
                                        Response response = new Response();

                                        try {
                                            Songtext songtext = this.gson.fromJson(json, Songtext.class);
                                            response.songtext = this.songtextBean.saveNew(songtext);
                                            response.status = "OK";
                                        } catch (Exception ex) {
                                            response.status = "ERROR";
                                            response.exception = ex.getClass().getName();
                                            response.message = ex.getMessage();
                                        }

                                        return this.gson.toJson(response);
                                    }
                                }
                            </source-code>

                            <h2>Songtext Resource</h2>
                            <source-code language="java">
                                @Stateless
                                @Path("Songtexts/{id}")
                                public class SongtextResource {

                                    @EJB
                                    SongtextBean songtextBean;

                                    Gson gson = new GsonBuilder().create();

                                    public class Response {

                                        public Songtext songtext;
                                        public String status;
                                        public String exception;
                                        public String message;
                                    }

                                    @GET
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public String getSongtext(@PathParam("id") long id) {
                                        Response response = new Response();

                                        try {
                                            response.songtext = this.songtextBean.findById(id);
                                            response.status = "OK";
                                        } catch (Exception ex) {
                                            response.status = "ERROR";
                                            response.exception = ex.getClass().getName();
                                            response.message = ex.getMessage();
                                        }

                                        return this.gson.toJson(response);
                                    }

                                    @PUT
                                    @Consumes(MediaType.APPLICATION_JSON)
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public String updateSong(String json) {
                                        Response response = new Response();

                                        try {
                                            Songtext songtext = this.gson.fromJson(json, Songtext.class);
                                            response.songtext = this.songtextBean.update(songtext);
                                            response.status = "OK";
                                        } catch (Exception ex) {
                                            response.status = "ERROR";
                                            response.exception = ex.getClass().getName();
                                            response.message = ex.getMessage();
                                        }

                                        return this.gson.toJson(response);
                                    }

                                    @DELETE
                                    @Produces(MediaType.APPLICATION_JSON)
                                    public String deleteSong(@PathParam("id") long id) {
                                        Response response = new Response();

                                        try {
                                            response.songtext = this.songtextBean.findById(id);

                                            if (response.song != null) {
                                                this.songtextBean.delete(response.songtext);
                                            }

                                            response.status = "OK";
                                        } catch (Exception ex) {
                                            response.status = "ERROR";
                                            response.exception = ex.getClass().getName();
                                            response.message = ex.getMessage();
                                        }

                                        return this.gson.toJson(response);
                                    }
                                }
                            </source-code>
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    Yeah, REST rockt! Um das Erfolgserlebnis noch zu steigern kannst du hier einen eigenen
                    kleinen REST-Webservice programmieren und mit Netbeans zum Laufen bringen. üï∫ Du wirst
                    sehen, es ist nicht wirklich schwerer als mit SOAP.
                </p>
                <img src="../../github_atom.png" class="img-fluid d-block"/>
                <p>
                    <small>
                        Bildnachweis:
                        <a href="https://atom.io/" target="_blank">Atom Webseite</a>
                    </small>
                </p>
            </aside>
        </section>

        <section data-background-color="rgb(231, 221, 141)">
            <h1>Aufgabe 4: Ein kleines JAX-RS-Quiz</h1>
            <article>
                <h2>Aufgabe 4.1: Eigene REST-Webservices entwickeln</h2>

                <p>
                    a) Welche Aufgaben hat die <code>Application</code>-Klasse von JAX-RS?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Keine, so eine Klasse gibt es nur bei SOAP-Webservices.
                    </li>
                    <li>
                        Sie definiert den URL-Prefix eines REST-Webservices.
                    </li>
                    <li>
                        Die definiert die Zugriffsberechtigungen des Webservices.
                    </li>
                    <li>
                        Sie verweist auf die eigentlichen Webservice-Klassen.
                    </li>
                </ol>

                <p>
                    b) An welchen Stellen kann die Annotation <code>@Path</code> stehen?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Vor einer Webservice-Klasse
                    </li>
                    <li>
                        Vor einem Klassenattribut
                    </li>
                    <li>
                        Vor einer Methode
                    </li>
                    <li>
                        Vor einem Methodenparameter
                    </li>
                </ol>

                <p>
                    c) Welche Aufgabe hat die Annotation <code>@Consumes</code>?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Sie definiert das Datenformat der von einer Methode zur√ºckgelieferten Daten.
                    </li>
                    <li>
                        Sie definiert das Datenformat der an eine Methode √ºbergebbaren Daten.
                    </li>
                    <li>
                        Sie definiert das Datenformat einer lokalen Variable.
                    </li>
                    <li>
                        Sie definiert ein einheitliches Datenformat f√ºr den gesamten Webservice.
                    </li>
                </ol>

                <p>
                    d) Welche Aufgabe hat die Annotation <code>@Produces</code>?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Sie definiert das Datenformat der von einer Methode zur√ºckgelieferten Daten.
                    </li>
                    <li>
                        Sie definiert das Datenformat der an eine Methode √ºbergebbaren Daten.
                    </li>
                    <li>
                        Sie definiert das Datenformat einer lokalen Variable.
                    </li>
                    <li>
                        Sie definiert ein einheitliches Datenformat f√ºr den gesamten Webservice.
                    </li>
                </ol>

                <p>
                    e) Wie kann eine Methode sowohl Nutzdaten als auch Fehlermeldungen an den Client senden?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Durch R√ºckgabe eines JSON-Strings oder Werfen einer Exception
                    </li>
                    <li>
                        Durch R√ºckgabe eines JSON-Strings oder eines Exception-Objekts
                    </li>
                    <li>
                        Durch Verpacken der Nutzdaten und der Fehlermeldung in einem Datentransforobjekt
                    </li>
                    <li>
                        Durch R√ºckgabe von <code>null</code> bei einem Fehler
                    </li>
                </ol>

                <h2>Aufgabe 4.2: Fremde REST-Webservices aufrufen</h2>

                <p>
                    a) Warum ist die Entwicklung eines REST-Clients aufw√§ndiger als bei SOAP?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Weil man alle Klassen von Hand ausprogrammieren muss.
                    </li>
                    <li>
                        Weil die WADL-Beschreibung keine Beschreibung der JSON-Strukturen beinhaltet.
                    </li>
                    <li>
                        Weil nicht alle REST-Webservices eine WSDL-Beschreibung besitzen.
                    </li>
                </ol>

                <p>
                    b) Wof√ºr werden Gson und Unirest for Java bei der Entwicklung ben√∂tigt?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Gson wird zum Senden der HTTP-Anfrage und Unirest f√ºr die JSON-(De)Serialisierung genutzt.
                    </li>
                    <li>
                        Gson wird zur Authentifizierung am Server und Unirest f√ºr die Autorisierung genutzt.
                    </li>
                    <li>
                        Gson wird f√ºr die JSON-(De)Serialisierung und Unirest zum Senden der HTTP-Anfragen genutzt.
                    </li>
                    <li>
                        Gson wird zum Importieren der WADL-Beschreibung genutzt und Unirest f√ºr WSDLs.
                    </li>
                </ol>

                <p>
                    c) Warum m√ºssen clientseitig eigene Datentransferklassen f√ºr den Webservice-Aufruf programmiert werden?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Weil damit eine besonders einfache Umwandlung von Java nach JSON und zur√ºck m√∂glich ist.
                    </li>
                    <li>
                        Weil die Entity-Klassen aufgrund ihrer Annotationen nicht per JSON an den Client √ºbertragen werden k√∂nnen.
                    </li>
                    <li>
                        Weil sich der Webservice sonst nicht aufrufen l√§sst, wenn er anstelle eines Strings ein Objekt erwartet.
                    </li>
                    <li>
                        Weil nur so strukturierte Antwortdaten an den Client gesendet werden k√∂nnen.
                    </li>
                </ol>

                <p>
                    d) Warum sollten alle Webservice-Aufrufe in einer eigenen Klasse gekappselt werden.
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        Weil somit viele kleine Anfragen zu einer gro√üen Anfrage zusammengefasst werden k√∂nnnen.
                    </li>
                    <li>
                        Weil sich manche Webservice-Methoden sonst gar nicht ausf√ºhren lassen.
                    </li>
                    <li>
                        Weil dadurch der Quellcode der Serveranwendung wesentlich √ºbersichtlicher wird.
                    </li>
                    <li>
                        Weil dadurch der Quellcode der Clientanwendung wesentlich √ºbersichtlicher wird.
                    </li>
                </ol>

                <p>
                    e) Mit welchem Header Field signalisiert der Client, welches Datenformat er abrufen m√∂chte?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        <code>Content-Type</code>
                    </li>
                    <li>
                        <code>Accept</code>
                    </li>
                    <li>
                        <code>Accept-Content</code>
                    </li>
                    <li>
                        <code>Media-Type</code>
                    </li>
                </ol>

                <p>
                    f) Mit welchem Header Field geben Client und Server an, welches Datenformat sie √ºbertragen werden?
                </p>
                <ol class="dhbw-liste-mit-viel-text">
                    <li>
                        <code>Content-Type</code>
                    </li>
                    <li>
                        <code>Mime-Type</code>
                    </li>
                    <li>
                        <code>Media-Type</code>
                    </li>
                    <li>
                        <code>Data-Type</code>
                    </li>
                </ol>

                <hr />

                <p style="width: 100%; transform: scaleY(-1) scaleX(-1); display: inline-block;">
                    <small>
                        <b>L√∂sung:</b> Aufgabe 4.1: 2 + 4, 1 + 3, 2, 1, 3<br />
                        Aufgabe 4.2: 1, 3, 1, 4, 2, 1
                    </small>
                </p>
            </article>
            <aside>
                <p>
                    Und damit sind wir auch schon am Ende unseres kleinen Kapitels angelangt.
                    Wir hoffen, es hat dir gefallen und du kannst alle Fragen auf dieser Seite
                    richtig beantworten. üçæ
                </p>
            </aside>
        </section>

        <!--
            =======
            EXKURSE
            =======
        -->
        <section data-chapter data-background-image="../../trennfolie.jpg">
            <h1>Exkurse</h1>
            <article>
                <small>
                    <small>
                        Bildnachweis:
                        <a href="https://pixabay.com/en/adult-break-business-caucasian-2398561/" target="_blank">Pixabay: rawpixel</a>
                    </small>
                </small>
            </article>
        </section>

        <section>
            <h1>Absicherung der Webservice-Zugriffe</h1>
            <article>
                <table style="margin-bottom: 1em;">
                    <tr>
                        <td style="padding-right: 0.5em">
                            üî•
                        </td>
                        <td>
                            REST-Webservices lassen sich mit Java viel einfacher absichern als SOAP-Webservices.
                        </td>
                    </tr>
                    <tr>
                        <td style="padding-right: 0.5em">
                            üî•
                        </td>
                        <td>
                            Wir m√ºssen lediglich die Datei <tt>WEB-INF\web.xml</tt> und die Serverkonfiguration anpassen.
                        </td>
                    </tr>
                </table>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "auth-entity-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#auth-entity"
                                role          = "tab"
                                aria-controls = "auth-entity"
                            >
                                User-Entity
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "auth-webxml-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#auth-webxml"
                                role          = "tab"
                                aria-controls = "auth-webxml"
                            >
                                web.xml
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "auth-tomee-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#auth-tomee"
                                role          = "tab"
                                aria-controls = "auth-tomee"
                            >
                                Konfiguration f√ºr TomEE
                            </a>
                        </li>
                        <!-- <li class="nav-item">
                            <a
                                id            = "auth-glassfish-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#auth-glassfish"
                                role          = "tab"
                                aria-controls = "auth-glassfish"
                            >
                                Konfiguration f√ºr GlassFish
                            </a>
                        </li> -->
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- User-Entity -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "auth-entity"
                            role            = "tabpanel"
                            aria-labelledby = "auth-entity-tab"
                        >
                            <p>
                                Zun√§chst ben√∂tigen wir eine Entity, um Benutzer in der Datenbank speichern zu k√∂nnen.
                                Sie entspricht im Wesentlichen dem Beispiel, das wir auch schon in den EJB-Aufgaben
                                gesehen haben.
                            </p>
                            <source-code language="java">
                                /**
                                 * Datenbankklasse f√ºr einen Benutzer. Dies ist eine Variation der User-Klasse
                                 * von jTodo.
                                 */
                                @Entity
                                @Table(name = "REST_USER")
                                public class User implements Serializable {

                                    @Id
                                    @Column(name = "USERNAME", length = 64)
                                    private String username;

                                    @Column(name = "PASSWORD_HASH", length = 64)
                                    private String passwordHash;

                                    @ElementCollectionauth-realm
                                    @CollectionTable(
                                            name = "REST_USER_GROUP",
                                            joinColumns = @JoinColumn(name = "USERNAME")
                                    )
                                    @Column(name = "GROUPNAME")
                                    List&lt;String&gt; groups = new ArrayList&lt;&gt;();

                                    // Konstruktoren ‚Ä¶

                                    // Setter und Getter ‚Ä¶

                                    // Methoden zum Hashen des Passworts ‚Ä¶

                                    // Methoden f√ºr die Zuordnung zu Benutzergruppen ‚Ä¶
                                }

                                /**
                                 * Spezielle EJB zum Anlegen eines Benutzers. Dies ist im Prinzip dieselbe EJB
                                 * wie im jTodo-Beispiel.
                                 */
                                @Stateless
                                public class UserBean {

                                    @PersistenceContext
                                    EntityManager em;

                                    /**
                                     * Registrieren eines neuen Benutzers.
                                     */
                                    public void signup(String username, String password, String... groups)
                                            throws UserAlreadyExistsException {

                                        if (em.find(User.class, username) != null) {
                                            throw new UserAlreadyExistsException("Der Benutzername $B ist bereits vergeben.".replace("$B", username));
                                        }

                                        User user = new User(username, password);

                                        for (String group : groups) {
                                            user.addToGroup(group);
                                        }

                                        em.persist(user);
                                    }

                                    /**
                                     * Fehler: Der Benutzername ist bereits vergeben.
                                     */
                                    public class UserAlreadyExistsException extends Exception {

                                        public UserAlreadyExistsException(String message) {
                                            super(message);
                                        }
                                    }
                                }
                            </source-code>
                        </div>
                        <!-- web.xml -->
                        <div
                            class           = "tab-pane fade show"
                            id              = "auth-webxml"
                            role            = "tabpanel"
                            aria-labelledby = "auth-webxml-tab"
                        >
                            <p>
                                Die eigentliche Absicherung erfolgt dann √ºber die Datei <tt>WEB-INF\web.xml</tt>. Hier legen wir fest,
                                wie sich ein Anwender authentifizieren kann und welche Rollen er haben muss, um bestimmte HTTP-Verben
                                an bestimmte URLs senden zu d√ºrfen.
                            </p>
                            <p>
                                <b>
                                    Vorsicht! Java ist hier zickig mit der Reihenfolge! ü¶Ñ
                                </b>
                            </p>
                            <source-code language="xml">
                                &lt;web-app&gt;
                                    &lt;security-constraint&gt;
                                        &lt;!-- √Ñndernde Zugriffe auf Songs --&gt;
                                        &lt;web-resource-collection&gt;
                                            &lt;web-resource-name&gt;Songs&lt;/web-resource-name&gt;
                                            &lt;url-pattern&gt;/api/Songs/*&lt;/url-pattern&gt;

                                            &lt;http-method&gt;PUT&lt;/http-method&gt;
                                            &lt;http-method&gt;POST&lt;/http-method&gt;
                                            &lt;http-method&gt;PATCH&lt;/http-method&gt;
                                            &lt;http-method&gt;DELETE&lt;/http-method&gt;
                                        &lt;/web-resource-collection&gt;

                                        &lt;!-- Ben√∂tigte Rolle --&gt;
                                        &lt;auth-constraint&gt;
                                            &lt;role-name&gt;rest-beispiel-user&lt;/role-name&gt;
                                        &lt;/auth-constraint&gt;

                                        &lt;!-- Zugriff nur via HTTPS erlauben --&gt;
                                        &lt;user-data-constraint&gt;
                                            &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;
                                        &lt;/user-data-constraint&gt;
                                    &lt;/security-constraint&gt;

                                    &lt;!-- Definition, dass es die Rolle √ºberhaupt gibt --&gt;
                                    &lt;security-role&gt;auth-realm
                                        &lt;role-name&gt;rest-beispiel-user&lt;/role-name&gt;
                                    &lt;/security-role&gt;

                                    &lt;!-- Art der Authentifizierung --&gt;
                                    &lt;login-config&gt;
                                        &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
                                        &lt;realm-name&gt;rest-beispiel&lt;/realm-name&gt;
                                    &lt;/login-config&gt;
                                &lt;/web-app&gt;
                            </source-code>
                        </div>
                        <!-- Konfiguration f√ºr TomEE -->
                        <div
                            class           = "tab-pane fade show"
                            id              = "auth-tomee"
                            role            = "tabpanel"
                            aria-labelledby = "auth-tomee-tab"
                        >
                            <p>
                                Der TomEE-Server ben√∂tigt eine Datei namens <tt>context.xml</tt>, die im Verzeichnis
                                <tt>META-INF</tt> der Webanwendung angelegt werden muss (im Bereich <tt>Web Pages</tt>
                                in Netbeans). Diese Datei beinhaltet alle TomEE-spezifischen Einstellungen der App
                                und besitzt deshalb folgenden Inhalt:
                            </p>
                            <source-code language="xml">
                                &lt;?xml version="1.0" encoding="UTF-8"?&gt;
                                &lt;!-- Tomcat/TomEE-spezifische Konfiguration                            --&gt;
                                &lt;!-- Vgl. https://tomcat.apache.org/tomcat-9.0-doc/config/context.html --&gt;
                                &lt;Context path="/REST_Server_Beispiel" swallowOutput="true"&gt;
                                    &lt;!-- LockOutRealm: Sperrt den Benutzer nach zu vielen Fehlversuchen aus --&gt;
                                    &lt;Realm className="org.apache.catalina.realm.LockOutRealm"&gt;
                                        &lt;!-- Anwendungsspezifischer Auth-Mechanismus --&gt;
                                        &lt;Realm
                                            className      = "org.apache.catalina.realm.DataSourceRealm"

                                            dataSourceName = "Default-Database-Unmanaged"
                                            userTable      = "rest_server_beispiel.rest_user"
                                            userNameCol    = "username"
                                            userCredCol    = "password_hash"

                                            userRoleTable  = "rest_server_beispiel.rest_user_group"
                                            roleNameCol    = "groupname"
                                        &gt;
                                            &lt;CredentialHandler
                                                className = "org.apache.catalina.realm.MessageDigestCredentialHandler"
                                                algorithm = "SHA-256"
                                            /&gt;
                                        &lt;/Realm&gt;
                                    &lt;/Realm&gt;
                                &lt;/Context&gt;
                            </source-code>
                            <p>
                                Der Wert <code>Default-Database-Unmanaged</code> ist dabei der Namen einer
                                Datenbankverbindung, die in der Serverkonfiguration in der Datei <tt>conf/tomee.xml</tt>
                                (im Server selbst) definiert sein muss. Das haben wir in der Vorlesung bereits f√ºr
                                dich erledigt, indem wir hier folgenden Inhalt eingetragen haben:
                            </p>
                            <source-code language="xml">
                                &lt;?xml version="1.0" encoding="UTF-8"?&gt;
                                &lt;tomee&gt;
                                    &lt;!-- Datenbankverbindungen --&gt;
                                    &lt;Resource id="Default-Database-Managed" type="javax.sql.DataSource"&gt;
                                      JdbcDriver = org.apache.derby.jdbc.ClientDriver
                                      JdbcUrl    = jdbc:derby://localhost:1527/sample
                                      UserName   = app
                                      Password   = app
                                      JtaManaged = true
                                    &lt;/Resource&gt;

                                    &lt;Resource id="Default-Database-Unmanaged" type="javax.sql.DataSource"&gt;
                                      JdbcDriver = org.apache.derby.jdbc.ClientDriver
                                      JdbcUrl    = jdbc:derby://localhost:1527/sample
                                      UserName   = app
                                      Password   = app
                                      JtaManaged = false
                                    &lt;/Resource&gt;
                                &lt;/tomee&gt;
                            </source-code>
                        </div>
                        <!-- Konfiguration f√ºr GlassFish -->
                        <!-- <div
                            class           = "tab-pane fade"
                            id              = "auth-glassfish"
                            role            = "tabpanel"
                            aria-labelledby = "auth-glassfish-tab"
                        >
                            <p>
                                Der GlassFish-Server ben√∂tigt zun√§chst eine Datei namens <tt>glassfish-web.xml</tt>, die im
                                Verzeichnis <tt>WEB-INF</tt> der Webanwendung angelegt werden muss. Sie geh√∂rt nicht zu Java,
                                sondern zu GlassFish und ordnet jeder Rolle eine Benutzergruppe zu, die der Server dann
                                letztlich in der Datenbank sucht. Der Einfachheit halber benennen wir hier Rolle und
                                Benutzergruppe gleich, so dass die Datei folgenden Inhalt besitzt:
                            </p>
                            <source-code language="xml">
                                &lt;?xml version="1.0" encoding="UTF-8"?&gt;
                                &lt;!DOCTYPE glassfish-web-app PUBLIC
                                    "-//GlassFish.org//DTD GlassFish Application Server 3.1 Servlet 3.0//EN"
                                    "http://glassfish.org/dtds/glassfish-web-app_3_0-1.dtd"&gt;

                                &lt;glassfish-web-app error-url=""&gt;
                                    &lt;security-role-mapping&gt;
                                        &lt;role-name&gt;rest-beispiel-user&lt;/role-name&gt;
                                        &lt;group-name&gt;rest-beispiel-user&lt;/group-name&gt;
                                    &lt;/security-role-mapping&gt;

                                    &lt;parameter-encoding default-charset="UTF-8" /&gt;
                                &lt;/glassfish-web-app&gt;
                            </source-code>

                            <p>
                                Und damit der Server wirklich wei√ü, in welchen Tabellen die Benutzerdaten liegen, m√ºssen wir die
                                Adminkonsole aufrufen und dort ein neues ‚ÄûRealm‚Äù anlegen. Wie immer musst du hier besonders auf
                                Tippfehler achten. Der Name des Realm muss dem <src-code language="xml">&lt;realm-name&gt;</src-code>
                                aus der <tt>web.xml</tt> entsprechen.
                            </p>
                            <img src="auth-realm.png" alt="Realm-Konfiguration im Glassfish" class="d-block" style="width: 100%;" />
                        </div> -->
                    </div>
                </div>
            </article>
            <aside>
                <p>
                    In der Praxis ist es nat√ºrlich wichtig, einen REST-Webservices mit Berechtigungen abzusichern, damit nicht jeder
                    Anwender, wom√∂glich noch, ohne sich √ºberhaupt anzumelden, einfach beliebige Daten ver√§ndern kann. Hierf√ºr kennt
                    Java zwei M√∂glichkeiten, eine furchtbar komplizierte¬π mit <code>@RolesAllowed</code> und eine besonders einfache
                    √ºber die Datei <tt>WEB-INF\web.xml</tt>. Wir schauen uns hier nur die einfache Version an, da die andere viel zu
                    aufw√§ndig ist f√ºr das was sie bietet.
                </p>
                <p>
                    <small>
                        ¬π Da genau wie bei SOAP nicht vollst√§ndig zu Ende spezifiziert und somit serverabh√§ngig. Schlimmer noch,
                        man muss sogar serverabh√§ngigen Quellcode schreiben.
                    </small>
                    ü§¶üèª
                    <small>
                        Eine ausf√ºhrliche Anleitung dazu gibt es
                        <a href="https://simplapi.wordpress.com/2015/09/19/jersey-jax-rs-securitycontext-in-action/" target="_blank">hier</a>.
                    </small>
                </p>
                <p>
                    Davon ausgehend, dass wir die Benutzer einfach in einer Tabelle speichern wollen, ben√∂tigen wir wie gewohnt eine Entity-Klasse,
                    die mindestens den Benutzernamen, das gehashte Passwort sowie die zugeordneten Benutzergruppen speichert.
                </p>
                <source-code langauge="java">
                    @Entity
                    public class User {
                        @Id
                        @Column(name = "USERNAME", length = 64)
                        private String username;

                        @Column(name = "PASSWORD_HASH", length = 64)
                        private String passwordHash;

                        @ElementCollection
                        @CollectionTable(
                                name = "REST_USER_GROUP",
                                joinColumns = @JoinColumn(name = "USERNAME")
                        )
                        @Column(name = "GROUPNAME")
                        List<String> groups = new ArrayList&lt;&gt;();

                        ‚Ä¶
                    }
                </source-code>
                <p>
                    Zus√§tzlich ben√∂tigen wir nat√ºrlich auch eine dazu passende EJB.
                </p>
                <source-code language="java">
                    @Stateless
                    public class UserBean {
                        @PersistenceContext
                        EntityManager em;

                        public void signup(String username, String password, String... groups)
                                throws UserAlreadyExistsException {
                            ‚Ä¶
                        }
                    }
                </source-code>
                <p>
                    Damit sind schon alle Grundlagen gelegt. Jetzt m√ºssen wir nur noch festlegen, f√ºr welche Aufrufe der Benutzer sich
                    anmelden muss und welche Rollen er hierf√ºr ben√∂tigt.¬≤ Dies erfolgt in der Datei <tt>WEB-INF\web.xml</tt> anhand der
                    Webservice-URLs und der HTTP-Verben:
                </p>
                <source-code language="xml">
                    &lt;web-app&gt;
                        &lt;security-constraint&gt;
                            &lt;web-resource-collection&gt;
                                &lt;!-- Betroffen sind alle URLS /api/Songs/* --&gt;
                                &lt;web-resource-name&gt;Songs&lt;/web-resource-name&gt;
                                &lt;url-pattern&gt;/api/Songs/*&lt;/url-pattern&gt;

                                <&lt;!-- Aber nur bei diesen HTTP-Verben --&gt;
                                &lt;http-method&gt;PUT&lt;/http-method&gt;
                                &lt;http-method&gt;POST&lt;/http-method&gt;
                                &lt;http-method&gt;PATCH&lt;/http-method&gt;
                                &lt;http-method&gt;DELETE&lt;/http-method&gt;
                            &lt;/web-resource-collection&gt;

                            &lt;!-- Rolle, die der Benutzer haben muss --&gt;
                            &lt;auth-constraint&gt;
                                &lt;role-name&gt;rest-beispiel-user&lt;/role-name&gt;
                            &lt;/auth-constraint&gt;
                        &lt;/security-constraint&gt;

                        &lt;!-- Definition aller Rollen, die es geben kann --&gt;
                        &lt;security-role&gt;
                            &lt;role-name&gt;rest-beispiel-user&lt;/role-name&gt;
                        &lt;/security-role&gt;

                        &lt;!-- Die Anmeldung erfolgt per HTTP Basic Authentication --&gt;
                        &lt;login-config&gt;
                            &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
                            &lt;realm-name&gt;rest-beispiel&lt;/realm-name&gt;
                        &lt;/login-config&gt;
                    &lt;/web-app&gt;
                </source-code>
                <p>
                    <small>
                        ¬≤ Eine Rolle definiert, welche Berechtigungen ein bestimmter Anwender besitzt.
                        In den meisten Webframeworks handelt es sich dabei lediglich um einen String,
                        der mit dem Benutzerstammsatz verkn√ºpft und innerhalb der Anwendung gepr√ºft
                        wird. Zum Beispiel k√∂nnte eine Anwendung bestimmte Aktionen nur dann zulassen,
                        wenn der Anwender die Rolle ‚Äûadmin‚Äù besitzt. Oder sie k√∂nnte voraussetzen, dass
                        ein Anwender die Rolle ‚Äûapp-user‚Äù besitzen muss, um sich einloggen zu k√∂nnen,
                        aber dass nur Benutzer mit der zus√§tzlichen Rolle ‚Äûapp-maintainer‚Äù auch Daten
                        √§ndern d√ºrfen.
                    </small>
                </p>
                <p>
                    Wie es aber hier mit der Konfiguration weiter geht, h√§ngt vom verwendeten Applikationsserver ab.
                    Denn die Authentifizierung und Autorisierung von Benutzern wird vom Server und nicht von der
                    Anwendung gehandhabt. Aus diesem Grund muss im Server ein sog. ‚ÄûRealm‚Äù konfiguriert werden, das
                    definiert, wie die Benutzer und ihre Berechtigungen √ºberpr√ºft werden k√∂nnen. In der Vorlesung
                    hinterlegen wir hier die passenden Datenbanktabellen unserer Anwendung. Viele Unternehmen binden
                    stattdessen aber auch
                    <a href="https://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol" target="_blank">LDAP-Verzeichnisse</a>
                    oder ein <a href="https://en.wikipedia.org/wiki/Active_Directory" target="_blank">Active Directory</a>
                    an, damit sich die Benutzer in allen Anwendungen immer mit demselben Benutzernamen und Passwort
                    anmelden k√∂nnen.
                </p>
                <p>
                    Die Folie zeigt die Konfiguration f√ºr <a href="http://tomee.apache.org/" target="_blank">Apache TomEE</a>,
                    den wir auch in der Vorlesung benutzen. üñºÔ∏è Wenn alles gut l√§uft, sollte es danach nicht mehr m√∂glich sein,
                    √§ndernde Zugriffe auszuf√ºhren, ohne sich √ºber
                    <a href="https://de.wikipedia.org/wiki/HTTP-Authentifizierung#Basic_Authentication" target="_blank">HTTP Basic Authentication</a>
                    anzumelden.
                </p>
            </aside>
        </section>

        <section>
            <h1>AJAX-Aufrufe mit JavaScript</h1>
            <article>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a
                                id            = "rest-ablauf-tab"
                                class         = "nav-link active"
                                data-toggle   = "tab"
                                href          = "#rest-ablauf"
                                role          = "tab"
                                aria-controls = "rest-ablauf"
                                aria-expanded = "true"
                            >
                                Ablauf
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "rest-wsklasse-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#rest-wsklasse"
                                role          = "tab"
                                aria-controls = "rest-wsklasse"
                            >
                                Webservice-Klassen
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "rest-aufruf-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#rest-aufruf"
                                role          = "tab"
                                aria-controls = "rest-aufruf"
                                aria-expanded = "true"
                            >
                                Verwendung der Klassen
                            </a>
                        </li>
                        <li class="nav-item">
                            <a
                                id            = "rest-ergebnis-tab"
                                class         = "nav-link"
                                data-toggle   = "tab"
                                href          = "#rest-ergebnis"
                                role          = "tab"
                                aria-controls = "rest-ergebnis"
                            >
                                Ergebnis
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content border border-top-0 bg-white" style="padding: 1em;">
                        <!-- Ablauf -->
                        <div
                            class           = "tab-pane fade show active"
                            id              = "rest-ablauf"
                            role            = "tabpanel"
                            aria-labelledby = "rest-ablauf-tab"
                        >
                            <img src="webanwendung-clientseitig.png" class="d-block" style="width: 100%; margin-bottom: 1em;" />
                            <ul>
                                <li>
                                    <b class="dhbw-lightblue">Das Beste beider Welten:</b> Browser und Server beinhalten je einen Teil der Anwendungslogik.
                                </li>
                                <li>
                                    Der initiale HTML-Code kann vom Server generiert werden oder in einer einfachen HTML-Datei liegen.
                                </li>
                                <li>
                                    Zu einem sp√§teren Zeitpunkt werden dann die REST-Webservices des Servers aufgerufen.
                                </li>
                                <li>
                                    Die empfangenen Daten werden dabei durch geschickte DOM-Manipulation sichtbar gemacht.
                                </li>
                            </ul>
                            <p style="color: darkred">
                                Jetzt schauen wir uns das endlich mal an.
                            </p>
                        </div>
                        <!-- Webservice-Klassen -->
                        <div
                            class           = "tab-pane fade"
                            id              = "rest-wsklasse"
                            role            = "tabpanel"
                            aria-labelledby = "rest-wsklasse-tab"
                        >
                            <p>
                                Um die Verwendung des Webservices so einfach wie m√∂glich zu machen, solltest du f√ºr jede Webservice-Klasse auf dem
                                Server eine √§hnliche Klasse mit den gleichen Methoden in JavaScript anlegen. Innerhalb der Methoden kannst du dann
                                <src-code language="javascript">fetch(‚Ä¶)</src-code> bzw. die
                                <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" target="_blank">Fetch API</a>
                                 zum Absetzen der HTTP-Aufrufe verwenden.
                            </p>
                            <source-code language="javascript">
                                "use strict";

                                /**
                                 * Von der Klasse SongCollection des Servers abgeleitete Klasse, die im Prinzip
                                 * dieselben Methoden besitzt. Hier rufen wir jedoch den REST-Webservice des
                                 * Servers auf, anstelle direkt auf eine Datenbank zuzugreifen.
                                 */
                                class SongCollection {

                                    /**
                                     * Konstruktor.
                                     */
                                    constructor(url) {
                                        this.url = url || "http://localhost:8080/REST_Server_Beispiel/api/Songs/";
                                        this.username = "";
                                        this.password = "";
                                    }

                                    /**
                                     * Benutzername und Passwort f√ºr die Authentifizierung merken.
                                     */
                                    setAuthData(username, password) {
                                        this.username = username;
                                        this.password = password;
                                    }

                                    /**
                                     * Songs suchen.
                                     */
                                    async findSongs(query) {
                                        let url = this.url;

                                        if (query !== undefined) {
                                            url += "?query=" + encodeURI(query);
                                        }

                                        let response = await fetch(url, {
                                            headers: {
                                                "accept": "application/json"
                                            }
                                        });

                                        if (response.ok) {
                                            return await response.json();
                                        } else {
                                            return {};
                                        }
                                    }

                                    /**
                                     * Neuen Song speichern.
                                     */
                                    async saveNewSong(song) {
                                        let response = await fetch(this.url, {
                                            method: "POST",
                                            headers: {
                                                "accept": "application/json",
                                                "content-type": "application/json",
                                                "authorization": "Basic " + btoa(this.username + ":" + this.password)
                                            },
                                            body: JSON.stringify(song)
                                        });

                                        if (response.ok) {
                                            return await response.json();
                                        } else {
                                            return {};
                                        }
                                    }

                                }

                                /**
                                 * Von der Klasse SongResource des Servers abgeleitete Klasse, die im Prinzip
                                 * dieselben Methoden besitzt. Hier rufen wir jedoch den REST-Webservice des
                                 * Servers auf, anstelle direkt auf eine Datenbank zuzugreifen.
                                 */
                                class SongResource {

                                    /**
                                     * Konstruktor.
                                     */
                                    constructor(url) {
                                        this.url = url || "http://localhost:8080/REST_Server_Beispiel/api/Songs/";
                                        this.username = "";
                                        this.password = "";
                                    }

                                    /**
                                     * Benutzername und Passwort f√ºr die Authentifizierung merken.
                                     */
                                    setAuthData(username, password) {
                                        this.username = username;
                                        this.password = password;
                                    }

                                    /**
                                     * Einzelnen Song auslesen.
                                     */
                                    async getSong(id) {
                                        let response = await fetch(this.url + id + "/", {
                                            headers: {
                                                "accept": "application/json",
                                                "authorization": "Basic " + btoa(this.username + ":" + this.password)
                                            }
                                        });

                                        if (response.ok) {
                                            return await response.json();
                                        } else {
                                            return {};
                                        }
                                    }

                                    /**
                                     * Aktualisieren eines Songs.
                                     */
                                    async updateSong(song) {
                                        let response = await fetch(this.url + song.id + "/", {
                                            method: "POST",
                                            headers: {
                                                "accept": "application/json",
                                                "content-type": "application/json",
                                                "authorization": "Basic " + btoa(this.username + ":" + this.password)
                                            },
                                            body: JSON.stringify(song)
                                        });

                                        if (response.ok) {
                                            return await response.json();
                                        } else {
                                            return {};
                                        }
                                    }

                                    /**
                                     * Song l√∂schen.
                                     */
                                    async deleteSong(id) {
                                        let response = await fetch(this.url + id + "/", {
                                            method: "DELETE",
                                            headers: {
                                                "accept": "application/json",
                                                "authorization": "Basic " + btoa(this.username + ":" + this.password)
                                            }
                                        });

                                        if (response.ok) {
                                            return await response.json();
                                        } else {
                                            return {};
                                        }
                                    }
                                }
                            </source-code>
                        </div>
                        <!-- Verwendung der Klassen -->
                        <div
                            class           = "tab-pane fade"
                            id              = "rest-aufruf"
                            role            = "tabpanel"
                            aria-labelledby = "rest-aufruf-tab"
                        >
                            <p>
                                Ab diesem Moment ist der Aufruf des Webservices ein wahres Kinderspiel. ‚öΩ Durch die neuen Webservice-Klassen
                                m√ºssen nur noch die richtigen Methoden im richtigen Moment aufgerufen werden.
                            </p>
                            <source-code language="javascript">
                                &lt;!DOCTYPE html&gt;
                                &lt;html&gt;
                                    &lt;head&gt;
                                        &lt;meta charset="utf-8"&gt;

                                        &lt;script src="SongCollection.js"&gt;&lt;/script&gt;
                                        &lt;script src="SongResource.js"&gt;&lt;/script&gt;
                                        ‚Ä¶
                                    &lt;/head&gt;
                                    &lt;body&gt;
                                        &lt;!-- Platzhalter f√ºr die vorhandenen Songs --&gt;
                                        &lt;div id="songs"&gt;&lt;/div&gt;

                                        &lt;!-- Ab hier f√§ngt es an, Spa√ü zu machen ü§© --&gt;
                                        &lt;script&gt;
                                            songCollection = new SongCollection();
                                            songResource = new SongResource();

                                            //songCollection.setAuthData("username", "password");
                                            //songResource.setAuthData("username", "password");

                                            // Abruf und Anzeige aller Songs, nach Laden der Seite
                                            async function reloadSongs() {
                                                let response = await songCollection.findSongs("");

                                                if (response.status === "OK") {
                                                    let songsElement = document.getElementById("songs");
                                                    songsElement.innerHTML = "";

                                                    response.songs.forEach(song =&gt; {
                                                        // Empfangene Daten anzeigen
                                                        let songElement = document.createElement("div");
                                                        songElement.classList.add("song");
                                                        songsElement.appendChild(songElement);

                                                        songElement.innerHTML = `&lt;b&gt;${song.name}&lt;/b&gt; &lt;br/&gt;`
                                                                + `&lt;span class="label"&gt;K√ºnstler:&lt;/span&gt; ${song.artist} &lt;br/&gt;`
                                                                + `&lt;span class="label"&gt;Songwriter:&lt;/span&gt; ${song.songwriters} &lt;br/&gt;`
                                                                + `&lt;span class="label"&gt;Jahr:&lt;/span&gt; ${song.releaseYear} &lt;br/&gt;`;
                                                    });
                                                } else {
                                                    alert(response.message);
                                                }
                                            }

                                            window.addEventListener("load", () =&gt; reloadSongs());
                                        &lt;/script&gt;
                                    &lt;/body&gt;
                                &lt;/html&gt;
                            </source-code>
                        </div>
                        <!-- Ergebnis -->
                        <div
                            class           = "tab-pane fade"
                            id              = "rest-ergebnis"
                            role            = "tabpanel"
                            aria-labelledby = "rest-ergebnis-tab"
                        >
                            <p>
                                Und so sieht die fertige Anwendung aus. In der Netzwerkanalyse sieht man sch√∂n, wie die angezeigten Daten
                                zeitversetzt nachgeladen werden.
                            </p>
                            <img src="ajax-ergebnis.jpg" alt="Screenshot der fertigen Webanwendung" class="d-block" style="width: 100%;" />
                        </div>
                    </div>
                </div>
            </article>
            <aside>
                <div class="embed-responsive embed-responsive-16by9" style="margin-bottom: 1em">
                    <iframe src="https://www.youtube-nocookie.com/embed/Zp4L89oLrmE" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
                <p>
                    An dieser Stelle wird es dann mal Zeit f√ºr etwas Werbung. üì∫ Wir unterbrechen das laufende Programm und
                    kommen nochmal auf das <a href="../../2-javaee/ejb/#8" target="_blank">EJB-Kapitel</a>, bzw. einen Teil
                    daraus, zur√ºck: <b>Clientseitige Webanwendungen mit Backendserver</b>. Denn REST-Webservices haben eine
                    tolle Eigenschaft, weshalb sie auch so beliebt sind: Man kann sie ganz einfach mit JavaScript aus dem
                    Browser heraus aufrufen, üëç was auch
                    <a href="https://de.wikipedia.org/wiki/Ajax_(Programmierung)" target="_blank">AJAX</a> genannt wird.
                </p>
                <p>
                    Im Grunde genommen gibt es hierf√ºr zwei M√∂glichkeiten:
                    <a href="https://www.w3schools.com/xml/xml_http.asp" target="_blank">XMLHttpRequest</a> und die
                    <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" target="_blank">Fetch API</a>.
                    Auf <a href="https://www.heise.de/-2642427" target="_blank">Heise Online</a> gibt es einen leicht
                    verst√§ndlichen Vergleich zwischen beiden. Wir nutzen an dieser Stelle aber die Fetch API, da sie
                    moderner ist und einen saubereren Programmierstil beg√ºnstigt. üõÄ
                </p>

                <h2>Wie es sp√§ter aussehen soll</h2>
                <p>
                    Bevor wir gleich loslegen, wollen wir erst mal zeigen, wie das Endergebnis aussehen soll. Um den vorhin
                    gezeigten Musik-Webservice aufzurufen, wollen wir √§hnlich zu Java folgenden Quellcode schreiben:
                </p>
                <source-code language="javascript">
                    let songCollection = new SongCollection();
                    songCollecion.setAuthData("username", "password");
                    let response = await songCollection.findSongs("Dire Straits");

                    if (response.status === "OK") {
                        response.songs.forEach(song => {
                            // Empfangene Daten anzeigen
                            ‚Ä¶
                        });
                    }
                </source-code>
                <p>
                    Bis auf das Schl√ºsselwort <code>await</code> sollte dir das nicht ungew√∂hnlich vorkommen, sondern einfach
                    nur den Methoden entsprechen, die der Webservice eben bietet. Dieselben Methoden wollen wir auch in JavaScript
                    haben, wof√ºr wir zwei eigene Klassen schreiben m√ºssen.
                </p>

                <h2>Webservice-Klassen schreiben</h2>
                <p>
                    Auf dem Server besteht der Webservice ja aus mindestens zwei Klassen: <code>SongCollection</code> und
                    <code>SongResource</code>. Diese beiden Klassen m√ºssen wir mit √§nhlichen Methoden nachbauen, wobei wir
                    an den entscheidenen Stellen nat√ºrlich eine Anfrage an den Server senden, anstatt auf eine lokale Datenbank
                    zuzugreifen. Das Grundger√ºst der beiden Klassen ist daher folgendes, hier am Beispiel von <code>SongCollection</code>:
                </p>
                <source-code language="javascript">
                    class SongCollection {
                        // Konstruktor
                        constructor(url) {
                            this.url = url || "https://‚Ä¶";
                            this.username = "";
                            this.password = "";
                        }

                        // Benutzername und Passwort setzen
                        setAuthData(username, password) {
                            this.username = username;
                            this.password = password;
                        }

                        // Methoden des Webservices
                        async findSongs(query) { ‚Ä¶ }
                        async saveNewSong(song) { ‚Ä¶ }
                    }
                </source-code>
                <p>
                    Wobei die Implementierung der beiden Webservice-Methoden zum Beispiel so aussehen kann:
                </p>
                <source-code language="javascript">
                    /**
                     * Neuen Song speichern.
                     */
                    async saveNewSong(song) {
                        // Webservice aufrufen
                        let response = await fetch(this.url, {
                            method: "POST",
                            headers: {
                                "accept": "application/json",
                                "content-type": "application/json",
                                "authorization": "Basic " + btoa(this.username + ":" + this.password)
                            },
                            body: JSON.stringify(song)
                        });

                        // Ergebnis zur√ºckliefern
                        if (response.ok) {
                            return await response.json();
                        } else {
                            return {};
                        }
                    }
                </source-code>
                <p>
                    Mehr ist es schon gar nicht, auch wenn du dich erst wieder an JavaScript etwas gew√∂hnen musst. ü§ó
                    Das Komplizierteste an der ganzen Geschichte ist eben auch hier, dass der gesamte Code von Hand
                    geschrieben werden muss und nicht automatisch generiert werden kann. Das ist ein wenig l√§stig und
                    zugegeben auch etwas m√ºhsam. Aber was w√§re schon eine perfekte Welt? üåç
                </p>
                <p>
                    Das vollst√§ndige Beispiel findest du auf Moodle.
                </p>
            </aside>
        </section>

        <!--
            ====================
            HINWEISE ZUM SCHLUSS
            ====================
        -->
        <section data-chapter data-background-image="../../trennfolie.jpg">
            <h1>Hinweise zum Schluss</h1>
            <article>
                <small>
                    <small>
                        Bildnachweis:
                        <a href="https://pixabay.com/en/adult-break-business-caucasian-2398561/" target="_blank">Pixabay: rawpixel</a>
                    </small>
                </small>
            </article>
        </section>

        <section data-background-color="rgb(153, 190, 137)">
            <h1>Do &amp; Don't</h1>
            <article>
                <h4>Definition eines Webservices</h4>
                <ul>
                    <li>
                        Definiere eine logische URL-Struktur, die den REST-Prinzipien entspricht.
                    </li>
                    <li>
                        Verwende einen einheitlichen URL-Prefix f√ºr alle REST-Webservices.
                    </li>
                    <li>
                        GET-Anfragen d√ºrfen niemals Daten √§ndern!
                    </li>
                    <li>
                        Nutze POST und PUT zur Anlage und zum Speichern von Eintr√§gen.
                    </li>
                    <li>
                        Unterst√ºtze bei Bedarf mehr als ein Datenformat.
                    </li>
                    <li>
                        Programmiere Collections und Ressourcen immer in verschiedenen Javaklassen.
                    </li>
                    <li>
                        Definiere eine einheitliche Antwortstruktur, die auch Fehlermeldungen zur√ºckliefern kann.
                    </li>
                    <li>
                        Verwende Objekte deiner Entity-Klassen, um Datens√§tze mit dem Webservice auszutauschen.
                    </li>
                    <li>
                        Verwende reduzierte Datentransferklassen, wenn nicht alle Felder √ºbertragen werden sollen.
                    </li>
                    <li>
                        Baue deine Webservices immer als Frontend zu bereits vorhandenen EJBs.
                    </li>
                    <li>
                        Setze dich mit <a href="https://en.wikipedia.org/wiki/HATEOAS" target="_blank">HATEOAS</a> und
                        <a href="https://en.wikipedia.org/wiki/Open_Data_Protocol" target="_blank">ODATA</a> auseinander.
                    </li>
                </ul>

                <h4>Sicherheit</h4>
                <ul>
                    <li>
                        Sichere deine Webservices mit einer Benutzer- und Rechteverwaltung ab.
                    </li>
                    <li>
                        Verwende HTTP Basic Auth oder HTTP Digest Auth zur √úbertragung der Anmeldedaten.
                    </li>
                    <li>
                        Verwende zur √úbertragung immer das verschl√ºsselte HTTPS-Protokoll.
                    </li>
                    <li>
                        Nutze gegebenenfalls Client-Zertifikate anstelle von Benutzername und Passwort zur Erh√∂hung der Sicherheit.
                    </li>
                    <li>
                        Dokumentiere f√ºr deine Clients, wie sie sich am Webservice authentifizieren k√∂nnen.
                    </li>
                    <li>
                        Vermeide die Annotationen <code>@RolesAllowed</code>, <code>@PermitAll</code> usw., da sie schwer zum Laufen zu bringen sind.
                    </li>
                    <li>
                        Sichere deine Webservices stattdessen lieber √ºber die Datei <tt>WEB-INF\web.xml</tt> ab.
                    </li>
                    <li>
                        Dies erlaubt sp√§ter auch dem Betreiber der Webanwendung, die Berechtigungspr√ºfungen leichter anzupassen.
                    </li>
                </ul>

                <h4>Betrieb eines Webservices</h4>
                <ul>
                    <li>
                        Liefere eine Dokumentation zu deinen REST-Webservices inklusive vollst√§ndiger Beispielanfragen und Antworten.
                    </li>
                    <li>
                        Verwende Werkzeuge wie <a href="https://swagger.io/" target="_blank">Swagger</a> oder
                        <a href="https://dzone.com/articles/rest-api-documentation-using-jaxrs-analyzer" target="_blank">JAXRS-ANALYZER</a> zur Dokumentation.
                    </li>
                    <li>
                        √úberlege dir, eigene SDKs f√ºr verschiedene Programmiersprachen zur Verf√ºgung zu stellen.
                    </li>
                    <li>
                        Pr√ºfe, ob der Webservice √ºber die URL versioniert werden muss.
                    </li>
                    <li>
                        Schalte die alten Webservice-Versionen aber nicht sofort ab, wenn eine neue Version kommt.
                    </li>
                    <li>
                        Richte ein Monitoring und ein Logging f√ºr den Webservice ein.
                    </li>
                    <li>
                        Speichere alle HTTP-Anfragen und Antworten f√ºr eine Weile, damit sie f√ºr Fehlersuchen zur Verf√ºgung stehen.
                    </li>
                    <li>
                        Behalte aber nicht zu viele HTTP-Nachrichten, da dies Speicher belegt und dem Datenschutz entgegen steht.
                    </li>
                </ul>

                <h4>Aufruf fremder Webservices</h4>
                <ul>
                    <li>
                        Nutze Bibliotheken wie <a href="https://github.com/google/gson" target="_blank">Google Gson</a> und
                        <a href="http://unirest.io/java.html" target="_blank">Unirest for Java</a> anstelle von JAX-RS.
                    </li>
                    <li>
                        Nutze die <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" target="_blank">Fetch API</a>
                        von JavaScript, wenn du f√ºr moderne Laufzeitumgebungen entwickelst.
                    </li>
                    <li>
                        Kapsele alle Webservicezugriffe in eigenen Klassen, die analog den Serverklassen aufgebaut sind.
                    </li>
                    <li>
                        Wenn es ein SDK f√ºr einen REST-Webservice gibt, ziehe es der eigenen Implementierung stets vor.
                    </li>
                    <li>
                        Es sei denn, das SDK ist schlecht gemacht und verursacht mehr Probleme als es l√∂st.
                    </li>
                    <li>
                        Nutze vorzugsweise REST anstelle von SOAP, wenn du mobile Clients und Browser bedienen willst.
                    </li>
                </ul>
            </article>
            <aside>
                <p>
                    Dies sind sie: Die goldenen Regeln der Kunst. ü•á Auf dieser Folie haben wir ein paar allgemeine
                    Tipps zusammengestellt, worauf du bei der Entwicklung von REST-Webservices achten solltest.
                </p>
                <img src="../../do-dont.svg" class="d-block" style="width: 20em; max-width: 100%; margin-bottom: 0.5em;" />
                <p>
                    <small>
                        Bildnachweis:
                        <a href="https://pixabay.com/en/dialog-tip-advice-hint-speaking-148815/" target="_blank" style="color: rgb(25, 68, 49);">Pixabay: OpenClipart-Vectors</a>
                    </small>
                </p>
            </aside>
        </section>

        <section data-background-color="rgb(158, 203, 231)">
            <h1>Rechtshinweise</h1>
            <article>
                <h4>Creative Commons Namensnennung 4.0 International</h4>
                <ul>
                    <li>Beliebiges Teilen ist erlaubt</li>
                    <li>Die Unterlagen d√ºrfen bearbeitet und ver√§ndert werden</li>
                    <li>Wenn die Namens- und Urheberangaben erhalten bleiben</li>
                    <li>Und keine weiteren Einschr√§nkungen auferlegt werden</li>
                </ul>
                <span style="font-size: 400px; color: white;" class="dhbw-text-shadow" >¬ß</span>
            </article>
            <aside style="font-size: 80%">
                <h4>Kontaktdaten</h4>
                <p>
                    Dennis Schulmeister-Zimolong<br/>
                    E-Mail: <a data-email-address>dhbw windows3.de</a><br/>
                </p>

                <h4>Urheberrecht und Lizenzvereinbarung</h4>
                <p>
                    ¬© 2018 ‚Äì 2019 Dennis Schulmeister-Zimolong im Auftrag der DHBW Karlsruhe<br/>
                    <a href="https://github.com/DennisSchulmeister/dhbwka-wwi-vertsys-folien" target="_blank">https://github.com/DennisSchulmeister/dhbwka-wwi-vertsys-folien</a>
                </p>
                <img src="https://i.creativecommons.org/l/by/4.0/88x31.png" alt="Creative Commons Lizenzvertrag" />
                <p>
                    Das Werk <i>Vorlesung "Verteilte Systeme" im Studiengang Wirtschaftsinformatik an der DHBW Karlsruhe</i>
                    von <a href="http://www.wpvs.de" target="_blank">Dennis Schulmeister-Zimolong im Auftrag der Dualen Hochschule
                    Baden-W√ºrttemberg Karlsruhe</a> ist lizenziert unter
                    <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank"><i>Creative Commons Namensnennung 4.0 International</i></a>.
                </p>
                <p>
                    Du darfst:
                </p>
                <ul>
                    <li>
                        <b>Teilen</b> ‚Äî das Material in jedwedem Format oder Medium vervielf√§ltigen
                        und weiterverbreiten
                    </li>
                    <li>
                        <b>Bearbeiten</b> ‚Äî das Material remixen, ver√§ndern und darauf aufbauen
                        und zwar f√ºr beliebige Zwecke, sogar kommerziell.
                    </li>
                </ul>
                <p>
                    Unter folgenden Bedingungen:
                </p>
                <ul>
                    <li>
                        <b>Namensnennung</b> ‚Äî Du musst angemessene Urheber- und Rechteangaben
                        machen, einen Link zur Lizenz beif√ºgen und angeben, ob √Ñnderungen
                        vorgenommen wurden. Diese Angaben d√ºrfen in jeder angemessenen Art
                        und Weise gemacht werden, allerdings nicht so, dass der Eindruck
                        entsteht, der Lizenzgeber unterst√ºtze gerade dich oder deine Nutzung
                        besonders.
                    </li>
                    <li>
                        <b>Keine weiteren Einschr√§nkungen</b> ‚Äî Du darfst keine zus√§tzlichen Klauseln
                        oder technische Verfahren einsetzen, die anderen rechtlich irgendetwas
                        untersagen, was die Lizenz erlaubt.
                    </li>
                </ul>
                <p>
                    Es werden keine Garantien gegeben und auch keine Gew√§hr geleistet.
                    Die Lizenz verschafft dir m√∂glicherweise nicht alle Erlaubnisse,
                    die du f√ºr die jeweilige Nutzung brauchst. Es k√∂nnen beispielsweise
                    andere Rechte wie Pers√∂nlichkeits- und Datenschutzrechte zu beachten
                    sein, die deine Nutzung des Materials entsprechend beschr√§nken.
                </p>
                <p>
                    <i>
                        Die Erstellung dieser Unterlagen wurde in den Jahren 2017 und 2018 durch
                        das Projekt ‚ÄûDigiTransMoBiL ‚Äì Gestaltungskompetenzen f√ºr die Digitale
                        Transformation durch Modulbausteine mit innovativen Lehrinhalten und
                        Lehrmethoden‚Äù gef√∂rdert.
                    </i>
                </p>
            </aside>
        </section>
    </body>
</html>
